"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@ag-ui";
exports.ids = ["vendor-chunks/@ag-ui"];
exports.modules = {

/***/ "(rsc)/./node_modules/@ag-ui/client/dist/index.mjs":
/*!***************************************************!*\
  !*** ./node_modules/@ag-ui/client/dist/index.mjs ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AGUIConnectNotImplementedError: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIConnectNotImplementedError),\n/* harmony export */   AGUIError: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError),\n/* harmony export */   AbstractAgent: () => (/* binding */ W),\n/* harmony export */   ActivityDeltaEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ActivityDeltaEventSchema),\n/* harmony export */   ActivityMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ActivityMessageSchema),\n/* harmony export */   ActivitySnapshotEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ActivitySnapshotEventSchema),\n/* harmony export */   AssistantMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AssistantMessageSchema),\n/* harmony export */   BaseEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.BaseEventSchema),\n/* harmony export */   BaseMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.BaseMessageSchema),\n/* harmony export */   BinaryInputContentSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.BinaryInputContentSchema),\n/* harmony export */   ContextSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ContextSchema),\n/* harmony export */   CustomEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.CustomEventSchema),\n/* harmony export */   DeveloperMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.DeveloperMessageSchema),\n/* harmony export */   EventSchemas: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventSchemas),\n/* harmony export */   EventType: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType),\n/* harmony export */   FunctionCallSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.FunctionCallSchema),\n/* harmony export */   HttpAgent: () => (/* binding */ st),\n/* harmony export */   InputContentSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.InputContentSchema),\n/* harmony export */   MessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.MessageSchema),\n/* harmony export */   MessagesSnapshotEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.MessagesSnapshotEventSchema),\n/* harmony export */   RawEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RawEventSchema),\n/* harmony export */   RoleSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RoleSchema),\n/* harmony export */   RunAgentInputSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RunAgentInputSchema),\n/* harmony export */   RunErrorEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RunErrorEventSchema),\n/* harmony export */   RunFinishedEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RunFinishedEventSchema),\n/* harmony export */   RunStartedEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RunStartedEventSchema),\n/* harmony export */   StateDeltaEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StateDeltaEventSchema),\n/* harmony export */   StateSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StateSchema),\n/* harmony export */   StateSnapshotEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StateSnapshotEventSchema),\n/* harmony export */   StepFinishedEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StepFinishedEventSchema),\n/* harmony export */   StepStartedEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StepStartedEventSchema),\n/* harmony export */   SystemMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.SystemMessageSchema),\n/* harmony export */   TextInputContentSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.TextInputContentSchema),\n/* harmony export */   TextMessageChunkEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.TextMessageChunkEventSchema),\n/* harmony export */   TextMessageContentEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.TextMessageContentEventSchema),\n/* harmony export */   TextMessageEndEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.TextMessageEndEventSchema),\n/* harmony export */   TextMessageStartEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.TextMessageStartEventSchema),\n/* harmony export */   ThinkingEndEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingEndEventSchema),\n/* harmony export */   ThinkingStartEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingStartEventSchema),\n/* harmony export */   ThinkingTextMessageContentEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingTextMessageContentEventSchema),\n/* harmony export */   ThinkingTextMessageEndEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingTextMessageEndEventSchema),\n/* harmony export */   ThinkingTextMessageStartEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingTextMessageStartEventSchema),\n/* harmony export */   ToolCallArgsEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallArgsEventSchema),\n/* harmony export */   ToolCallChunkEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallChunkEventSchema),\n/* harmony export */   ToolCallEndEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallEndEventSchema),\n/* harmony export */   ToolCallResultEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallResultEventSchema),\n/* harmony export */   ToolCallSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallSchema),\n/* harmony export */   ToolCallStartEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallStartEventSchema),\n/* harmony export */   ToolMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolMessageSchema),\n/* harmony export */   ToolSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolSchema),\n/* harmony export */   UserMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.UserMessageSchema),\n/* harmony export */   compactEvents: () => (/* binding */ fe),\n/* harmony export */   convertToLegacyEvents: () => (/* binding */ nt),\n/* harmony export */   defaultApplyEvents: () => (/* binding */ z),\n/* harmony export */   parseProtoStream: () => (/* binding */ tt),\n/* harmony export */   parseSSEStream: () => (/* binding */ Z),\n/* harmony export */   randomUUID: () => (/* binding */ ve),\n/* harmony export */   runHttpRequest: () => (/* binding */ Q),\n/* harmony export */   structuredClone_: () => (/* binding */ y),\n/* harmony export */   transformChunks: () => (/* binding */ B),\n/* harmony export */   transformHttpEventStream: () => (/* binding */ et),\n/* harmony export */   verifyEvents: () => (/* binding */ K)\n/* harmony export */ });\n/* harmony import */ var _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @ag-ui/core */ \"(rsc)/./node_modules/@ag-ui/core/dist/index.mjs\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rxjs/operators */ \"(rsc)/./node_modules/rxjs/dist/cjs/operators/index.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/cjs/index.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm/v4.js\");\n/* harmony import */ var fast_json_patch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fast-json-patch */ \"(rsc)/./node_modules/fast-json-patch/index.mjs\");\n/* harmony import */ var untruncate_json__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! untruncate-json */ \"(rsc)/./node_modules/untruncate-json/dist/esm/index.js\");\n/* harmony import */ var _ag_ui_proto__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @ag-ui/proto */ \"(rsc)/./node_modules/@ag-ui/proto/dist/index.mjs\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var compare_versions__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! compare-versions */ \"(rsc)/./node_modules/compare-versions/lib/esm/compareVersions.js\");\nvar Mt=Object.defineProperty,Ct=Object.defineProperties;var Rt=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var ot=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable;var at=(g,a,e)=>a in g?Mt(g,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):g[a]=e,_=(g,a)=>{for(var e in a||(a={}))ot.call(a,e)&&at(g,e,a[e]);if(Y)for(var e of Y(a))rt.call(a,e)&&at(g,e,a[e]);return g},G=(g,a)=>Ct(g,Rt(a));var it=(g,a)=>{var e={};for(var n in g)ot.call(g,n)&&a.indexOf(n)<0&&(e[n]=g[n]);if(g!=null&&Y)for(var n of Y(g))a.indexOf(n)<0&&rt.call(g,n)&&(e[n]=g[n]);return e};var y=g=>{if(typeof structuredClone==\"function\")return structuredClone(g);try{return JSON.parse(JSON.stringify(g))}catch(a){return _({},g)}};function ve(){return (0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])()}async function x(g,a,e,n){let t=a,s=e,r;for(let o of g)try{let i=await n(o,y(t),y(s));if(i===void 0)continue;if(i.messages!==void 0&&(t=i.messages),i.state!==void 0&&(s=i.state),r=i.stopPropagation,r===!0)break}catch(i){ false||process.env.JEST_WORKER_ID!==void 0||console.error(\"Subscriber error:\",i);continue}return _(_(_({},JSON.stringify(t)!==JSON.stringify(a)?{messages:t}:{}),JSON.stringify(s)!==JSON.stringify(e)?{state:s}:{}),r!==void 0?{stopPropagation:r}:{})}var z=(g,a,e,n)=>{let t=y(e.messages),s=y(g.state),r={},o=p=>{p.messages!==void 0&&(t=p.messages,r.messages=p.messages),p.state!==void 0&&(s=p.state,r.state=p.state)},i=()=>{let p=y(r);return r={},p.messages!==void 0||p.state!==void 0?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(p):rxjs__WEBPACK_IMPORTED_MODULE_3__.EMPTY};return a.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.concatMap)(async p=>{var T,A,c,F,U;let S=await x(n,t,s,(E,l,d)=>{var m;return(m=E.onEvent)==null?void 0:m.call(E,{event:p,agent:e,input:g,messages:l,state:d})});if(o(S),S.stopPropagation===!0)return i();switch(p.type){case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onTextMessageStartEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});if(o(E),E.stopPropagation!==!0){let{messageId:l,role:d=\"assistant\"}=p,m={id:l,role:d,content:\"\"};t.push(m),o({messages:t})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT:{let{messageId:E,delta:l}=p,d=t.find(u=>u.id===E);if(!d)return console.warn(`TEXT_MESSAGE_CONTENT: No message found with ID '${E}'`),i();let m=await x(n,t,s,(u,v,h)=>{var I;return(I=u.onTextMessageContentEvent)==null?void 0:I.call(u,{event:p,messages:v,state:h,agent:e,input:g,textMessageBuffer:typeof d.content==\"string\"?d.content:\"\"})});if(o(m),m.stopPropagation!==!0){let u=typeof d.content==\"string\"?d.content:\"\";d.content=`${u}${l}`,o({messages:t})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END:{let{messageId:E}=p,l=t.find(m=>m.id===E);if(!l)return console.warn(`TEXT_MESSAGE_END: No message found with ID '${E}'`),i();let d=await x(n,t,s,(m,u,v)=>{var h;return(h=m.onTextMessageEndEvent)==null?void 0:h.call(m,{event:p,messages:u,state:v,agent:e,input:g,textMessageBuffer:typeof l.content==\"string\"?l.content:\"\"})});return o(d),await Promise.all(n.map(m=>{var u;(u=m.onNewMessage)==null||u.call(m,{message:l,messages:t,state:s,agent:e,input:g})})),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onToolCallStartEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});if(o(E),E.stopPropagation!==!0){let{toolCallId:l,toolCallName:d,parentMessageId:m}=p,u;m&&t.length>0&&t[t.length-1].id===m?u=t[t.length-1]:(u={id:m||l,role:\"assistant\",toolCalls:[]},t.push(u)),(T=u.toolCalls)!=null||(u.toolCalls=[]),u.toolCalls.push({id:l,type:\"function\",function:{name:d,arguments:\"\"}}),o({messages:t})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS:{let{toolCallId:E,delta:l}=p,d=t.find(v=>{var h;return(h=v.toolCalls)==null?void 0:h.some(I=>I.id===E)});if(!d)return console.warn(`TOOL_CALL_ARGS: No message found containing tool call with ID '${E}'`),i();let m=d.toolCalls.find(v=>v.id===E);if(!m)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${E}'`),i();let u=await x(n,t,s,(v,h,I)=>{var q;let D=m.function.arguments,b=m.function.name,j={};try{j=(0,untruncate_json__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(D)}catch(Te){}return(q=v.onToolCallArgsEvent)==null?void 0:q.call(v,{event:p,messages:h,state:I,agent:e,input:g,toolCallBuffer:D,toolCallName:b,partialToolCallArgs:j})});return o(u),u.stopPropagation!==!0&&(m.function.arguments+=l,o({messages:t})),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END:{let{toolCallId:E}=p,l=t.find(u=>{var v;return(v=u.toolCalls)==null?void 0:v.some(h=>h.id===E)});if(!l)return console.warn(`TOOL_CALL_END: No message found containing tool call with ID '${E}'`),i();let d=l.toolCalls.find(u=>u.id===E);if(!d)return console.warn(`TOOL_CALL_END: No tool call found with ID '${E}'`),i();let m=await x(n,t,s,(u,v,h)=>{var j;let I=d.function.arguments,D=d.function.name,b={};try{b=JSON.parse(I)}catch(q){}return(j=u.onToolCallEndEvent)==null?void 0:j.call(u,{event:p,messages:v,state:h,agent:e,input:g,toolCallName:D,toolCallArgs:b})});return o(m),await Promise.all(n.map(u=>{var v;(v=u.onNewToolCall)==null||v.call(u,{toolCall:d,messages:t,state:s,agent:e,input:g})})),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_RESULT:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onToolCallResultEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});if(o(E),E.stopPropagation!==!0){let{messageId:l,toolCallId:d,content:m,role:u}=p,v={id:l,toolCallId:d,role:u||\"tool\",content:m};t.push(v),await Promise.all(n.map(h=>{var I;(I=h.onNewMessage)==null||I.call(h,{message:v,messages:t,state:s,agent:e,input:g})})),o({messages:t})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_SNAPSHOT:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onStateSnapshotEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});if(o(E),E.stopPropagation!==!0){let{snapshot:l}=p;s=l,o({state:s})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onStateDeltaEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});if(o(E),E.stopPropagation!==!0){let{delta:l}=p;try{s=(0,fast_json_patch__WEBPACK_IMPORTED_MODULE_2__.applyPatch)(s,l,!0,!1).newDocument,o({state:s})}catch(d){let m=d instanceof Error?d.message:String(d);console.warn(`Failed to apply state patch:\nCurrent state: ${JSON.stringify(s,null,2)}\nPatch operations: ${JSON.stringify(l,null,2)}\nError: ${m}`)}}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onMessagesSnapshotEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});if(o(E),E.stopPropagation!==!0){let{messages:l}=p;t=l,o({messages:t})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.ACTIVITY_SNAPSHOT:{let E=p,l=t.findIndex(h=>h.id===E.messageId),d=l>=0?t[l]:void 0,m=(d==null?void 0:d.role)===\"activity\"?d:void 0,u=(A=E.replace)!=null?A:!0,v=await x(n,t,s,(h,I,D)=>{var b;return(b=h.onActivitySnapshotEvent)==null?void 0:b.call(h,{event:E,messages:I,state:D,agent:e,input:g,activityMessage:m,existingMessage:d})});if(o(v),v.stopPropagation!==!0){let h={id:E.messageId,role:\"activity\",activityType:E.activityType,content:y(E.content)},I;l===-1?(t.push(h),I=h):m?u&&(t[l]=G(_({},m),{activityType:E.activityType,content:y(E.content)})):u&&(t[l]=h,I=h),o({messages:t}),I&&await Promise.all(n.map(D=>{var b;return(b=D.onNewMessage)==null?void 0:b.call(D,{message:I,messages:t,state:s,agent:e,input:g})}))}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.ACTIVITY_DELTA:{let E=p,l=t.findIndex(v=>v.id===E.messageId);if(l===-1)return console.warn(`ACTIVITY_DELTA: No message found with ID '${E.messageId}' to apply patch`),i();let d=t[l];if(d.role!==\"activity\")return console.warn(`ACTIVITY_DELTA: Message '${E.messageId}' is not an activity message`),i();let m=d,u=await x(n,t,s,(v,h,I)=>{var D;return(D=v.onActivityDeltaEvent)==null?void 0:D.call(v,{event:E,messages:h,state:I,agent:e,input:g,activityMessage:m})});if(o(u),u.stopPropagation!==!0)try{let v=y((c=m.content)!=null?c:{}),I=(0,fast_json_patch__WEBPACK_IMPORTED_MODULE_2__.applyPatch)(v,(F=E.patch)!=null?F:[],!0,!1).newDocument;t[l]=G(_({},m),{content:y(I),activityType:E.activityType}),o({messages:t})}catch(v){let h=v instanceof Error?v.message:String(v);console.warn(`Failed to apply activity patch for '${E.messageId}': ${h}`)}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RAW:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onRawEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});return o(E),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.CUSTOM:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onCustomEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});return o(E),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onRunStartedEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});if(o(E),E.stopPropagation!==!0){let l=p;if((U=l.input)!=null&&U.messages){for(let d of l.input.messages)t.find(u=>u.id===d.id)||t.push(d);o({messages:t})}}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_FINISHED:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onRunFinishedEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g,result:p.result})});return o(E),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onRunErrorEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});return o(E),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_STARTED:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onStepStartedEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});return o(E),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_FINISHED:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onStepFinishedEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});return o(E),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CHUNK:throw new Error(\"TEXT_MESSAGE_CHUNK must be tranformed before being applied\");case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_CHUNK:throw new Error(\"TOOL_CALL_CHUNK must be tranformed before being applied\");case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_START:return i();case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_END:return i();case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_START:return i();case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_CONTENT:return i();case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_END:return i()}let H=p.type;return i()}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.mergeAll)(),n.length>0?(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.defaultIfEmpty)({}):p=>p)};var K=g=>a=>{let e=new Map,n=new Map,t=!1,s=!1,r=!1,o=new Map,i=!1,p=!1,S=!1,H=()=>{e.clear(),n.clear(),o.clear(),i=!1,p=!1,t=!1,s=!1,S=!0};return a.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.mergeMap)(T=>{let A=T.type;if(g&&console.debug(\"[VERIFY]:\",JSON.stringify(T)),s)return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send event type '${A}': The run has already errored with 'RUN_ERROR'. No further events can be sent.`));if(t&&A!==_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR&&A!==_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED)return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send event type '${A}': The run has already finished with 'RUN_FINISHED'. Start a new run with 'RUN_STARTED'.`));if(r){if(A===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED){if(S&&!t)return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'RUN_STARTED' while a run is still active. The previous run must be finished with 'RUN_FINISHED' before starting a new run.\"));t&&H()}}else if(r=!0,A!==_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED&&A!==_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR)return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"First event must be 'RUN_STARTED'\"));switch(A){case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START:{let c=T.messageId;return e.has(c)?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TEXT_MESSAGE_START' event: A text message with ID '${c}' is already in progress. Complete it with 'TEXT_MESSAGE_END' first.`)):(e.set(c,!0),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT:{let c=T.messageId;return e.has(c)?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TEXT_MESSAGE_CONTENT' event: No active text message found with ID '${c}'. Start a text message with 'TEXT_MESSAGE_START' first.`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END:{let c=T.messageId;return e.has(c)?(e.delete(c),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TEXT_MESSAGE_END' event: No active text message found with ID '${c}'. A 'TEXT_MESSAGE_START' event must be sent first.`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START:{let c=T.toolCallId;return n.has(c)?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TOOL_CALL_START' event: A tool call with ID '${c}' is already in progress. Complete it with 'TOOL_CALL_END' first.`)):(n.set(c,!0),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS:{let c=T.toolCallId;return n.has(c)?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TOOL_CALL_ARGS' event: No active tool call found with ID '${c}'. Start a tool call with 'TOOL_CALL_START' first.`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END:{let c=T.toolCallId;return n.has(c)?(n.delete(c),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TOOL_CALL_END' event: No active tool call found with ID '${c}'. A 'TOOL_CALL_START' event must be sent first.`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_STARTED:{let c=T.stepName;return o.has(c)?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Step \"${c}\" is already active for 'STEP_STARTED'`)):(o.set(c,!0),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_FINISHED:{let c=T.stepName;return o.has(c)?(o.delete(c),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'STEP_FINISHED' for step \"${c}\" that was not started`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED:return S=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T);case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_FINISHED:{if(o.size>0){let c=Array.from(o.keys()).join(\", \");return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'RUN_FINISHED' while steps are still active: ${c}`))}if(e.size>0){let c=Array.from(e.keys()).join(\", \");return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'RUN_FINISHED' while text messages are still active: ${c}`))}if(n.size>0){let c=Array.from(n.keys()).join(\", \");return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'RUN_FINISHED' while tool calls are still active: ${c}`))}return t=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR:return s=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T);case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.CUSTOM:return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T);case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_START:return i?p?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking message is already in progress. Complete it with 'THINKING_TEXT_MESSAGE_END' first.\")):(p=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking step is not in progress. Create one with 'THINKING_START' first.\"));case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_CONTENT:return p?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_TEXT_MESSAGE_CONTENT' event: No active thinking message found. Start a message with 'THINKING_TEXT_MESSAGE_START' first.\"));case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_END:return p?(p=!1,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_TEXT_MESSAGE_END' event: No active thinking message found. A 'THINKING_TEXT_MESSAGE_START' event must be sent first.\"));case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_START:return i?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_START' event: A thinking step is already in progress. End it with 'THINKING_END' first.\")):(i=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T));case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_END:return i?(i=!1,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_END' event: No active thinking step found. A 'THINKING_START' event must be sent first.\"));default:return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)}}))};var Q=(g,a)=>(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.defer)(()=>(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.from)(fetch(g,a))).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.switchMap)(e=>{var s;if(!e.ok){let r=e.headers.get(\"content-type\")||\"\";return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.from)(e.text()).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.mergeMap)(o=>{let i=o;if(r.includes(\"application/json\"))try{i=JSON.parse(o)}catch(S){}let p=new Error(`HTTP ${e.status}: ${typeof i==\"string\"?i:JSON.stringify(i)}`);return p.status=e.status,p.payload=i,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>p)}))}let n={type:\"headers\",status:e.status,headers:e.headers},t=(s=e.body)==null?void 0:s.getReader();return t?new rxjs__WEBPACK_IMPORTED_MODULE_3__.Observable(r=>(r.next(n),(async()=>{try{for(;;){let{done:o,value:i}=await t.read();if(o)break;let p={type:\"data\",data:i};r.next(p)}r.complete()}catch(o){r.error(o)}})(),()=>{t.cancel().catch(o=>{if((o==null?void 0:o.name)!==\"AbortError\")throw o})})):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new Error(\"Failed to getReader() from response\"))}));var Z=g=>{let a=new rxjs__WEBPACK_IMPORTED_MODULE_3__.Subject,e=new TextDecoder(\"utf-8\",{fatal:!1}),n=\"\";g.subscribe({next:s=>{if(s.type!==\"headers\"&&s.type===\"data\"&&s.data){let r=e.decode(s.data,{stream:!0});n+=r;let o=n.split(/\\n\\n/);n=o.pop()||\"\";for(let i of o)t(i)}},error:s=>a.error(s),complete:()=>{n&&(n+=e.decode(),t(n)),a.complete()}});function t(s){let r=s.split(`\n`),o=[];for(let i of r)i.startsWith(\"data: \")&&o.push(i.slice(6));if(o.length>0)try{let i=o.join(`\n`),p=JSON.parse(i);a.next(p)}catch(i){a.error(i)}}return a.asObservable()};var tt=g=>{let a=new rxjs__WEBPACK_IMPORTED_MODULE_3__.Subject,e=new Uint8Array(0);g.subscribe({next:t=>{if(t.type!==\"headers\"&&t.type===\"data\"&&t.data){let s=new Uint8Array(e.length+t.data.length);s.set(e,0),s.set(t.data,e.length),e=s,n()}},error:t=>a.error(t),complete:()=>{if(e.length>0)try{n()}catch(t){console.warn(\"Incomplete or invalid protocol buffer data at stream end\")}a.complete()}});function n(){for(;e.length>=4;){let r=4+new DataView(e.buffer,e.byteOffset,4).getUint32(0,!1);if(e.length<r)break;try{let o=e.slice(4,r),i=_ag_ui_proto__WEBPACK_IMPORTED_MODULE_6__.decode(o);a.next(i),e=e.slice(r)}catch(o){let i=o instanceof Error?o.message:String(o);a.error(new Error(`Failed to decode protocol buffer message: ${i}`));return}}}return a.asObservable()};var et=g=>{let a=new rxjs__WEBPACK_IMPORTED_MODULE_3__.Subject,e=new rxjs__WEBPACK_IMPORTED_MODULE_3__.ReplaySubject,n=!1;return g.subscribe({next:t=>{e.next(t),t.type===\"headers\"&&!n?(n=!0,t.headers.get(\"content-type\")===_ag_ui_proto__WEBPACK_IMPORTED_MODULE_6__.AGUI_MEDIA_TYPE?tt(e).subscribe({next:r=>a.next(r),error:r=>a.error(r),complete:()=>a.complete()}):Z(e).subscribe({next:r=>{try{let o=_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventSchemas.parse(r);a.next(o)}catch(o){a.error(o)}},error:r=>{if((r==null?void 0:r.name)===\"AbortError\"){a.next({type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR,rawEvent:r}),a.complete();return}return a.error(r)},complete:()=>a.complete()})):n||a.error(new Error(\"No headers event received before data events\"))},error:t=>{e.error(t),a.error(t)},complete:()=>{e.complete()}}),a.asObservable()};var C=zod__WEBPACK_IMPORTED_MODULE_7__[\"enum\"]([\"TextMessageStart\",\"TextMessageContent\",\"TextMessageEnd\",\"ActionExecutionStart\",\"ActionExecutionArgs\",\"ActionExecutionEnd\",\"ActionExecutionResult\",\"AgentStateMessage\",\"MetaEvent\",\"RunStarted\",\"RunFinished\",\"RunError\",\"NodeStarted\",\"NodeFinished\"]),zt=zod__WEBPACK_IMPORTED_MODULE_7__[\"enum\"]([\"LangGraphInterruptEvent\",\"PredictState\",\"Exit\"]),Kt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.TextMessageStart),messageId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),parentMessageId:zod__WEBPACK_IMPORTED_MODULE_7__.string().optional(),role:zod__WEBPACK_IMPORTED_MODULE_7__.string().optional()}),Jt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.TextMessageContent),messageId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),content:zod__WEBPACK_IMPORTED_MODULE_7__.string()}),$t=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.TextMessageEnd),messageId:zod__WEBPACK_IMPORTED_MODULE_7__.string()}),Vt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.ActionExecutionStart),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),actionName:zod__WEBPACK_IMPORTED_MODULE_7__.string(),parentMessageId:zod__WEBPACK_IMPORTED_MODULE_7__.string().optional()}),Wt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.ActionExecutionArgs),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),args:zod__WEBPACK_IMPORTED_MODULE_7__.string()}),Yt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.ActionExecutionEnd),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_7__.string()}),qt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.ActionExecutionResult),actionName:zod__WEBPACK_IMPORTED_MODULE_7__.string(),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),result:zod__WEBPACK_IMPORTED_MODULE_7__.string()}),Qt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.AgentStateMessage),threadId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),agentName:zod__WEBPACK_IMPORTED_MODULE_7__.string(),nodeName:zod__WEBPACK_IMPORTED_MODULE_7__.string(),runId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),active:zod__WEBPACK_IMPORTED_MODULE_7__.boolean(),role:zod__WEBPACK_IMPORTED_MODULE_7__.string(),state:zod__WEBPACK_IMPORTED_MODULE_7__.string(),running:zod__WEBPACK_IMPORTED_MODULE_7__.boolean()}),Zt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.MetaEvent),name:zt,value:zod__WEBPACK_IMPORTED_MODULE_7__.any()}),te=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.RunError),message:zod__WEBPACK_IMPORTED_MODULE_7__.string(),code:zod__WEBPACK_IMPORTED_MODULE_7__.string().optional()}),$n=zod__WEBPACK_IMPORTED_MODULE_7__.discriminatedUnion(\"type\",[Kt,Jt,$t,Vt,Wt,Yt,qt,Qt,Zt,te]),Vn=zod__WEBPACK_IMPORTED_MODULE_7__.object({id:zod__WEBPACK_IMPORTED_MODULE_7__.string(),role:zod__WEBPACK_IMPORTED_MODULE_7__.string(),content:zod__WEBPACK_IMPORTED_MODULE_7__.string(),parentMessageId:zod__WEBPACK_IMPORTED_MODULE_7__.string().optional()}),Wn=zod__WEBPACK_IMPORTED_MODULE_7__.object({id:zod__WEBPACK_IMPORTED_MODULE_7__.string(),name:zod__WEBPACK_IMPORTED_MODULE_7__.string(),arguments:zod__WEBPACK_IMPORTED_MODULE_7__.any(),parentMessageId:zod__WEBPACK_IMPORTED_MODULE_7__.string().optional()}),Yn=zod__WEBPACK_IMPORTED_MODULE_7__.object({id:zod__WEBPACK_IMPORTED_MODULE_7__.string(),result:zod__WEBPACK_IMPORTED_MODULE_7__.any(),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),actionName:zod__WEBPACK_IMPORTED_MODULE_7__.string()});var ae=g=>{if(typeof g==\"string\")return g;if(!Array.isArray(g))return;let a=g.filter(e=>e.type===\"text\").map(e=>e.text).filter(e=>e.length>0);if(a.length!==0)return a.join(`\n`)},nt=(g,a,e)=>n=>{let t={},s=!0,r=!0,o=\"\",i=null,p=null,S=[],H={},T=A=>{typeof A==\"object\"&&A!==null&&(\"messages\"in A&&delete A.messages,t=A)};return n.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.mergeMap)(A=>{switch(A.type){case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START:{let c=A;return[{type:C.enum.TextMessageStart,messageId:c.messageId,role:c.role}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT:{let c=A;return[{type:C.enum.TextMessageContent,messageId:c.messageId,content:c.delta}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END:{let c=A;return[{type:C.enum.TextMessageEnd,messageId:c.messageId}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START:{let c=A;return S.push({id:c.toolCallId,type:\"function\",function:{name:c.toolCallName,arguments:\"\"}}),r=!0,H[c.toolCallId]=c.toolCallName,[{type:C.enum.ActionExecutionStart,actionExecutionId:c.toolCallId,actionName:c.toolCallName,parentMessageId:c.parentMessageId}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS:{let c=A,F=S.find(E=>E.id===c.toolCallId);if(!F)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${c.toolCallId}'`),[];F.function.arguments+=c.delta;let U=!1;if(p){let E=p.find(l=>l.tool==F.function.name);if(E)try{let l=JSON.parse((0,untruncate_json__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(F.function.arguments));E.tool_argument&&E.tool_argument in l?(T(G(_({},t),{[E.state_key]:l[E.tool_argument]})),U=!0):E.tool_argument||(T(G(_({},t),{[E.state_key]:l})),U=!0)}catch(l){}}return[{type:C.enum.ActionExecutionArgs,actionExecutionId:c.toolCallId,args:c.delta},...U?[{type:C.enum.AgentStateMessage,threadId:g,agentName:e,nodeName:o,runId:a,running:s,role:\"assistant\",state:JSON.stringify(t),active:r}]:[]]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END:{let c=A;return[{type:C.enum.ActionExecutionEnd,actionExecutionId:c.toolCallId}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_RESULT:{let c=A;return[{type:C.enum.ActionExecutionResult,actionExecutionId:c.toolCallId,result:c.content,actionName:H[c.toolCallId]||\"unknown\"}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RAW:return[];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.CUSTOM:{let c=A;switch(c.name){case\"Exit\":s=!1;break;case\"PredictState\":p=c.value;break}return[{type:C.enum.MetaEvent,name:c.name,value:c.value}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_SNAPSHOT:return T(A.snapshot),[{type:C.enum.AgentStateMessage,threadId:g,agentName:e,nodeName:o,runId:a,running:s,role:\"assistant\",state:JSON.stringify(t),active:r}];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA:{let F=(0,fast_json_patch__WEBPACK_IMPORTED_MODULE_2__.applyPatch)(t,A.delta,!0,!1);return F?(T(F.newDocument),[{type:C.enum.AgentStateMessage,threadId:g,agentName:e,nodeName:o,runId:a,running:s,role:\"assistant\",state:JSON.stringify(t),active:r}]):[]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT:return i=A.messages,[{type:C.enum.AgentStateMessage,threadId:g,agentName:e,nodeName:o,runId:a,running:s,role:\"assistant\",state:JSON.stringify(_(_({},t),i?{messages:i}:{})),active:!0}];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED:return[];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_FINISHED:return i&&(t.messages=i),Object.keys(t).length===0?[]:[{type:C.enum.AgentStateMessage,threadId:g,agentName:e,nodeName:o,runId:a,running:s,role:\"assistant\",state:JSON.stringify(_(_({},t),i?{messages:oe(i)}:{})),active:!1}];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR:{let c=A;return[{type:C.enum.RunError,message:c.message,code:c.code}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_STARTED:return o=A.stepName,S=[],p=null,[{type:C.enum.AgentStateMessage,threadId:g,agentName:e,nodeName:o,runId:a,running:s,role:\"assistant\",state:JSON.stringify(t),active:!0}];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_FINISHED:return S=[],p=null,[{type:C.enum.AgentStateMessage,threadId:g,agentName:e,nodeName:o,runId:a,running:s,role:\"assistant\",state:JSON.stringify(t),active:!1}];default:return[]}}))};function oe(g){var e;let a=[];for(let n of g)if(n.role===\"assistant\"||n.role===\"user\"||n.role===\"system\"){let t=ae(n.content);if(t){let s={id:n.id,role:n.role,content:t};a.push(s)}if(n.role===\"assistant\"&&n.toolCalls&&n.toolCalls.length>0)for(let s of n.toolCalls){let r={id:s.id,name:s.function.name,arguments:JSON.parse(s.function.arguments),parentMessageId:n.id};a.push(r)}}else if(n.role===\"tool\"){let t=\"unknown\";for(let r of g)if(r.role===\"assistant\"&&((e=r.toolCalls)!=null&&e.length)){for(let o of r.toolCalls)if(o.id===n.toolCallId){t=o.function.name;break}}let s={id:n.id,result:n.content,actionExecutionId:n.toolCallId,actionName:t};a.push(s)}return a}var B=g=>a=>{let e,n,t,s=()=>{if(!e||t!==\"text\")throw new Error(\"No text message to close\");let i={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END,messageId:e.messageId};return t=void 0,e=void 0,g&&console.debug(\"[TRANSFORM]: TEXT_MESSAGE_END\",JSON.stringify(i)),i},r=()=>{if(!n||t!==\"tool\")throw new Error(\"No tool call to close\");let i={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END,toolCallId:n.toolCallId};return t=void 0,n=void 0,g&&console.debug(\"[TRANSFORM]: TOOL_CALL_END\",JSON.stringify(i)),i},o=()=>t===\"text\"?[s()]:t===\"tool\"?[r()]:[];return a.pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_3__.mergeMap)(i=>{switch(i.type){case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_RESULT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_SNAPSHOT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.CUSTOM:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_FINISHED:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_STARTED:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_FINISHED:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_START:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_END:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_START:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_CONTENT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_END:return[...o(),i];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RAW:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.ACTIVITY_SNAPSHOT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.ACTIVITY_DELTA:return[i];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CHUNK:let S=i,H=[];if((t!==\"text\"||S.messageId!==void 0&&S.messageId!==(e==null?void 0:e.messageId))&&H.push(...o()),t!==\"text\"){if(S.messageId===void 0)throw new Error(\"First TEXT_MESSAGE_CHUNK must have a messageId\");e={messageId:S.messageId},t=\"text\";let c={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START,messageId:S.messageId,role:S.role||\"assistant\"};H.push(c),g&&console.debug(\"[TRANSFORM]: TEXT_MESSAGE_START\",JSON.stringify(c))}if(S.delta!==void 0){let c={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT,messageId:e.messageId,delta:S.delta};H.push(c),g&&console.debug(\"[TRANSFORM]: TEXT_MESSAGE_CONTENT\",JSON.stringify(c))}return H;case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_CHUNK:let T=i,A=[];if((t!==\"tool\"||T.toolCallId!==void 0&&T.toolCallId!==(n==null?void 0:n.toolCallId))&&A.push(...o()),t!==\"tool\"){if(T.toolCallId===void 0)throw new Error(\"First TOOL_CALL_CHUNK must have a toolCallId\");if(T.toolCallName===void 0)throw new Error(\"First TOOL_CALL_CHUNK must have a toolCallName\");n={toolCallId:T.toolCallId,toolCallName:T.toolCallName,parentMessageId:T.parentMessageId},t=\"tool\";let c={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START,toolCallId:T.toolCallId,toolCallName:T.toolCallName,parentMessageId:T.parentMessageId};A.push(c),g&&console.debug(\"[TRANSFORM]: TOOL_CALL_START\",JSON.stringify(c))}if(T.delta!==void 0){let c={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS,toolCallId:n.toolCallId,delta:T.delta};A.push(c),g&&console.debug(\"[TRANSFORM]: TOOL_CALL_ARGS\",JSON.stringify(c))}return A}let p=i.type;return[]}),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.finalize)(()=>{o()}))};var X=class{runNext(a,e){return e.run(a).pipe(B(!1))}runNextWithState(a,e){let n=y(a.messages||[]),t=y(a.state||{}),s=new rxjs__WEBPACK_IMPORTED_MODULE_3__.ReplaySubject;return z(a,s,e,[]).subscribe(o=>{o.messages!==void 0&&(n=o.messages),o.state!==void 0&&(t=o.state)}),this.runNext(a,e).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.concatMap)(async o=>(s.next(o),await new Promise(i=>setTimeout(i,0)),{event:o,messages:y(n),state:y(t)})))}},J=class extends X{constructor(e){super();this.fn=e}run(e,n){return this.fn(e,n)}};function ce(g){let a=g.content;if(Array.isArray(a)){let e=a.filter(n=>typeof n==\"object\"&&n!==null&&\"type\"in n&&n.type===\"text\"&&typeof n.text==\"string\").map(n=>n.text).join(\"\");return G(_({},g),{content:e})}return typeof a==\"string\"?g:G(_({},g),{content:\"\"})}var $=class extends X{run(a,e){let r=a,{parentRunId:n}=r,t=it(r,[\"parentRunId\"]),s=G(_({},t),{messages:t.messages.map(ce)});return this.runNext(s,e)}};var pt={name:\"@ag-ui/client\",author:\"Markus Ecker <markus.ecker@gmail.com>\",version:\"0.0.41\",private:!1,publishConfig:{access:\"public\"},main:\"./dist/index.js\",module:\"./dist/index.mjs\",types:\"./dist/index.d.ts\",sideEffects:!1,files:[\"dist/**\",\"README.md\"],scripts:{build:\"tsup\",dev:\"tsup --watch\",clean:\"rm -rf dist .turbo node_modules\",typecheck:\"tsc --noEmit\",test:\"jest\",\"link:global\":\"pnpm link --global\",\"unlink:global\":\"pnpm unlink --global\"},dependencies:{\"@ag-ui/core\":\"workspace:*\",\"@ag-ui/encoder\":\"workspace:*\",\"@ag-ui/proto\":\"workspace:*\",\"@types/uuid\":\"^10.0.0\",\"compare-versions\":\"^6.1.1\",\"fast-json-patch\":\"^3.1.1\",rxjs:\"7.8.1\",\"untruncate-json\":\"^0.0.1\",uuid:\"^11.1.0\",zod:\"^3.22.4\"},devDependencies:{\"@types/jest\":\"^29.5.14\",\"@types/node\":\"^20.11.19\",jest:\"^29.7.0\",\"ts-jest\":\"^29.1.2\",tsup:\"^8.0.2\",typescript:\"^5.3.3\"}};var W=class{constructor({agentId:a,description:e,threadId:n,initialMessages:t,initialState:s,debug:r}={}){this.debug=!1;this.subscribers=[];this.isRunning=!1;this.middlewares=[];this.agentId=a,this.description=e!=null?e:\"\",this.threadId=n!=null?n:(0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(),this.messages=y(t!=null?t:[]),this.state=y(s!=null?s:{}),this.debug=r!=null?r:!1,(0,compare_versions__WEBPACK_IMPORTED_MODULE_8__.compareVersions)(this.maxVersion,\"0.0.39\")<=0&&this.middlewares.unshift(new $)}get maxVersion(){return pt.version}subscribe(a){return this.subscribers.push(a),{unsubscribe:()=>{this.subscribers=this.subscribers.filter(e=>e!==a)}}}use(...a){let e=a.map(n=>typeof n==\"function\"?new J(n):n);return this.middlewares.push(...e),this}async runAgent(a,e){var n;try{this.isRunning=!0,this.agentId=(n=this.agentId)!=null?n:(0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();let t=this.prepareRunAgentInput(a),s,r=new Set(this.messages.map(S=>S.id)),o=[{onRunFinishedEvent:S=>{s=S.result}},...this.subscribers,e!=null?e:{}];await this.onInitialize(t,o);let i=(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.pipe)(()=>this.middlewares.length===0?this.run(t):this.middlewares.reduceRight((H,T)=>({run:A=>T.run(A,H)}),this).run(t),B(this.debug),K(this.debug),S=>this.apply(t,S,o),S=>this.processApplyEvents(t,S,o),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.catchError)(S=>(this.isRunning=!1,this.onError(t,S,o))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.finalize)(()=>{this.isRunning=!1,this.onFinalize(t,o)}));await (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.lastValueFrom)(i((0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(null)));let p=y(this.messages).filter(S=>!r.has(S.id));return{result:s,newMessages:p}}finally{this.isRunning=!1}}connect(a){throw new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIConnectNotImplementedError}async connectAgent(a,e){var n;try{this.isRunning=!0,this.agentId=(n=this.agentId)!=null?n:(0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();let t=this.prepareRunAgentInput(a),s,r=new Set(this.messages.map(S=>S.id)),o=[{onRunFinishedEvent:S=>{s=S.result}},...this.subscribers,e!=null?e:{}];await this.onInitialize(t,o);let i=(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.pipe)(()=>this.connect(t),B(this.debug),K(this.debug),S=>this.apply(t,S,o),S=>this.processApplyEvents(t,S,o),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.catchError)(S=>(this.isRunning=!1,S instanceof _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIConnectNotImplementedError?rxjs__WEBPACK_IMPORTED_MODULE_3__.EMPTY:this.onError(t,S,o))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.finalize)(()=>{this.isRunning=!1,this.onFinalize(t,o)}));await (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.lastValueFrom)(i((0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(null)));let p=y(this.messages).filter(S=>!r.has(S.id));return{result:s,newMessages:p}}finally{this.isRunning=!1}}abortRun(){}apply(a,e,n){return z(a,e,this,n)}processApplyEvents(a,e,n){return e.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.tap)(t=>{t.messages&&(this.messages=t.messages,n.forEach(s=>{var r;(r=s.onMessagesChanged)==null||r.call(s,{messages:this.messages,state:this.state,agent:this,input:a})})),t.state&&(this.state=t.state,n.forEach(s=>{var r;(r=s.onStateChanged)==null||r.call(s,{state:this.state,messages:this.messages,agent:this,input:a})}))}))}prepareRunAgentInput(a){var t,s,r;let n=y(this.messages).filter(o=>o.role!==\"activity\");return{threadId:this.threadId,runId:(a==null?void 0:a.runId)||(0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(),tools:y((t=a==null?void 0:a.tools)!=null?t:[]),context:y((s=a==null?void 0:a.context)!=null?s:[]),forwardedProps:y((r=a==null?void 0:a.forwardedProps)!=null?r:{}),state:y(this.state),messages:n}}async onInitialize(a,e){let n=await x(e,this.messages,this.state,(t,s,r)=>{var o;return(o=t.onRunInitialized)==null?void 0:o.call(t,{messages:s,state:r,agent:this,input:a})});(n.messages!==void 0||n.state!==void 0)&&(n.messages&&(this.messages=n.messages,a.messages=n.messages,e.forEach(t=>{var s;(s=t.onMessagesChanged)==null||s.call(t,{messages:this.messages,state:this.state,agent:this,input:a})})),n.state&&(this.state=n.state,a.state=n.state,e.forEach(t=>{var s;(s=t.onStateChanged)==null||s.call(t,{state:this.state,messages:this.messages,agent:this,input:a})})))}onError(a,e,n){return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.from)(x(n,this.messages,this.state,(t,s,r)=>{var o;return(o=t.onRunFailed)==null?void 0:o.call(t,{error:e,messages:s,state:r,agent:this,input:a})})).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.map)(t=>{let s=t;if((s.messages!==void 0||s.state!==void 0)&&(s.messages!==void 0&&(this.messages=s.messages,n.forEach(r=>{var o;(o=r.onMessagesChanged)==null||o.call(r,{messages:this.messages,state:this.state,agent:this,input:a})})),s.state!==void 0&&(this.state=s.state,n.forEach(r=>{var o;(o=r.onStateChanged)==null||o.call(r,{state:this.state,messages:this.messages,agent:this,input:a})}))),s.stopPropagation!==!0)throw console.error(\"Agent execution failed:\",e),e;return{}}))}async onFinalize(a,e){let n=await x(e,this.messages,this.state,(t,s,r)=>{var o;return(o=t.onRunFinalized)==null?void 0:o.call(t,{messages:s,state:r,agent:this,input:a})});(n.messages!==void 0||n.state!==void 0)&&(n.messages!==void 0&&(this.messages=n.messages,e.forEach(t=>{var s;(s=t.onMessagesChanged)==null||s.call(t,{messages:this.messages,state:this.state,agent:this,input:a})})),n.state!==void 0&&(this.state=n.state,e.forEach(t=>{var s;(s=t.onStateChanged)==null||s.call(t,{state:this.state,messages:this.messages,agent:this,input:a})})))}clone(){let a=Object.create(Object.getPrototypeOf(this));return a.agentId=this.agentId,a.description=this.description,a.threadId=this.threadId,a.messages=y(this.messages),a.state=y(this.state),a.debug=this.debug,a.isRunning=this.isRunning,a.subscribers=[...this.subscribers],a}addMessage(a){this.messages.push(a),(async()=>{var e,n,t;for(let s of this.subscribers)await((e=s.onNewMessage)==null?void 0:e.call(s,{message:a,messages:this.messages,state:this.state,agent:this}));if(a.role===\"assistant\"&&a.toolCalls)for(let s of a.toolCalls)for(let r of this.subscribers)await((n=r.onNewToolCall)==null?void 0:n.call(r,{toolCall:s,messages:this.messages,state:this.state,agent:this}));for(let s of this.subscribers)await((t=s.onMessagesChanged)==null?void 0:t.call(s,{messages:this.messages,state:this.state,agent:this}))})()}addMessages(a){this.messages.push(...a),(async()=>{var e,n,t;for(let s of a){for(let r of this.subscribers)await((e=r.onNewMessage)==null?void 0:e.call(r,{message:s,messages:this.messages,state:this.state,agent:this}));if(s.role===\"assistant\"&&s.toolCalls)for(let r of s.toolCalls)for(let o of this.subscribers)await((n=o.onNewToolCall)==null?void 0:n.call(o,{toolCall:r,messages:this.messages,state:this.state,agent:this}))}for(let s of this.subscribers)await((t=s.onMessagesChanged)==null?void 0:t.call(s,{messages:this.messages,state:this.state,agent:this}))})()}setMessages(a){this.messages=y(a),(async()=>{var e;for(let n of this.subscribers)await((e=n.onMessagesChanged)==null?void 0:e.call(n,{messages:this.messages,state:this.state,agent:this}))})()}setState(a){this.state=y(a),(async()=>{var e;for(let n of this.subscribers)await((e=n.onStateChanged)==null?void 0:e.call(n,{messages:this.messages,state:this.state,agent:this}))})()}legacy_to_be_removed_runAgentBridged(a){var t;this.agentId=(t=this.agentId)!=null?t:(0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();let e=this.prepareRunAgentInput(a);return(this.middlewares.length===0?this.run(e):this.middlewares.reduceRight((r,o)=>({run:i=>o.run(i,r)}),this).run(e)).pipe(B(this.debug),K(this.debug),nt(this.threadId,e.runId,this.agentId),s=>s.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.map)(r=>(this.debug&&console.debug(\"[LEGACY]:\",JSON.stringify(r)),r))))}};var st=class extends W{constructor(e){var n;super(e);this.abortController=new AbortController;this.url=e.url,this.headers=y((n=e.headers)!=null?n:{})}requestInit(e){return{method:\"POST\",headers:G(_({},this.headers),{\"Content-Type\":\"application/json\",Accept:\"text/event-stream\"}),body:JSON.stringify(e),signal:this.abortController.signal}}runAgent(e,n){var t;return this.abortController=(t=e==null?void 0:e.abortController)!=null?t:new AbortController,super.runAgent(e,n)}abortRun(){this.abortController.abort(),super.abortRun()}run(e){let n=Q(this.url,this.requestInit(e));return et(n)}clone(){var s;let e=super.clone();e.url=this.url,e.headers=y((s=this.headers)!=null?s:{});let n=new AbortController,t=this.abortController.signal;return t.aborted&&n.abort(t.reason),e.abortController=n,e}};function fe(g){let a=[],e=new Map,n=new Map;for(let t of g)if(t.type===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START){let s=t,r=s.messageId;e.has(r)||e.set(r,{contents:[],otherEvents:[]});let o=e.get(r);o.start=s}else if(t.type===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT){let s=t,r=s.messageId;e.has(r)||e.set(r,{contents:[],otherEvents:[]}),e.get(r).contents.push(s)}else if(t.type===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END){let s=t,r=s.messageId;e.has(r)||e.set(r,{contents:[],otherEvents:[]});let o=e.get(r);o.end=s,ht(r,o,a),e.delete(r)}else if(t.type===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START){let s=t,r=s.toolCallId;n.has(r)||n.set(r,{args:[],otherEvents:[]});let o=n.get(r);o.start=s}else if(t.type===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS){let s=t,r=s.toolCallId;n.has(r)||n.set(r,{args:[],otherEvents:[]}),n.get(r).args.push(s)}else if(t.type===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END){let s=t,r=s.toolCallId;n.has(r)||n.set(r,{args:[],otherEvents:[]});let o=n.get(r);o.end=s,yt(r,o,a),n.delete(r)}else{let s=!1;for(let[r,o]of e)if(o.start&&!o.end){o.otherEvents.push(t),s=!0;break}if(!s){for(let[r,o]of n)if(o.start&&!o.end){o.otherEvents.push(t),s=!0;break}}s||a.push(t)}for(let[t,s]of e)ht(t,s,a);for(let[t,s]of n)yt(t,s,a);return a}function ht(g,a,e){if(a.start&&e.push(a.start),a.contents.length>0){let n=a.contents.map(s=>s.delta).join(\"\"),t={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT,messageId:g,delta:n};e.push(t)}a.end&&e.push(a.end);for(let n of a.otherEvents)e.push(n)}function yt(g,a,e){if(a.start&&e.push(a.start),a.args.length>0){let n=a.args.map(s=>s.delta).join(\"\"),t={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS,toolCallId:g,delta:n};e.push(t)}a.end&&e.push(a.end);for(let n of a.otherEvents)e.push(n)}\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2NsaWVudC9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLHdEQUF3RCx3Q0FBd0MsbUNBQW1DLGdGQUFnRiwrQkFBK0Isa0RBQWtELG1CQUFtQixxQkFBcUIsNkJBQTZCLGtEQUFrRCxTQUFTLHNCQUFzQixlQUFlLFNBQVMseURBQXlELDBFQUEwRSxVQUFvTSxVQUFVLGdFQUFnRSxJQUFJLHFDQUFxQyxTQUFTLFdBQVcsTUFBTSxjQUFjLE9BQU8sZ0RBQUUsR0FBaUQsMEJBQTBCLGNBQWMsbUJBQW1CLDJCQUEyQix1QkFBdUIsc0dBQXNHLFNBQVMsTUFBNkIsNEVBQTRFLFNBQVMsZUFBZSx3Q0FBd0MsV0FBVyxHQUFHLHlDQUF5QyxRQUFRLEdBQUcsY0FBYyxrQkFBa0IsR0FBRyxFQUFrQyxrQkFBa0IscUNBQXFDLE9BQU8sd0dBQXdHLFFBQVEsV0FBVyxXQUFXLHVDQUF1Qyx3Q0FBRSxJQUFJLHVDQUFFLEVBQUUsY0FBYyx5REFBRSxXQUFXLGNBQWMsOEJBQThCLE1BQU0sMkNBQTJDLDJDQUEyQyxFQUFFLEVBQUUsMENBQTBDLGVBQWUsS0FBSyxrREFBQyxxQkFBcUIsOEJBQThCLE1BQU0sMkRBQTJELDJDQUEyQyxFQUFFLEVBQUUsZ0NBQWdDLElBQUksK0JBQStCLE1BQU0sd0JBQXdCLGFBQWEsV0FBVyxFQUFFLFdBQVcsS0FBSyxrREFBQyx1QkFBdUIsSUFBSSxvQkFBb0IseUJBQXlCLDZFQUE2RSxFQUFFLFFBQVEsOEJBQThCLE1BQU0sNkRBQTZELHFHQUFxRyxFQUFFLEVBQUUsZ0NBQWdDLDhDQUE4QyxhQUFhLEVBQUUsRUFBRSxFQUFFLEtBQUssV0FBVyxFQUFFLFdBQVcsS0FBSyxrREFBQyxtQkFBbUIsSUFBSSxZQUFZLHlCQUF5Qix5RUFBeUUsRUFBRSxRQUFR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QUFzRCxFQUFFLHdEQUF3RCw0REFBb0csZUFBZSw2QkFBNkIsMkJBQTJCLGtEQUFDLHFCQUFxQixzQkFBc0IsbUJBQW1CLDJCQUEyQixFQUFFLGVBQWUsVUFBVSxpQkFBaUIsa0RBQUMsdUJBQXVCLHNCQUFzQixtQkFBbUIsMkJBQTJCLDRCQUE0QixpQkFBaUIsa0RBQUMsbUJBQW1CLHNCQUFzQixtQkFBbUIsMkJBQTJCLEVBQUUsZUFBZSw4QkFBOEIsaUJBQWlCLGtEQUFDLGtCQUFrQix1QkFBdUIsbUJBQW1CLHVCQUF1QixFQUFFLGVBQWUsVUFBVSxpQkFBaUIsa0RBQUMsaUJBQWlCLHVCQUF1QixtQkFBbUIsdUJBQXVCLHdCQUF3QixpQkFBaUIsa0RBQUMsZ0JBQWdCLHVCQUF1QixtQkFBbUIsdUJBQXVCLEVBQUUsZUFBZSw4QkFBOEIsS0FBSyxTQUFTLHFDQUFxQywyQkFBMkIsTUFBTSxPQUFPLHFDQUFxQywyQkFBMkIsT0FBTyxhQUFhLDJCQUEyQiwyQkFBMkIsU0FBUyxtQkFBbUIsaURBQWlELDZDQUE2QyxLQUFLLGtEQUFDLDJDQUEyQyxVQUFVLHFCQUFxQixxQ0FBcUMsbUJBQW1CLDZDQUE2Qyx5Q0FBeUMsS0FBSyxrREFBQyxzQ0FBc0MsVUFBVSxxQkFBcUIscUNBQTZWO0FBQ3hwakIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWNoaW4vcHJvamVjdHMvZmluYW5jZS1hcHAvZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BhZy11aS9jbGllbnQvZGlzdC9pbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIE10PU9iamVjdC5kZWZpbmVQcm9wZXJ0eSxDdD1PYmplY3QuZGVmaW5lUHJvcGVydGllczt2YXIgUnQ9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM7dmFyIFk9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sczt2YXIgb3Q9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxydD1PYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlO3ZhciBhdD0oZyxhLGUpPT5hIGluIGc/TXQoZyxhLHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMCx2YWx1ZTplfSk6Z1thXT1lLF89KGcsYSk9Pntmb3IodmFyIGUgaW4gYXx8KGE9e30pKW90LmNhbGwoYSxlKSYmYXQoZyxlLGFbZV0pO2lmKFkpZm9yKHZhciBlIG9mIFkoYSkpcnQuY2FsbChhLGUpJiZhdChnLGUsYVtlXSk7cmV0dXJuIGd9LEc9KGcsYSk9PkN0KGcsUnQoYSkpO3ZhciBpdD0oZyxhKT0+e3ZhciBlPXt9O2Zvcih2YXIgbiBpbiBnKW90LmNhbGwoZyxuKSYmYS5pbmRleE9mKG4pPDAmJihlW25dPWdbbl0pO2lmKGchPW51bGwmJlkpZm9yKHZhciBuIG9mIFkoZykpYS5pbmRleE9mKG4pPDAmJnJ0LmNhbGwoZyxuKSYmKGVbbl09Z1tuXSk7cmV0dXJuIGV9O2ltcG9ydHtFdmVudFR5cGUgYXMgUn1mcm9tXCJAYWctdWkvY29yZVwiO2ltcG9ydHttZXJnZUFsbCBhcyBJdCxkZWZhdWx0SWZFbXB0eSBhcyBfdCxjb25jYXRNYXAgYXMgTnR9ZnJvbVwicnhqcy9vcGVyYXRvcnNcIjtpbXBvcnR7b2YgYXMgTHQsRU1QVFkgYXMgd3R9ZnJvbVwicnhqc1wiO2ltcG9ydHt2NCBhcyB4dH1mcm9tXCJ1dWlkXCI7dmFyIHk9Zz0+e2lmKHR5cGVvZiBzdHJ1Y3R1cmVkQ2xvbmU9PVwiZnVuY3Rpb25cIilyZXR1cm4gc3RydWN0dXJlZENsb25lKGcpO3RyeXtyZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShnKSl9Y2F0Y2goYSl7cmV0dXJuIF8oe30sZyl9fTtmdW5jdGlvbiB2ZSgpe3JldHVybiB4dCgpfWltcG9ydHthcHBseVBhdGNoIGFzIGx0fWZyb21cImZhc3QtanNvbi1wYXRjaFwiO2FzeW5jIGZ1bmN0aW9uIHgoZyxhLGUsbil7bGV0IHQ9YSxzPWUscjtmb3IobGV0IG8gb2YgZyl0cnl7bGV0IGk9YXdhaXQgbihvLHkodCkseShzKSk7aWYoaT09PXZvaWQgMCljb250aW51ZTtpZihpLm1lc3NhZ2VzIT09dm9pZCAwJiYodD1pLm1lc3NhZ2VzKSxpLnN0YXRlIT09dm9pZCAwJiYocz1pLnN0YXRlKSxyPWkuc3RvcFByb3BhZ2F0aW9uLHI9PT0hMClicmVha31jYXRjaChpKXtwcm9jZXNzLmVudi5OT0RFX0VOVj09PVwidGVzdFwifHxwcm9jZXNzLmVudi5KRVNUX1dPUktFUl9JRCE9PXZvaWQgMHx8Y29uc29sZS5lcnJvcihcIlN1YnNjcmliZXIgZXJyb3I6XCIsaSk7Y29udGludWV9cmV0dXJuIF8oXyhfKHt9LEpTT04uc3RyaW5naWZ5KHQpIT09SlNPTi5zdHJpbmdpZnkoYSk/e21lc3NhZ2VzOnR9Ont9KSxKU09OLnN0cmluZ2lmeShzKSE9PUpTT04uc3RyaW5naWZ5KGUpP3tzdGF0ZTpzfTp7fSksciE9PXZvaWQgMD97c3RvcFByb3BhZ2F0aW9uOnJ9Ont9KX1pbXBvcnQgT3QgZnJvbVwidW50cnVuY2F0ZS1qc29uXCI7dmFyIHo9KGcsYSxlLG4pPT57bGV0IHQ9eShlLm1lc3NhZ2VzKSxzPXkoZy5zdGF0ZSkscj17fSxvPXA9PntwLm1lc3NhZ2VzIT09dm9pZCAwJiYodD1wLm1lc3NhZ2VzLHIubWVzc2FnZXM9cC5tZXNzYWdlcykscC5zdGF0ZSE9PXZvaWQgMCYmKHM9cC5zdGF0ZSxyLnN0YXRlPXAuc3RhdGUpfSxpPSgpPT57bGV0IHA9eShyKTtyZXR1cm4gcj17fSxwLm1lc3NhZ2VzIT09dm9pZCAwfHxwLnN0YXRlIT09dm9pZCAwP0x0KHApOnd0fTtyZXR1cm4gYS5waXBlKE50KGFzeW5jIHA9Pnt2YXIgVCxBLGMsRixVO2xldCBTPWF3YWl0IHgobix0LHMsKEUsbCxkKT0+e3ZhciBtO3JldHVybihtPUUub25FdmVudCk9PW51bGw/dm9pZCAwOm0uY2FsbChFLHtldmVudDpwLGFnZW50OmUsaW5wdXQ6ZyxtZXNzYWdlczpsLHN0YXRlOmR9KX0pO2lmKG8oUyksUy5zdG9wUHJvcGFnYXRpb249PT0hMClyZXR1cm4gaSgpO3N3aXRjaChwLnR5cGUpe2Nhc2UgUi5URVhUX01FU1NBR0VfU1RBUlQ6e2xldCBFPWF3YWl0IHgobix0LHMsKGwsZCxtKT0+e3ZhciB1O3JldHVybih1PWwub25UZXh0TWVzc2FnZVN0YXJ0RXZlbnQpPT1udWxsP3ZvaWQgMDp1LmNhbGwobCx7ZXZlbnQ6cCxtZXNzYWdlczpkLHN0YXRlOm0sYWdlbnQ6ZSxpbnB1dDpnfSl9KTtpZihvKEUpLEUuc3RvcFByb3BhZ2F0aW9uIT09ITApe2xldHttZXNzYWdlSWQ6bCxyb2xlOmQ9XCJhc3Npc3RhbnRcIn09cCxtPXtpZDpsLHJvbGU6ZCxjb250ZW50OlwiXCJ9O3QucHVzaChtKSxvKHttZXNzYWdlczp0fSl9cmV0dXJuIGkoKX1jYXNlIFIuVEVYVF9NRVNTQUdFX0NPTlRFTlQ6e2xldHttZXNzYWdlSWQ6RSxkZWx0YTpsfT1wLGQ9dC5maW5kKHU9PnUuaWQ9PT1FKTtpZighZClyZXR1cm4gY29uc29sZS53YXJuKGBURVhUX01FU1NBR0VfQ09OVEVOVDogTm8gbWVzc2FnZSBmb3VuZCB3aXRoIElEICcke0V9J2ApLGkoKTtsZXQgbT1hd2FpdCB4KG4sdCxzLCh1LHYsaCk9Pnt2YXIgSTtyZXR1cm4oST11Lm9uVGV4dE1lc3NhZ2VDb250ZW50RXZlbnQpPT1udWxsP3ZvaWQgMDpJLmNhbGwodSx7ZXZlbnQ6cCxtZXNzYWdlczp2LHN0YXRlOmgsYWdlbnQ6ZSxpbnB1dDpnLHRleHRNZXNzYWdlQnVmZmVyOnR5cGVvZiBkLmNvbnRlbnQ9PVwic3RyaW5nXCI/ZC5jb250ZW50OlwiXCJ9KX0pO2lmKG8obSksbS5zdG9wUHJvcGFnYXRpb24hPT0hMCl7bGV0IHU9dHlwZW9mIGQuY29udGVudD09XCJzdHJpbmdcIj9kLmNvbnRlbnQ6XCJcIjtkLmNvbnRlbnQ9YCR7dX0ke2x9YCxvKHttZXNzYWdlczp0fSl9cmV0dXJuIGkoKX1jYXNlIFIuVEVYVF9NRVNTQUdFX0VORDp7bGV0e21lc3NhZ2VJZDpFfT1wLGw9dC5maW5kKG09Pm0uaWQ9PT1FKTtpZighbClyZXR1cm4gY29uc29sZS53YXJuKGBURVhUX01FU1NBR0VfRU5EOiBObyBtZXNzYWdlIGZvdW5kIHdpdGggSUQgJyR7RX0nYCksaSgpO2xldCBkPWF3YWl0IHgobix0LHMsKG0sdSx2KT0+e3ZhciBoO3JldHVybihoPW0ub25UZXh0TWVzc2FnZUVuZEV2ZW50KT09bnVsbD92b2lkIDA6aC5jYWxsKG0se2V2ZW50OnAsbWVzc2FnZXM6dSxzdGF0ZTp2LGFnZW50OmUsaW5wdXQ6Zyx0ZXh0TWVzc2FnZUJ1ZmZlcjp0eXBlb2YgbC5jb250ZW50PT1cInN0cmluZ1wiP2wuY29udGVudDpcIlwifSl9KTtyZXR1cm4gbyhkKSxhd2FpdCBQcm9taXNlLmFsbChuLm1hcChtPT57dmFyIHU7KHU9bS5vbk5ld01lc3NhZ2UpPT1udWxsfHx1LmNhbGwobSx7bWVzc2FnZTpsLG1lc3NhZ2VzOnQsc3RhdGU6cyxhZ2VudDplLGlucHV0Omd9KX0pKSxpKCl9Y2FzZSBSLlRPT0xfQ0FMTF9TVEFSVDp7bGV0IEU9YXdhaXQgeChuLHQscywobCxkLG0pPT57dmFyIHU7cmV0dXJuKHU9bC5vblRvb2xDYWxsU3RhcnRFdmVudCk9PW51bGw/dm9pZCAwOnUuY2FsbChsLHtldmVudDpwLG1lc3NhZ2VzOmQsc3RhdGU6bSxhZ2VudDplLGlucHV0Omd9KX0pO2lmKG8oRSksRS5zdG9wUHJvcGFnYXRpb24hPT0hMCl7bGV0e3Rvb2xDYWxsSWQ6bCx0b29sQ2FsbE5hbWU6ZCxwYXJlbnRNZXNzYWdlSWQ6bX09cCx1O20mJnQubGVuZ3RoPjAmJnRbdC5sZW5ndGgtMV0uaWQ9PT1tP3U9dFt0Lmxlbmd0aC0xXToodT17aWQ6bXx8bCxyb2xlOlwiYXNzaXN0YW50XCIsdG9vbENhbGxzOltdfSx0LnB1c2godSkpLChUPXUudG9vbENhbGxzKSE9bnVsbHx8KHUudG9vbENhbGxzPVtdKSx1LnRvb2xDYWxscy5wdXNoKHtpZDpsLHR5cGU6XCJmdW5jdGlvblwiLGZ1bmN0aW9uOntuYW1lOmQsYXJndW1lbnRzOlwiXCJ9fSksbyh7bWVzc2FnZXM6dH0pfXJldHVybiBpKCl9Y2FzZSBSLlRPT0xfQ0FMTF9BUkdTOntsZXR7dG9vbENhbGxJZDpFLGRlbHRhOmx9PXAsZD10LmZpbmQodj0+e3ZhciBoO3JldHVybihoPXYudG9vbENhbGxzKT09bnVsbD92b2lkIDA6aC5zb21lKEk9PkkuaWQ9PT1FKX0pO2lmKCFkKXJldHVybiBjb25zb2xlLndhcm4oYFRPT0xfQ0FMTF9BUkdTOiBObyBtZXNzYWdlIGZvdW5kIGNvbnRhaW5pbmcgdG9vbCBjYWxsIHdpdGggSUQgJyR7RX0nYCksaSgpO2xldCBtPWQudG9vbENhbGxzLmZpbmQodj0+di5pZD09PUUpO2lmKCFtKXJldHVybiBjb25zb2xlLndhcm4oYFRPT0xfQ0FMTF9BUkdTOiBObyB0b29sIGNhbGwgZm91bmQgd2l0aCBJRCAnJHtFfSdgKSxpKCk7bGV0IHU9YXdhaXQgeChuLHQscywodixoLEkpPT57dmFyIHE7bGV0IEQ9bS5mdW5jdGlvbi5hcmd1bWVudHMsYj1tLmZ1bmN0aW9uLm5hbWUsaj17fTt0cnl7aj1PdChEKX1jYXRjaChUZSl7fXJldHVybihxPXYub25Ub29sQ2FsbEFyZ3NFdmVudCk9PW51bGw/dm9pZCAwOnEuY2FsbCh2LHtldmVudDpwLG1lc3NhZ2VzOmgsc3RhdGU6SSxhZ2VudDplLGlucHV0OmcsdG9vbENhbGxCdWZmZXI6RCx0b29sQ2FsbE5hbWU6YixwYXJ0aWFsVG9vbENhbGxBcmdzOmp9KX0pO3JldHVybiBvKHUpLHUuc3RvcFByb3BhZ2F0aW9uIT09ITAmJihtLmZ1bmN0aW9uLmFyZ3VtZW50cys9bCxvKHttZXNzYWdlczp0fSkpLGkoKX1jYXNlIFIuVE9PTF9DQUxMX0VORDp7bGV0e3Rvb2xDYWxsSWQ6RX09cCxsPXQuZmluZCh1PT57dmFyIHY7cmV0dXJuKHY9dS50b29sQ2FsbHMpPT1udWxsP3ZvaWQgMDp2LnNvbWUoaD0+aC5pZD09PUUpfSk7aWYoIWwpcmV0dXJuIGNvbnNvbGUud2FybihgVE9PTF9DQUxMX0VORDogTm8gbWVzc2FnZSBmb3VuZCBjb250YWluaW5nIHRvb2wgY2FsbCB3aXRoIElEICcke0V9J2ApLGkoKTtsZXQgZD1sLnRvb2xDYWxscy5maW5kKHU9PnUuaWQ9PT1FKTtpZighZClyZXR1cm4gY29uc29sZS53YXJuKGBUT09MX0NBTExfRU5EOiBObyB0b29sIGNhbGwgZm91bmQgd2l0aCBJRCAnJHtFfSdgKSxpKCk7bGV0IG09YXdhaXQgeChuLHQscywodSx2LGgpPT57dmFyIGo7bGV0IEk9ZC5mdW5jdGlvbi5hcmd1bWVudHMsRD1kLmZ1bmN0aW9uLm5hbWUsYj17fTt0cnl7Yj1KU09OLnBhcnNlKEkpfWNhdGNoKHEpe31yZXR1cm4oaj11Lm9uVG9vbENhbGxFbmRFdmVudCk9PW51bGw/dm9pZCAwOmouY2FsbCh1LHtldmVudDpwLG1lc3NhZ2VzOnYsc3RhdGU6aCxhZ2VudDplLGlucHV0OmcsdG9vbENhbGxOYW1lOkQsdG9vbENhbGxBcmdzOmJ9KX0pO3JldHVybiBvKG0pLGF3YWl0IFByb21pc2UuYWxsKG4ubWFwKHU9Pnt2YXIgdjsodj11Lm9uTmV3VG9vbENhbGwpPT1udWxsfHx2LmNhbGwodSx7dG9vbENhbGw6ZCxtZXNzYWdlczp0LHN0YXRlOnMsYWdlbnQ6ZSxpbnB1dDpnfSl9KSksaSgpfWNhc2UgUi5UT09MX0NBTExfUkVTVUxUOntsZXQgRT1hd2FpdCB4KG4sdCxzLChsLGQsbSk9Pnt2YXIgdTtyZXR1cm4odT1sLm9uVG9vbENhbGxSZXN1bHRFdmVudCk9PW51bGw/dm9pZCAwOnUuY2FsbChsLHtldmVudDpwLG1lc3NhZ2VzOmQsc3RhdGU6bSxhZ2VudDplLGlucHV0Omd9KX0pO2lmKG8oRSksRS5zdG9wUHJvcGFnYXRpb24hPT0hMCl7bGV0e21lc3NhZ2VJZDpsLHRvb2xDYWxsSWQ6ZCxjb250ZW50Om0scm9sZTp1fT1wLHY9e2lkOmwsdG9vbENhbGxJZDpkLHJvbGU6dXx8XCJ0b29sXCIsY29udGVudDptfTt0LnB1c2godiksYXdhaXQgUHJvbWlzZS5hbGwobi5tYXAoaD0+e3ZhciBJOyhJPWgub25OZXdNZXNzYWdlKT09bnVsbHx8SS5jYWxsKGgse21lc3NhZ2U6dixtZXNzYWdlczp0LHN0YXRlOnMsYWdlbnQ6ZSxpbnB1dDpnfSl9KSksbyh7bWVzc2FnZXM6dH0pfXJldHVybiBpKCl9Y2FzZSBSLlNUQVRFX1NOQVBTSE9UOntsZXQgRT1hd2FpdCB4KG4sdCxzLChsLGQsbSk9Pnt2YXIgdTtyZXR1cm4odT1sLm9uU3RhdGVTbmFwc2hvdEV2ZW50KT09bnVsbD92b2lkIDA6dS5jYWxsKGwse2V2ZW50OnAsbWVzc2FnZXM6ZCxzdGF0ZTptLGFnZW50OmUsaW5wdXQ6Z30pfSk7aWYobyhFKSxFLnN0b3BQcm9wYWdhdGlvbiE9PSEwKXtsZXR7c25hcHNob3Q6bH09cDtzPWwsbyh7c3RhdGU6c30pfXJldHVybiBpKCl9Y2FzZSBSLlNUQVRFX0RFTFRBOntsZXQgRT1hd2FpdCB4KG4sdCxzLChsLGQsbSk9Pnt2YXIgdTtyZXR1cm4odT1sLm9uU3RhdGVEZWx0YUV2ZW50KT09bnVsbD92b2lkIDA6dS5jYWxsKGwse2V2ZW50OnAsbWVzc2FnZXM6ZCxzdGF0ZTptLGFnZW50OmUsaW5wdXQ6Z30pfSk7aWYobyhFKSxFLnN0b3BQcm9wYWdhdGlvbiE9PSEwKXtsZXR7ZGVsdGE6bH09cDt0cnl7cz1sdChzLGwsITAsITEpLm5ld0RvY3VtZW50LG8oe3N0YXRlOnN9KX1jYXRjaChkKXtsZXQgbT1kIGluc3RhbmNlb2YgRXJyb3I/ZC5tZXNzYWdlOlN0cmluZyhkKTtjb25zb2xlLndhcm4oYEZhaWxlZCB0byBhcHBseSBzdGF0ZSBwYXRjaDpcbkN1cnJlbnQgc3RhdGU6ICR7SlNPTi5zdHJpbmdpZnkocyxudWxsLDIpfVxuUGF0Y2ggb3BlcmF0aW9uczogJHtKU09OLnN0cmluZ2lmeShsLG51bGwsMil9XG5FcnJvcjogJHttfWApfX1yZXR1cm4gaSgpfWNhc2UgUi5NRVNTQUdFU19TTkFQU0hPVDp7bGV0IEU9YXdhaXQgeChuLHQscywobCxkLG0pPT57dmFyIHU7cmV0dXJuKHU9bC5vbk1lc3NhZ2VzU25hcHNob3RFdmVudCk9PW51bGw/dm9pZCAwOnUuY2FsbChsLHtldmVudDpwLG1lc3NhZ2VzOmQsc3RhdGU6bSxhZ2VudDplLGlucHV0Omd9KX0pO2lmKG8oRSksRS5zdG9wUHJvcGFnYXRpb24hPT0hMCl7bGV0e21lc3NhZ2VzOmx9PXA7dD1sLG8oe21lc3NhZ2VzOnR9KX1yZXR1cm4gaSgpfWNhc2UgUi5BQ1RJVklUWV9TTkFQU0hPVDp7bGV0IEU9cCxsPXQuZmluZEluZGV4KGg9PmguaWQ9PT1FLm1lc3NhZ2VJZCksZD1sPj0wP3RbbF06dm9pZCAwLG09KGQ9PW51bGw/dm9pZCAwOmQucm9sZSk9PT1cImFjdGl2aXR5XCI/ZDp2b2lkIDAsdT0oQT1FLnJlcGxhY2UpIT1udWxsP0E6ITAsdj1hd2FpdCB4KG4sdCxzLChoLEksRCk9Pnt2YXIgYjtyZXR1cm4oYj1oLm9uQWN0aXZpdHlTbmFwc2hvdEV2ZW50KT09bnVsbD92b2lkIDA6Yi5jYWxsKGgse2V2ZW50OkUsbWVzc2FnZXM6SSxzdGF0ZTpELGFnZW50OmUsaW5wdXQ6ZyxhY3Rpdml0eU1lc3NhZ2U6bSxleGlzdGluZ01lc3NhZ2U6ZH0pfSk7aWYobyh2KSx2LnN0b3BQcm9wYWdhdGlvbiE9PSEwKXtsZXQgaD17aWQ6RS5tZXNzYWdlSWQscm9sZTpcImFjdGl2aXR5XCIsYWN0aXZpdHlUeXBlOkUuYWN0aXZpdHlUeXBlLGNvbnRlbnQ6eShFLmNvbnRlbnQpfSxJO2w9PT0tMT8odC5wdXNoKGgpLEk9aCk6bT91JiYodFtsXT1HKF8oe30sbSkse2FjdGl2aXR5VHlwZTpFLmFjdGl2aXR5VHlwZSxjb250ZW50OnkoRS5jb250ZW50KX0pKTp1JiYodFtsXT1oLEk9aCksbyh7bWVzc2FnZXM6dH0pLEkmJmF3YWl0IFByb21pc2UuYWxsKG4ubWFwKEQ9Pnt2YXIgYjtyZXR1cm4oYj1ELm9uTmV3TWVzc2FnZSk9PW51bGw/dm9pZCAwOmIuY2FsbChELHttZXNzYWdlOkksbWVzc2FnZXM6dCxzdGF0ZTpzLGFnZW50OmUsaW5wdXQ6Z30pfSkpfXJldHVybiBpKCl9Y2FzZSBSLkFDVElWSVRZX0RFTFRBOntsZXQgRT1wLGw9dC5maW5kSW5kZXgodj0+di5pZD09PUUubWVzc2FnZUlkKTtpZihsPT09LTEpcmV0dXJuIGNvbnNvbGUud2FybihgQUNUSVZJVFlfREVMVEE6IE5vIG1lc3NhZ2UgZm91bmQgd2l0aCBJRCAnJHtFLm1lc3NhZ2VJZH0nIHRvIGFwcGx5IHBhdGNoYCksaSgpO2xldCBkPXRbbF07aWYoZC5yb2xlIT09XCJhY3Rpdml0eVwiKXJldHVybiBjb25zb2xlLndhcm4oYEFDVElWSVRZX0RFTFRBOiBNZXNzYWdlICcke0UubWVzc2FnZUlkfScgaXMgbm90IGFuIGFjdGl2aXR5IG1lc3NhZ2VgKSxpKCk7bGV0IG09ZCx1PWF3YWl0IHgobix0LHMsKHYsaCxJKT0+e3ZhciBEO3JldHVybihEPXYub25BY3Rpdml0eURlbHRhRXZlbnQpPT1udWxsP3ZvaWQgMDpELmNhbGwodix7ZXZlbnQ6RSxtZXNzYWdlczpoLHN0YXRlOkksYWdlbnQ6ZSxpbnB1dDpnLGFjdGl2aXR5TWVzc2FnZTptfSl9KTtpZihvKHUpLHUuc3RvcFByb3BhZ2F0aW9uIT09ITApdHJ5e2xldCB2PXkoKGM9bS5jb250ZW50KSE9bnVsbD9jOnt9KSxJPWx0KHYsKEY9RS5wYXRjaCkhPW51bGw/RjpbXSwhMCwhMSkubmV3RG9jdW1lbnQ7dFtsXT1HKF8oe30sbSkse2NvbnRlbnQ6eShJKSxhY3Rpdml0eVR5cGU6RS5hY3Rpdml0eVR5cGV9KSxvKHttZXNzYWdlczp0fSl9Y2F0Y2godil7bGV0IGg9diBpbnN0YW5jZW9mIEVycm9yP3YubWVzc2FnZTpTdHJpbmcodik7Y29uc29sZS53YXJuKGBGYWlsZWQgdG8gYXBwbHkgYWN0aXZpdHkgcGF0Y2ggZm9yICcke0UubWVzc2FnZUlkfSc6ICR7aH1gKX1yZXR1cm4gaSgpfWNhc2UgUi5SQVc6e2xldCBFPWF3YWl0IHgobix0LHMsKGwsZCxtKT0+e3ZhciB1O3JldHVybih1PWwub25SYXdFdmVudCk9PW51bGw/dm9pZCAwOnUuY2FsbChsLHtldmVudDpwLG1lc3NhZ2VzOmQsc3RhdGU6bSxhZ2VudDplLGlucHV0Omd9KX0pO3JldHVybiBvKEUpLGkoKX1jYXNlIFIuQ1VTVE9NOntsZXQgRT1hd2FpdCB4KG4sdCxzLChsLGQsbSk9Pnt2YXIgdTtyZXR1cm4odT1sLm9uQ3VzdG9tRXZlbnQpPT1udWxsP3ZvaWQgMDp1LmNhbGwobCx7ZXZlbnQ6cCxtZXNzYWdlczpkLHN0YXRlOm0sYWdlbnQ6ZSxpbnB1dDpnfSl9KTtyZXR1cm4gbyhFKSxpKCl9Y2FzZSBSLlJVTl9TVEFSVEVEOntsZXQgRT1hd2FpdCB4KG4sdCxzLChsLGQsbSk9Pnt2YXIgdTtyZXR1cm4odT1sLm9uUnVuU3RhcnRlZEV2ZW50KT09bnVsbD92b2lkIDA6dS5jYWxsKGwse2V2ZW50OnAsbWVzc2FnZXM6ZCxzdGF0ZTptLGFnZW50OmUsaW5wdXQ6Z30pfSk7aWYobyhFKSxFLnN0b3BQcm9wYWdhdGlvbiE9PSEwKXtsZXQgbD1wO2lmKChVPWwuaW5wdXQpIT1udWxsJiZVLm1lc3NhZ2VzKXtmb3IobGV0IGQgb2YgbC5pbnB1dC5tZXNzYWdlcyl0LmZpbmQodT0+dS5pZD09PWQuaWQpfHx0LnB1c2goZCk7byh7bWVzc2FnZXM6dH0pfX1yZXR1cm4gaSgpfWNhc2UgUi5SVU5fRklOSVNIRUQ6e2xldCBFPWF3YWl0IHgobix0LHMsKGwsZCxtKT0+e3ZhciB1O3JldHVybih1PWwub25SdW5GaW5pc2hlZEV2ZW50KT09bnVsbD92b2lkIDA6dS5jYWxsKGwse2V2ZW50OnAsbWVzc2FnZXM6ZCxzdGF0ZTptLGFnZW50OmUsaW5wdXQ6ZyxyZXN1bHQ6cC5yZXN1bHR9KX0pO3JldHVybiBvKEUpLGkoKX1jYXNlIFIuUlVOX0VSUk9SOntsZXQgRT1hd2FpdCB4KG4sdCxzLChsLGQsbSk9Pnt2YXIgdTtyZXR1cm4odT1sLm9uUnVuRXJyb3JFdmVudCk9PW51bGw/dm9pZCAwOnUuY2FsbChsLHtldmVudDpwLG1lc3NhZ2VzOmQsc3RhdGU6bSxhZ2VudDplLGlucHV0Omd9KX0pO3JldHVybiBvKEUpLGkoKX1jYXNlIFIuU1RFUF9TVEFSVEVEOntsZXQgRT1hd2FpdCB4KG4sdCxzLChsLGQsbSk9Pnt2YXIgdTtyZXR1cm4odT1sLm9uU3RlcFN0YXJ0ZWRFdmVudCk9PW51bGw/dm9pZCAwOnUuY2FsbChsLHtldmVudDpwLG1lc3NhZ2VzOmQsc3RhdGU6bSxhZ2VudDplLGlucHV0Omd9KX0pO3JldHVybiBvKEUpLGkoKX1jYXNlIFIuU1RFUF9GSU5JU0hFRDp7bGV0IEU9YXdhaXQgeChuLHQscywobCxkLG0pPT57dmFyIHU7cmV0dXJuKHU9bC5vblN0ZXBGaW5pc2hlZEV2ZW50KT09bnVsbD92b2lkIDA6dS5jYWxsKGwse2V2ZW50OnAsbWVzc2FnZXM6ZCxzdGF0ZTptLGFnZW50OmUsaW5wdXQ6Z30pfSk7cmV0dXJuIG8oRSksaSgpfWNhc2UgUi5URVhUX01FU1NBR0VfQ0hVTks6dGhyb3cgbmV3IEVycm9yKFwiVEVYVF9NRVNTQUdFX0NIVU5LIG11c3QgYmUgdHJhbmZvcm1lZCBiZWZvcmUgYmVpbmcgYXBwbGllZFwiKTtjYXNlIFIuVE9PTF9DQUxMX0NIVU5LOnRocm93IG5ldyBFcnJvcihcIlRPT0xfQ0FMTF9DSFVOSyBtdXN0IGJlIHRyYW5mb3JtZWQgYmVmb3JlIGJlaW5nIGFwcGxpZWRcIik7Y2FzZSBSLlRISU5LSU5HX1NUQVJUOnJldHVybiBpKCk7Y2FzZSBSLlRISU5LSU5HX0VORDpyZXR1cm4gaSgpO2Nhc2UgUi5USElOS0lOR19URVhUX01FU1NBR0VfU1RBUlQ6cmV0dXJuIGkoKTtjYXNlIFIuVEhJTktJTkdfVEVYVF9NRVNTQUdFX0NPTlRFTlQ6cmV0dXJuIGkoKTtjYXNlIFIuVEhJTktJTkdfVEVYVF9NRVNTQUdFX0VORDpyZXR1cm4gaSgpfWxldCBIPXAudHlwZTtyZXR1cm4gaSgpfSksSXQoKSxuLmxlbmd0aD4wP190KHt9KTpwPT5wKX07aW1wb3J0e0V2ZW50VHlwZSBhcyBOLEFHVUlFcnJvciBhcyBMfWZyb21cIkBhZy11aS9jb3JlXCI7aW1wb3J0e3Rocm93RXJyb3IgYXMgdyxvZiBhcyBPfWZyb21cInJ4anNcIjtpbXBvcnR7bWVyZ2VNYXAgYXMgUHR9ZnJvbVwicnhqcy9vcGVyYXRvcnNcIjt2YXIgSz1nPT5hPT57bGV0IGU9bmV3IE1hcCxuPW5ldyBNYXAsdD0hMSxzPSExLHI9ITEsbz1uZXcgTWFwLGk9ITEscD0hMSxTPSExLEg9KCk9PntlLmNsZWFyKCksbi5jbGVhcigpLG8uY2xlYXIoKSxpPSExLHA9ITEsdD0hMSxzPSExLFM9ITB9O3JldHVybiBhLnBpcGUoUHQoVD0+e2xldCBBPVQudHlwZTtpZihnJiZjb25zb2xlLmRlYnVnKFwiW1ZFUklGWV06XCIsSlNPTi5zdHJpbmdpZnkoVCkpLHMpcmV0dXJuIHcoKCk9Pm5ldyBMKGBDYW5ub3Qgc2VuZCBldmVudCB0eXBlICcke0F9JzogVGhlIHJ1biBoYXMgYWxyZWFkeSBlcnJvcmVkIHdpdGggJ1JVTl9FUlJPUicuIE5vIGZ1cnRoZXIgZXZlbnRzIGNhbiBiZSBzZW50LmApKTtpZih0JiZBIT09Ti5SVU5fRVJST1ImJkEhPT1OLlJVTl9TVEFSVEVEKXJldHVybiB3KCgpPT5uZXcgTChgQ2Fubm90IHNlbmQgZXZlbnQgdHlwZSAnJHtBfSc6IFRoZSBydW4gaGFzIGFscmVhZHkgZmluaXNoZWQgd2l0aCAnUlVOX0ZJTklTSEVEJy4gU3RhcnQgYSBuZXcgcnVuIHdpdGggJ1JVTl9TVEFSVEVEJy5gKSk7aWYocil7aWYoQT09PU4uUlVOX1NUQVJURUQpe2lmKFMmJiF0KXJldHVybiB3KCgpPT5uZXcgTChcIkNhbm5vdCBzZW5kICdSVU5fU1RBUlRFRCcgd2hpbGUgYSBydW4gaXMgc3RpbGwgYWN0aXZlLiBUaGUgcHJldmlvdXMgcnVuIG11c3QgYmUgZmluaXNoZWQgd2l0aCAnUlVOX0ZJTklTSEVEJyBiZWZvcmUgc3RhcnRpbmcgYSBuZXcgcnVuLlwiKSk7dCYmSCgpfX1lbHNlIGlmKHI9ITAsQSE9PU4uUlVOX1NUQVJURUQmJkEhPT1OLlJVTl9FUlJPUilyZXR1cm4gdygoKT0+bmV3IEwoXCJGaXJzdCBldmVudCBtdXN0IGJlICdSVU5fU1RBUlRFRCdcIikpO3N3aXRjaChBKXtjYXNlIE4uVEVYVF9NRVNTQUdFX1NUQVJUOntsZXQgYz1ULm1lc3NhZ2VJZDtyZXR1cm4gZS5oYXMoYyk/dygoKT0+bmV3IEwoYENhbm5vdCBzZW5kICdURVhUX01FU1NBR0VfU1RBUlQnIGV2ZW50OiBBIHRleHQgbWVzc2FnZSB3aXRoIElEICcke2N9JyBpcyBhbHJlYWR5IGluIHByb2dyZXNzLiBDb21wbGV0ZSBpdCB3aXRoICdURVhUX01FU1NBR0VfRU5EJyBmaXJzdC5gKSk6KGUuc2V0KGMsITApLE8oVCkpfWNhc2UgTi5URVhUX01FU1NBR0VfQ09OVEVOVDp7bGV0IGM9VC5tZXNzYWdlSWQ7cmV0dXJuIGUuaGFzKGMpP08oVCk6dygoKT0+bmV3IEwoYENhbm5vdCBzZW5kICdURVhUX01FU1NBR0VfQ09OVEVOVCcgZXZlbnQ6IE5vIGFjdGl2ZSB0ZXh0IG1lc3NhZ2UgZm91bmQgd2l0aCBJRCAnJHtjfScuIFN0YXJ0IGEgdGV4dCBtZXNzYWdlIHdpdGggJ1RFWFRfTUVTU0FHRV9TVEFSVCcgZmlyc3QuYCkpfWNhc2UgTi5URVhUX01FU1NBR0VfRU5EOntsZXQgYz1ULm1lc3NhZ2VJZDtyZXR1cm4gZS5oYXMoYyk/KGUuZGVsZXRlKGMpLE8oVCkpOncoKCk9Pm5ldyBMKGBDYW5ub3Qgc2VuZCAnVEVYVF9NRVNTQUdFX0VORCcgZXZlbnQ6IE5vIGFjdGl2ZSB0ZXh0IG1lc3NhZ2UgZm91bmQgd2l0aCBJRCAnJHtjfScuIEEgJ1RFWFRfTUVTU0FHRV9TVEFSVCcgZXZlbnQgbXVzdCBiZSBzZW50IGZpcnN0LmApKX1jYXNlIE4uVE9PTF9DQUxMX1NUQVJUOntsZXQgYz1ULnRvb2xDYWxsSWQ7cmV0dXJuIG4uaGFzKGMpP3coKCk9Pm5ldyBMKGBDYW5ub3Qgc2VuZCAnVE9PTF9DQUxMX1NUQVJUJyBldmVudDogQSB0b29sIGNhbGwgd2l0aCBJRCAnJHtjfScgaXMgYWxyZWFkeSBpbiBwcm9ncmVzcy4gQ29tcGxldGUgaXQgd2l0aCAnVE9PTF9DQUxMX0VORCcgZmlyc3QuYCkpOihuLnNldChjLCEwKSxPKFQpKX1jYXNlIE4uVE9PTF9DQUxMX0FSR1M6e2xldCBjPVQudG9vbENhbGxJZDtyZXR1cm4gbi5oYXMoYyk/TyhUKTp3KCgpPT5uZXcgTChgQ2Fubm90IHNlbmQgJ1RPT0xfQ0FMTF9BUkdTJyBldmVudDogTm8gYWN0aXZlIHRvb2wgY2FsbCBmb3VuZCB3aXRoIElEICcke2N9Jy4gU3RhcnQgYSB0b29sIGNhbGwgd2l0aCAnVE9PTF9DQUxMX1NUQVJUJyBmaXJzdC5gKSl9Y2FzZSBOLlRPT0xfQ0FMTF9FTkQ6e2xldCBjPVQudG9vbENhbGxJZDtyZXR1cm4gbi5oYXMoYyk/KG4uZGVsZXRlKGMpLE8oVCkpOncoKCk9Pm5ldyBMKGBDYW5ub3Qgc2VuZCAnVE9PTF9DQUxMX0VORCcgZXZlbnQ6IE5vIGFjdGl2ZSB0b29sIGNhbGwgZm91bmQgd2l0aCBJRCAnJHtjfScuIEEgJ1RPT0xfQ0FMTF9TVEFSVCcgZXZlbnQgbXVzdCBiZSBzZW50IGZpcnN0LmApKX1jYXNlIE4uU1RFUF9TVEFSVEVEOntsZXQgYz1ULnN0ZXBOYW1lO3JldHVybiBvLmhhcyhjKT93KCgpPT5uZXcgTChgU3RlcCBcIiR7Y31cIiBpcyBhbHJlYWR5IGFjdGl2ZSBmb3IgJ1NURVBfU1RBUlRFRCdgKSk6KG8uc2V0KGMsITApLE8oVCkpfWNhc2UgTi5TVEVQX0ZJTklTSEVEOntsZXQgYz1ULnN0ZXBOYW1lO3JldHVybiBvLmhhcyhjKT8oby5kZWxldGUoYyksTyhUKSk6dygoKT0+bmV3IEwoYENhbm5vdCBzZW5kICdTVEVQX0ZJTklTSEVEJyBmb3Igc3RlcCBcIiR7Y31cIiB0aGF0IHdhcyBub3Qgc3RhcnRlZGApKX1jYXNlIE4uUlVOX1NUQVJURUQ6cmV0dXJuIFM9ITAsTyhUKTtjYXNlIE4uUlVOX0ZJTklTSEVEOntpZihvLnNpemU+MCl7bGV0IGM9QXJyYXkuZnJvbShvLmtleXMoKSkuam9pbihcIiwgXCIpO3JldHVybiB3KCgpPT5uZXcgTChgQ2Fubm90IHNlbmQgJ1JVTl9GSU5JU0hFRCcgd2hpbGUgc3RlcHMgYXJlIHN0aWxsIGFjdGl2ZTogJHtjfWApKX1pZihlLnNpemU+MCl7bGV0IGM9QXJyYXkuZnJvbShlLmtleXMoKSkuam9pbihcIiwgXCIpO3JldHVybiB3KCgpPT5uZXcgTChgQ2Fubm90IHNlbmQgJ1JVTl9GSU5JU0hFRCcgd2hpbGUgdGV4dCBtZXNzYWdlcyBhcmUgc3RpbGwgYWN0aXZlOiAke2N9YCkpfWlmKG4uc2l6ZT4wKXtsZXQgYz1BcnJheS5mcm9tKG4ua2V5cygpKS5qb2luKFwiLCBcIik7cmV0dXJuIHcoKCk9Pm5ldyBMKGBDYW5ub3Qgc2VuZCAnUlVOX0ZJTklTSEVEJyB3aGlsZSB0b29sIGNhbGxzIGFyZSBzdGlsbCBhY3RpdmU6ICR7Y31gKSl9cmV0dXJuIHQ9ITAsTyhUKX1jYXNlIE4uUlVOX0VSUk9SOnJldHVybiBzPSEwLE8oVCk7Y2FzZSBOLkNVU1RPTTpyZXR1cm4gTyhUKTtjYXNlIE4uVEhJTktJTkdfVEVYVF9NRVNTQUdFX1NUQVJUOnJldHVybiBpP3A/dygoKT0+bmV3IEwoXCJDYW5ub3Qgc2VuZCAnVEhJTktJTkdfVEVYVF9NRVNTQUdFX1NUQVJUJyBldmVudDogQSB0aGlua2luZyBtZXNzYWdlIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3MuIENvbXBsZXRlIGl0IHdpdGggJ1RISU5LSU5HX1RFWFRfTUVTU0FHRV9FTkQnIGZpcnN0LlwiKSk6KHA9ITAsTyhUKSk6dygoKT0+bmV3IEwoXCJDYW5ub3Qgc2VuZCAnVEhJTktJTkdfVEVYVF9NRVNTQUdFX1NUQVJUJyBldmVudDogQSB0aGlua2luZyBzdGVwIGlzIG5vdCBpbiBwcm9ncmVzcy4gQ3JlYXRlIG9uZSB3aXRoICdUSElOS0lOR19TVEFSVCcgZmlyc3QuXCIpKTtjYXNlIE4uVEhJTktJTkdfVEVYVF9NRVNTQUdFX0NPTlRFTlQ6cmV0dXJuIHA/TyhUKTp3KCgpPT5uZXcgTChcIkNhbm5vdCBzZW5kICdUSElOS0lOR19URVhUX01FU1NBR0VfQ09OVEVOVCcgZXZlbnQ6IE5vIGFjdGl2ZSB0aGlua2luZyBtZXNzYWdlIGZvdW5kLiBTdGFydCBhIG1lc3NhZ2Ugd2l0aCAnVEhJTktJTkdfVEVYVF9NRVNTQUdFX1NUQVJUJyBmaXJzdC5cIikpO2Nhc2UgTi5USElOS0lOR19URVhUX01FU1NBR0VfRU5EOnJldHVybiBwPyhwPSExLE8oVCkpOncoKCk9Pm5ldyBMKFwiQ2Fubm90IHNlbmQgJ1RISU5LSU5HX1RFWFRfTUVTU0FHRV9FTkQnIGV2ZW50OiBObyBhY3RpdmUgdGhpbmtpbmcgbWVzc2FnZSBmb3VuZC4gQSAnVEhJTktJTkdfVEVYVF9NRVNTQUdFX1NUQVJUJyBldmVudCBtdXN0IGJlIHNlbnQgZmlyc3QuXCIpKTtjYXNlIE4uVEhJTktJTkdfU1RBUlQ6cmV0dXJuIGk/dygoKT0+bmV3IEwoXCJDYW5ub3Qgc2VuZCAnVEhJTktJTkdfU1RBUlQnIGV2ZW50OiBBIHRoaW5raW5nIHN0ZXAgaXMgYWxyZWFkeSBpbiBwcm9ncmVzcy4gRW5kIGl0IHdpdGggJ1RISU5LSU5HX0VORCcgZmlyc3QuXCIpKTooaT0hMCxPKFQpKTtjYXNlIE4uVEhJTktJTkdfRU5EOnJldHVybiBpPyhpPSExLE8oVCkpOncoKCk9Pm5ldyBMKFwiQ2Fubm90IHNlbmQgJ1RISU5LSU5HX0VORCcgZXZlbnQ6IE5vIGFjdGl2ZSB0aGlua2luZyBzdGVwIGZvdW5kLiBBICdUSElOS0lOR19TVEFSVCcgZXZlbnQgbXVzdCBiZSBzZW50IGZpcnN0LlwiKSk7ZGVmYXVsdDpyZXR1cm4gTyhUKX19KSl9O2ltcG9ydHtFdmVudFNjaGVtYXMgYXMgVXR9ZnJvbVwiQGFnLXVpL2NvcmVcIjtpbXBvcnR7U3ViamVjdCBhcyBCdCxSZXBsYXlTdWJqZWN0IGFzIFh0fWZyb21cInJ4anNcIjtpbXBvcnR7T2JzZXJ2YWJsZSBhcyBEdCxmcm9tIGFzIGd0LGRlZmVyIGFzIEh0LHRocm93RXJyb3IgYXMgY3R9ZnJvbVwicnhqc1wiO2ltcG9ydHttZXJnZU1hcCBhcyBHdCxzd2l0Y2hNYXAgYXMgRnR9ZnJvbVwicnhqcy9vcGVyYXRvcnNcIjt2YXIgUT0oZyxhKT0+SHQoKCk9Pmd0KGZldGNoKGcsYSkpKS5waXBlKEZ0KGU9Pnt2YXIgcztpZighZS5vayl7bGV0IHI9ZS5oZWFkZXJzLmdldChcImNvbnRlbnQtdHlwZVwiKXx8XCJcIjtyZXR1cm4gZ3QoZS50ZXh0KCkpLnBpcGUoR3Qobz0+e2xldCBpPW87aWYoci5pbmNsdWRlcyhcImFwcGxpY2F0aW9uL2pzb25cIikpdHJ5e2k9SlNPTi5wYXJzZShvKX1jYXRjaChTKXt9bGV0IHA9bmV3IEVycm9yKGBIVFRQICR7ZS5zdGF0dXN9OiAke3R5cGVvZiBpPT1cInN0cmluZ1wiP2k6SlNPTi5zdHJpbmdpZnkoaSl9YCk7cmV0dXJuIHAuc3RhdHVzPWUuc3RhdHVzLHAucGF5bG9hZD1pLGN0KCgpPT5wKX0pKX1sZXQgbj17dHlwZTpcImhlYWRlcnNcIixzdGF0dXM6ZS5zdGF0dXMsaGVhZGVyczplLmhlYWRlcnN9LHQ9KHM9ZS5ib2R5KT09bnVsbD92b2lkIDA6cy5nZXRSZWFkZXIoKTtyZXR1cm4gdD9uZXcgRHQocj0+KHIubmV4dChuKSwoYXN5bmMoKT0+e3RyeXtmb3IoOzspe2xldHtkb25lOm8sdmFsdWU6aX09YXdhaXQgdC5yZWFkKCk7aWYobylicmVhaztsZXQgcD17dHlwZTpcImRhdGFcIixkYXRhOml9O3IubmV4dChwKX1yLmNvbXBsZXRlKCl9Y2F0Y2gobyl7ci5lcnJvcihvKX19KSgpLCgpPT57dC5jYW5jZWwoKS5jYXRjaChvPT57aWYoKG89PW51bGw/dm9pZCAwOm8ubmFtZSkhPT1cIkFib3J0RXJyb3JcIil0aHJvdyBvfSl9KSk6Y3QoKCk9Pm5ldyBFcnJvcihcIkZhaWxlZCB0byBnZXRSZWFkZXIoKSBmcm9tIHJlc3BvbnNlXCIpKX0pKTtpbXBvcnR7U3ViamVjdCBhcyBidH1mcm9tXCJyeGpzXCI7dmFyIFo9Zz0+e2xldCBhPW5ldyBidCxlPW5ldyBUZXh0RGVjb2RlcihcInV0Zi04XCIse2ZhdGFsOiExfSksbj1cIlwiO2cuc3Vic2NyaWJlKHtuZXh0OnM9PntpZihzLnR5cGUhPT1cImhlYWRlcnNcIiYmcy50eXBlPT09XCJkYXRhXCImJnMuZGF0YSl7bGV0IHI9ZS5kZWNvZGUocy5kYXRhLHtzdHJlYW06ITB9KTtuKz1yO2xldCBvPW4uc3BsaXQoL1xcblxcbi8pO249by5wb3AoKXx8XCJcIjtmb3IobGV0IGkgb2Ygbyl0KGkpfX0sZXJyb3I6cz0+YS5lcnJvcihzKSxjb21wbGV0ZTooKT0+e24mJihuKz1lLmRlY29kZSgpLHQobikpLGEuY29tcGxldGUoKX19KTtmdW5jdGlvbiB0KHMpe2xldCByPXMuc3BsaXQoYFxuYCksbz1bXTtmb3IobGV0IGkgb2YgcilpLnN0YXJ0c1dpdGgoXCJkYXRhOiBcIikmJm8ucHVzaChpLnNsaWNlKDYpKTtpZihvLmxlbmd0aD4wKXRyeXtsZXQgaT1vLmpvaW4oYFxuYCkscD1KU09OLnBhcnNlKGkpO2EubmV4dChwKX1jYXRjaChpKXthLmVycm9yKGkpfX1yZXR1cm4gYS5hc09ic2VydmFibGUoKX07aW1wb3J0e1N1YmplY3QgYXMga3R9ZnJvbVwicnhqc1wiO2ltcG9ydCphcyB1dCBmcm9tXCJAYWctdWkvcHJvdG9cIjt2YXIgdHQ9Zz0+e2xldCBhPW5ldyBrdCxlPW5ldyBVaW50OEFycmF5KDApO2cuc3Vic2NyaWJlKHtuZXh0OnQ9PntpZih0LnR5cGUhPT1cImhlYWRlcnNcIiYmdC50eXBlPT09XCJkYXRhXCImJnQuZGF0YSl7bGV0IHM9bmV3IFVpbnQ4QXJyYXkoZS5sZW5ndGgrdC5kYXRhLmxlbmd0aCk7cy5zZXQoZSwwKSxzLnNldCh0LmRhdGEsZS5sZW5ndGgpLGU9cyxuKCl9fSxlcnJvcjp0PT5hLmVycm9yKHQpLGNvbXBsZXRlOigpPT57aWYoZS5sZW5ndGg+MCl0cnl7bigpfWNhdGNoKHQpe2NvbnNvbGUud2FybihcIkluY29tcGxldGUgb3IgaW52YWxpZCBwcm90b2NvbCBidWZmZXIgZGF0YSBhdCBzdHJlYW0gZW5kXCIpfWEuY29tcGxldGUoKX19KTtmdW5jdGlvbiBuKCl7Zm9yKDtlLmxlbmd0aD49NDspe2xldCByPTQrbmV3IERhdGFWaWV3KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCw0KS5nZXRVaW50MzIoMCwhMSk7aWYoZS5sZW5ndGg8cilicmVhazt0cnl7bGV0IG89ZS5zbGljZSg0LHIpLGk9dXQuZGVjb2RlKG8pO2EubmV4dChpKSxlPWUuc2xpY2Uocil9Y2F0Y2gobyl7bGV0IGk9byBpbnN0YW5jZW9mIEVycm9yP28ubWVzc2FnZTpTdHJpbmcobyk7YS5lcnJvcihuZXcgRXJyb3IoYEZhaWxlZCB0byBkZWNvZGUgcHJvdG9jb2wgYnVmZmVyIG1lc3NhZ2U6ICR7aX1gKSk7cmV0dXJufX19cmV0dXJuIGEuYXNPYnNlcnZhYmxlKCl9O2ltcG9ydCphcyBFdCBmcm9tXCJAYWctdWkvcHJvdG9cIjtpbXBvcnR7RXZlbnRUeXBlIGFzIGp0fWZyb21cIkBhZy11aS9jb3JlXCI7dmFyIGV0PWc9PntsZXQgYT1uZXcgQnQsZT1uZXcgWHQsbj0hMTtyZXR1cm4gZy5zdWJzY3JpYmUoe25leHQ6dD0+e2UubmV4dCh0KSx0LnR5cGU9PT1cImhlYWRlcnNcIiYmIW4/KG49ITAsdC5oZWFkZXJzLmdldChcImNvbnRlbnQtdHlwZVwiKT09PUV0LkFHVUlfTUVESUFfVFlQRT90dChlKS5zdWJzY3JpYmUoe25leHQ6cj0+YS5uZXh0KHIpLGVycm9yOnI9PmEuZXJyb3IociksY29tcGxldGU6KCk9PmEuY29tcGxldGUoKX0pOlooZSkuc3Vic2NyaWJlKHtuZXh0OnI9Pnt0cnl7bGV0IG89VXQucGFyc2Uocik7YS5uZXh0KG8pfWNhdGNoKG8pe2EuZXJyb3Iobyl9fSxlcnJvcjpyPT57aWYoKHI9PW51bGw/dm9pZCAwOnIubmFtZSk9PT1cIkFib3J0RXJyb3JcIil7YS5uZXh0KHt0eXBlOmp0LlJVTl9FUlJPUixyYXdFdmVudDpyfSksYS5jb21wbGV0ZSgpO3JldHVybn1yZXR1cm4gYS5lcnJvcihyKX0sY29tcGxldGU6KCk9PmEuY29tcGxldGUoKX0pKTpufHxhLmVycm9yKG5ldyBFcnJvcihcIk5vIGhlYWRlcnMgZXZlbnQgcmVjZWl2ZWQgYmVmb3JlIGRhdGEgZXZlbnRzXCIpKX0sZXJyb3I6dD0+e2UuZXJyb3IodCksYS5lcnJvcih0KX0sY29tcGxldGU6KCk9PntlLmNvbXBsZXRlKCl9fSksYS5hc09ic2VydmFibGUoKX07aW1wb3J0e21lcmdlTWFwIGFzIGVlfWZyb21cInJ4anMvb3BlcmF0b3JzXCI7aW1wb3J0e2FwcGx5UGF0Y2ggYXMgbmV9ZnJvbVwiZmFzdC1qc29uLXBhdGNoXCI7aW1wb3J0e0V2ZW50VHlwZSBhcyBQfWZyb21cIkBhZy11aS9jb3JlXCI7aW1wb3J0e3ogYXMgZn1mcm9tXCJ6b2RcIjt2YXIgQz1mLmVudW0oW1wiVGV4dE1lc3NhZ2VTdGFydFwiLFwiVGV4dE1lc3NhZ2VDb250ZW50XCIsXCJUZXh0TWVzc2FnZUVuZFwiLFwiQWN0aW9uRXhlY3V0aW9uU3RhcnRcIixcIkFjdGlvbkV4ZWN1dGlvbkFyZ3NcIixcIkFjdGlvbkV4ZWN1dGlvbkVuZFwiLFwiQWN0aW9uRXhlY3V0aW9uUmVzdWx0XCIsXCJBZ2VudFN0YXRlTWVzc2FnZVwiLFwiTWV0YUV2ZW50XCIsXCJSdW5TdGFydGVkXCIsXCJSdW5GaW5pc2hlZFwiLFwiUnVuRXJyb3JcIixcIk5vZGVTdGFydGVkXCIsXCJOb2RlRmluaXNoZWRcIl0pLHp0PWYuZW51bShbXCJMYW5nR3JhcGhJbnRlcnJ1cHRFdmVudFwiLFwiUHJlZGljdFN0YXRlXCIsXCJFeGl0XCJdKSxLdD1mLm9iamVjdCh7dHlwZTpmLmxpdGVyYWwoQy5lbnVtLlRleHRNZXNzYWdlU3RhcnQpLG1lc3NhZ2VJZDpmLnN0cmluZygpLHBhcmVudE1lc3NhZ2VJZDpmLnN0cmluZygpLm9wdGlvbmFsKCkscm9sZTpmLnN0cmluZygpLm9wdGlvbmFsKCl9KSxKdD1mLm9iamVjdCh7dHlwZTpmLmxpdGVyYWwoQy5lbnVtLlRleHRNZXNzYWdlQ29udGVudCksbWVzc2FnZUlkOmYuc3RyaW5nKCksY29udGVudDpmLnN0cmluZygpfSksJHQ9Zi5vYmplY3Qoe3R5cGU6Zi5saXRlcmFsKEMuZW51bS5UZXh0TWVzc2FnZUVuZCksbWVzc2FnZUlkOmYuc3RyaW5nKCl9KSxWdD1mLm9iamVjdCh7dHlwZTpmLmxpdGVyYWwoQy5lbnVtLkFjdGlvbkV4ZWN1dGlvblN0YXJ0KSxhY3Rpb25FeGVjdXRpb25JZDpmLnN0cmluZygpLGFjdGlvbk5hbWU6Zi5zdHJpbmcoKSxwYXJlbnRNZXNzYWdlSWQ6Zi5zdHJpbmcoKS5vcHRpb25hbCgpfSksV3Q9Zi5vYmplY3Qoe3R5cGU6Zi5saXRlcmFsKEMuZW51bS5BY3Rpb25FeGVjdXRpb25BcmdzKSxhY3Rpb25FeGVjdXRpb25JZDpmLnN0cmluZygpLGFyZ3M6Zi5zdHJpbmcoKX0pLFl0PWYub2JqZWN0KHt0eXBlOmYubGl0ZXJhbChDLmVudW0uQWN0aW9uRXhlY3V0aW9uRW5kKSxhY3Rpb25FeGVjdXRpb25JZDpmLnN0cmluZygpfSkscXQ9Zi5vYmplY3Qoe3R5cGU6Zi5saXRlcmFsKEMuZW51bS5BY3Rpb25FeGVjdXRpb25SZXN1bHQpLGFjdGlvbk5hbWU6Zi5zdHJpbmcoKSxhY3Rpb25FeGVjdXRpb25JZDpmLnN0cmluZygpLHJlc3VsdDpmLnN0cmluZygpfSksUXQ9Zi5vYmplY3Qoe3R5cGU6Zi5saXRlcmFsKEMuZW51bS5BZ2VudFN0YXRlTWVzc2FnZSksdGhyZWFkSWQ6Zi5zdHJpbmcoKSxhZ2VudE5hbWU6Zi5zdHJpbmcoKSxub2RlTmFtZTpmLnN0cmluZygpLHJ1bklkOmYuc3RyaW5nKCksYWN0aXZlOmYuYm9vbGVhbigpLHJvbGU6Zi5zdHJpbmcoKSxzdGF0ZTpmLnN0cmluZygpLHJ1bm5pbmc6Zi5ib29sZWFuKCl9KSxadD1mLm9iamVjdCh7dHlwZTpmLmxpdGVyYWwoQy5lbnVtLk1ldGFFdmVudCksbmFtZTp6dCx2YWx1ZTpmLmFueSgpfSksdGU9Zi5vYmplY3Qoe3R5cGU6Zi5saXRlcmFsKEMuZW51bS5SdW5FcnJvciksbWVzc2FnZTpmLnN0cmluZygpLGNvZGU6Zi5zdHJpbmcoKS5vcHRpb25hbCgpfSksJG49Zi5kaXNjcmltaW5hdGVkVW5pb24oXCJ0eXBlXCIsW0t0LEp0LCR0LFZ0LFd0LFl0LHF0LFF0LFp0LHRlXSksVm49Zi5vYmplY3Qoe2lkOmYuc3RyaW5nKCkscm9sZTpmLnN0cmluZygpLGNvbnRlbnQ6Zi5zdHJpbmcoKSxwYXJlbnRNZXNzYWdlSWQ6Zi5zdHJpbmcoKS5vcHRpb25hbCgpfSksV249Zi5vYmplY3Qoe2lkOmYuc3RyaW5nKCksbmFtZTpmLnN0cmluZygpLGFyZ3VtZW50czpmLmFueSgpLHBhcmVudE1lc3NhZ2VJZDpmLnN0cmluZygpLm9wdGlvbmFsKCl9KSxZbj1mLm9iamVjdCh7aWQ6Zi5zdHJpbmcoKSxyZXN1bHQ6Zi5hbnkoKSxhY3Rpb25FeGVjdXRpb25JZDpmLnN0cmluZygpLGFjdGlvbk5hbWU6Zi5zdHJpbmcoKX0pO2ltcG9ydCBzZSBmcm9tXCJ1bnRydW5jYXRlLWpzb25cIjt2YXIgYWU9Zz0+e2lmKHR5cGVvZiBnPT1cInN0cmluZ1wiKXJldHVybiBnO2lmKCFBcnJheS5pc0FycmF5KGcpKXJldHVybjtsZXQgYT1nLmZpbHRlcihlPT5lLnR5cGU9PT1cInRleHRcIikubWFwKGU9PmUudGV4dCkuZmlsdGVyKGU9PmUubGVuZ3RoPjApO2lmKGEubGVuZ3RoIT09MClyZXR1cm4gYS5qb2luKGBcbmApfSxudD0oZyxhLGUpPT5uPT57bGV0IHQ9e30scz0hMCxyPSEwLG89XCJcIixpPW51bGwscD1udWxsLFM9W10sSD17fSxUPUE9Pnt0eXBlb2YgQT09XCJvYmplY3RcIiYmQSE9PW51bGwmJihcIm1lc3NhZ2VzXCJpbiBBJiZkZWxldGUgQS5tZXNzYWdlcyx0PUEpfTtyZXR1cm4gbi5waXBlKGVlKEE9Pntzd2l0Y2goQS50eXBlKXtjYXNlIFAuVEVYVF9NRVNTQUdFX1NUQVJUOntsZXQgYz1BO3JldHVyblt7dHlwZTpDLmVudW0uVGV4dE1lc3NhZ2VTdGFydCxtZXNzYWdlSWQ6Yy5tZXNzYWdlSWQscm9sZTpjLnJvbGV9XX1jYXNlIFAuVEVYVF9NRVNTQUdFX0NPTlRFTlQ6e2xldCBjPUE7cmV0dXJuW3t0eXBlOkMuZW51bS5UZXh0TWVzc2FnZUNvbnRlbnQsbWVzc2FnZUlkOmMubWVzc2FnZUlkLGNvbnRlbnQ6Yy5kZWx0YX1dfWNhc2UgUC5URVhUX01FU1NBR0VfRU5EOntsZXQgYz1BO3JldHVyblt7dHlwZTpDLmVudW0uVGV4dE1lc3NhZ2VFbmQsbWVzc2FnZUlkOmMubWVzc2FnZUlkfV19Y2FzZSBQLlRPT0xfQ0FMTF9TVEFSVDp7bGV0IGM9QTtyZXR1cm4gUy5wdXNoKHtpZDpjLnRvb2xDYWxsSWQsdHlwZTpcImZ1bmN0aW9uXCIsZnVuY3Rpb246e25hbWU6Yy50b29sQ2FsbE5hbWUsYXJndW1lbnRzOlwiXCJ9fSkscj0hMCxIW2MudG9vbENhbGxJZF09Yy50b29sQ2FsbE5hbWUsW3t0eXBlOkMuZW51bS5BY3Rpb25FeGVjdXRpb25TdGFydCxhY3Rpb25FeGVjdXRpb25JZDpjLnRvb2xDYWxsSWQsYWN0aW9uTmFtZTpjLnRvb2xDYWxsTmFtZSxwYXJlbnRNZXNzYWdlSWQ6Yy5wYXJlbnRNZXNzYWdlSWR9XX1jYXNlIFAuVE9PTF9DQUxMX0FSR1M6e2xldCBjPUEsRj1TLmZpbmQoRT0+RS5pZD09PWMudG9vbENhbGxJZCk7aWYoIUYpcmV0dXJuIGNvbnNvbGUud2FybihgVE9PTF9DQUxMX0FSR1M6IE5vIHRvb2wgY2FsbCBmb3VuZCB3aXRoIElEICcke2MudG9vbENhbGxJZH0nYCksW107Ri5mdW5jdGlvbi5hcmd1bWVudHMrPWMuZGVsdGE7bGV0IFU9ITE7aWYocCl7bGV0IEU9cC5maW5kKGw9PmwudG9vbD09Ri5mdW5jdGlvbi5uYW1lKTtpZihFKXRyeXtsZXQgbD1KU09OLnBhcnNlKHNlKEYuZnVuY3Rpb24uYXJndW1lbnRzKSk7RS50b29sX2FyZ3VtZW50JiZFLnRvb2xfYXJndW1lbnQgaW4gbD8oVChHKF8oe30sdCkse1tFLnN0YXRlX2tleV06bFtFLnRvb2xfYXJndW1lbnRdfSkpLFU9ITApOkUudG9vbF9hcmd1bWVudHx8KFQoRyhfKHt9LHQpLHtbRS5zdGF0ZV9rZXldOmx9KSksVT0hMCl9Y2F0Y2gobCl7fX1yZXR1cm5be3R5cGU6Qy5lbnVtLkFjdGlvbkV4ZWN1dGlvbkFyZ3MsYWN0aW9uRXhlY3V0aW9uSWQ6Yy50b29sQ2FsbElkLGFyZ3M6Yy5kZWx0YX0sLi4uVT9be3R5cGU6Qy5lbnVtLkFnZW50U3RhdGVNZXNzYWdlLHRocmVhZElkOmcsYWdlbnROYW1lOmUsbm9kZU5hbWU6byxydW5JZDphLHJ1bm5pbmc6cyxyb2xlOlwiYXNzaXN0YW50XCIsc3RhdGU6SlNPTi5zdHJpbmdpZnkodCksYWN0aXZlOnJ9XTpbXV19Y2FzZSBQLlRPT0xfQ0FMTF9FTkQ6e2xldCBjPUE7cmV0dXJuW3t0eXBlOkMuZW51bS5BY3Rpb25FeGVjdXRpb25FbmQsYWN0aW9uRXhlY3V0aW9uSWQ6Yy50b29sQ2FsbElkfV19Y2FzZSBQLlRPT0xfQ0FMTF9SRVNVTFQ6e2xldCBjPUE7cmV0dXJuW3t0eXBlOkMuZW51bS5BY3Rpb25FeGVjdXRpb25SZXN1bHQsYWN0aW9uRXhlY3V0aW9uSWQ6Yy50b29sQ2FsbElkLHJlc3VsdDpjLmNvbnRlbnQsYWN0aW9uTmFtZTpIW2MudG9vbENhbGxJZF18fFwidW5rbm93blwifV19Y2FzZSBQLlJBVzpyZXR1cm5bXTtjYXNlIFAuQ1VTVE9NOntsZXQgYz1BO3N3aXRjaChjLm5hbWUpe2Nhc2VcIkV4aXRcIjpzPSExO2JyZWFrO2Nhc2VcIlByZWRpY3RTdGF0ZVwiOnA9Yy52YWx1ZTticmVha31yZXR1cm5be3R5cGU6Qy5lbnVtLk1ldGFFdmVudCxuYW1lOmMubmFtZSx2YWx1ZTpjLnZhbHVlfV19Y2FzZSBQLlNUQVRFX1NOQVBTSE9UOnJldHVybiBUKEEuc25hcHNob3QpLFt7dHlwZTpDLmVudW0uQWdlbnRTdGF0ZU1lc3NhZ2UsdGhyZWFkSWQ6ZyxhZ2VudE5hbWU6ZSxub2RlTmFtZTpvLHJ1bklkOmEscnVubmluZzpzLHJvbGU6XCJhc3Npc3RhbnRcIixzdGF0ZTpKU09OLnN0cmluZ2lmeSh0KSxhY3RpdmU6cn1dO2Nhc2UgUC5TVEFURV9ERUxUQTp7bGV0IEY9bmUodCxBLmRlbHRhLCEwLCExKTtyZXR1cm4gRj8oVChGLm5ld0RvY3VtZW50KSxbe3R5cGU6Qy5lbnVtLkFnZW50U3RhdGVNZXNzYWdlLHRocmVhZElkOmcsYWdlbnROYW1lOmUsbm9kZU5hbWU6byxydW5JZDphLHJ1bm5pbmc6cyxyb2xlOlwiYXNzaXN0YW50XCIsc3RhdGU6SlNPTi5zdHJpbmdpZnkodCksYWN0aXZlOnJ9XSk6W119Y2FzZSBQLk1FU1NBR0VTX1NOQVBTSE9UOnJldHVybiBpPUEubWVzc2FnZXMsW3t0eXBlOkMuZW51bS5BZ2VudFN0YXRlTWVzc2FnZSx0aHJlYWRJZDpnLGFnZW50TmFtZTplLG5vZGVOYW1lOm8scnVuSWQ6YSxydW5uaW5nOnMscm9sZTpcImFzc2lzdGFudFwiLHN0YXRlOkpTT04uc3RyaW5naWZ5KF8oXyh7fSx0KSxpP3ttZXNzYWdlczppfTp7fSkpLGFjdGl2ZTohMH1dO2Nhc2UgUC5SVU5fU1RBUlRFRDpyZXR1cm5bXTtjYXNlIFAuUlVOX0ZJTklTSEVEOnJldHVybiBpJiYodC5tZXNzYWdlcz1pKSxPYmplY3Qua2V5cyh0KS5sZW5ndGg9PT0wP1tdOlt7dHlwZTpDLmVudW0uQWdlbnRTdGF0ZU1lc3NhZ2UsdGhyZWFkSWQ6ZyxhZ2VudE5hbWU6ZSxub2RlTmFtZTpvLHJ1bklkOmEscnVubmluZzpzLHJvbGU6XCJhc3Npc3RhbnRcIixzdGF0ZTpKU09OLnN0cmluZ2lmeShfKF8oe30sdCksaT97bWVzc2FnZXM6b2UoaSl9Ont9KSksYWN0aXZlOiExfV07Y2FzZSBQLlJVTl9FUlJPUjp7bGV0IGM9QTtyZXR1cm5be3R5cGU6Qy5lbnVtLlJ1bkVycm9yLG1lc3NhZ2U6Yy5tZXNzYWdlLGNvZGU6Yy5jb2RlfV19Y2FzZSBQLlNURVBfU1RBUlRFRDpyZXR1cm4gbz1BLnN0ZXBOYW1lLFM9W10scD1udWxsLFt7dHlwZTpDLmVudW0uQWdlbnRTdGF0ZU1lc3NhZ2UsdGhyZWFkSWQ6ZyxhZ2VudE5hbWU6ZSxub2RlTmFtZTpvLHJ1bklkOmEscnVubmluZzpzLHJvbGU6XCJhc3Npc3RhbnRcIixzdGF0ZTpKU09OLnN0cmluZ2lmeSh0KSxhY3RpdmU6ITB9XTtjYXNlIFAuU1RFUF9GSU5JU0hFRDpyZXR1cm4gUz1bXSxwPW51bGwsW3t0eXBlOkMuZW51bS5BZ2VudFN0YXRlTWVzc2FnZSx0aHJlYWRJZDpnLGFnZW50TmFtZTplLG5vZGVOYW1lOm8scnVuSWQ6YSxydW5uaW5nOnMscm9sZTpcImFzc2lzdGFudFwiLHN0YXRlOkpTT04uc3RyaW5naWZ5KHQpLGFjdGl2ZTohMX1dO2RlZmF1bHQ6cmV0dXJuW119fSkpfTtmdW5jdGlvbiBvZShnKXt2YXIgZTtsZXQgYT1bXTtmb3IobGV0IG4gb2YgZylpZihuLnJvbGU9PT1cImFzc2lzdGFudFwifHxuLnJvbGU9PT1cInVzZXJcInx8bi5yb2xlPT09XCJzeXN0ZW1cIil7bGV0IHQ9YWUobi5jb250ZW50KTtpZih0KXtsZXQgcz17aWQ6bi5pZCxyb2xlOm4ucm9sZSxjb250ZW50OnR9O2EucHVzaChzKX1pZihuLnJvbGU9PT1cImFzc2lzdGFudFwiJiZuLnRvb2xDYWxscyYmbi50b29sQ2FsbHMubGVuZ3RoPjApZm9yKGxldCBzIG9mIG4udG9vbENhbGxzKXtsZXQgcj17aWQ6cy5pZCxuYW1lOnMuZnVuY3Rpb24ubmFtZSxhcmd1bWVudHM6SlNPTi5wYXJzZShzLmZ1bmN0aW9uLmFyZ3VtZW50cykscGFyZW50TWVzc2FnZUlkOm4uaWR9O2EucHVzaChyKX19ZWxzZSBpZihuLnJvbGU9PT1cInRvb2xcIil7bGV0IHQ9XCJ1bmtub3duXCI7Zm9yKGxldCByIG9mIGcpaWYoci5yb2xlPT09XCJhc3Npc3RhbnRcIiYmKChlPXIudG9vbENhbGxzKSE9bnVsbCYmZS5sZW5ndGgpKXtmb3IobGV0IG8gb2Ygci50b29sQ2FsbHMpaWYoby5pZD09PW4udG9vbENhbGxJZCl7dD1vLmZ1bmN0aW9uLm5hbWU7YnJlYWt9fWxldCBzPXtpZDpuLmlkLHJlc3VsdDpuLmNvbnRlbnQsYWN0aW9uRXhlY3V0aW9uSWQ6bi50b29sQ2FsbElkLGFjdGlvbk5hbWU6dH07YS5wdXNoKHMpfXJldHVybiBhfWltcG9ydHt2NCBhcyBWfWZyb21cInV1aWRcIjtpbXBvcnR7Y29tcGFyZVZlcnNpb25zIGFzIEVlfWZyb21cImNvbXBhcmUtdmVyc2lvbnNcIjtpbXBvcnR7Y2F0Y2hFcnJvciBhcyBkdCxtYXAgYXMgbXQsdGFwIGFzIHBlfWZyb21cInJ4anMvb3BlcmF0b3JzXCI7aW1wb3J0e2ZpbmFsaXplIGFzIGZ0fWZyb21cInJ4anMvb3BlcmF0b3JzXCI7aW1wb3J0e3BpcGUgYXMgVHQsZnJvbSBhcyBkZSxvZiBhcyBTdCxFTVBUWSBhcyBtZX1mcm9tXCJyeGpzXCI7aW1wb3J0e2xhc3RWYWx1ZUZyb20gYXMgQXR9ZnJvbVwicnhqc1wiO2ltcG9ydHttZXJnZU1hcCBhcyByZSxmaW5hbGl6ZSBhcyBpZX1mcm9tXCJyeGpzXCI7aW1wb3J0e0V2ZW50VHlwZSBhcyBNfWZyb21cIkBhZy11aS9jb3JlXCI7dmFyIEI9Zz0+YT0+e2xldCBlLG4sdCxzPSgpPT57aWYoIWV8fHQhPT1cInRleHRcIil0aHJvdyBuZXcgRXJyb3IoXCJObyB0ZXh0IG1lc3NhZ2UgdG8gY2xvc2VcIik7bGV0IGk9e3R5cGU6TS5URVhUX01FU1NBR0VfRU5ELG1lc3NhZ2VJZDplLm1lc3NhZ2VJZH07cmV0dXJuIHQ9dm9pZCAwLGU9dm9pZCAwLGcmJmNvbnNvbGUuZGVidWcoXCJbVFJBTlNGT1JNXTogVEVYVF9NRVNTQUdFX0VORFwiLEpTT04uc3RyaW5naWZ5KGkpKSxpfSxyPSgpPT57aWYoIW58fHQhPT1cInRvb2xcIil0aHJvdyBuZXcgRXJyb3IoXCJObyB0b29sIGNhbGwgdG8gY2xvc2VcIik7bGV0IGk9e3R5cGU6TS5UT09MX0NBTExfRU5ELHRvb2xDYWxsSWQ6bi50b29sQ2FsbElkfTtyZXR1cm4gdD12b2lkIDAsbj12b2lkIDAsZyYmY29uc29sZS5kZWJ1ZyhcIltUUkFOU0ZPUk1dOiBUT09MX0NBTExfRU5EXCIsSlNPTi5zdHJpbmdpZnkoaSkpLGl9LG89KCk9PnQ9PT1cInRleHRcIj9bcygpXTp0PT09XCJ0b29sXCI/W3IoKV06W107cmV0dXJuIGEucGlwZShyZShpPT57c3dpdGNoKGkudHlwZSl7Y2FzZSBNLlRFWFRfTUVTU0FHRV9TVEFSVDpjYXNlIE0uVEVYVF9NRVNTQUdFX0NPTlRFTlQ6Y2FzZSBNLlRFWFRfTUVTU0FHRV9FTkQ6Y2FzZSBNLlRPT0xfQ0FMTF9TVEFSVDpjYXNlIE0uVE9PTF9DQUxMX0FSR1M6Y2FzZSBNLlRPT0xfQ0FMTF9FTkQ6Y2FzZSBNLlRPT0xfQ0FMTF9SRVNVTFQ6Y2FzZSBNLlNUQVRFX1NOQVBTSE9UOmNhc2UgTS5TVEFURV9ERUxUQTpjYXNlIE0uTUVTU0FHRVNfU05BUFNIT1Q6Y2FzZSBNLkNVU1RPTTpjYXNlIE0uUlVOX1NUQVJURUQ6Y2FzZSBNLlJVTl9GSU5JU0hFRDpjYXNlIE0uUlVOX0VSUk9SOmNhc2UgTS5TVEVQX1NUQVJURUQ6Y2FzZSBNLlNURVBfRklOSVNIRUQ6Y2FzZSBNLlRISU5LSU5HX1NUQVJUOmNhc2UgTS5USElOS0lOR19FTkQ6Y2FzZSBNLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9TVEFSVDpjYXNlIE0uVEhJTktJTkdfVEVYVF9NRVNTQUdFX0NPTlRFTlQ6Y2FzZSBNLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9FTkQ6cmV0dXJuWy4uLm8oKSxpXTtjYXNlIE0uUkFXOmNhc2UgTS5BQ1RJVklUWV9TTkFQU0hPVDpjYXNlIE0uQUNUSVZJVFlfREVMVEE6cmV0dXJuW2ldO2Nhc2UgTS5URVhUX01FU1NBR0VfQ0hVTks6bGV0IFM9aSxIPVtdO2lmKCh0IT09XCJ0ZXh0XCJ8fFMubWVzc2FnZUlkIT09dm9pZCAwJiZTLm1lc3NhZ2VJZCE9PShlPT1udWxsP3ZvaWQgMDplLm1lc3NhZ2VJZCkpJiZILnB1c2goLi4ubygpKSx0IT09XCJ0ZXh0XCIpe2lmKFMubWVzc2FnZUlkPT09dm9pZCAwKXRocm93IG5ldyBFcnJvcihcIkZpcnN0IFRFWFRfTUVTU0FHRV9DSFVOSyBtdXN0IGhhdmUgYSBtZXNzYWdlSWRcIik7ZT17bWVzc2FnZUlkOlMubWVzc2FnZUlkfSx0PVwidGV4dFwiO2xldCBjPXt0eXBlOk0uVEVYVF9NRVNTQUdFX1NUQVJULG1lc3NhZ2VJZDpTLm1lc3NhZ2VJZCxyb2xlOlMucm9sZXx8XCJhc3Npc3RhbnRcIn07SC5wdXNoKGMpLGcmJmNvbnNvbGUuZGVidWcoXCJbVFJBTlNGT1JNXTogVEVYVF9NRVNTQUdFX1NUQVJUXCIsSlNPTi5zdHJpbmdpZnkoYykpfWlmKFMuZGVsdGEhPT12b2lkIDApe2xldCBjPXt0eXBlOk0uVEVYVF9NRVNTQUdFX0NPTlRFTlQsbWVzc2FnZUlkOmUubWVzc2FnZUlkLGRlbHRhOlMuZGVsdGF9O0gucHVzaChjKSxnJiZjb25zb2xlLmRlYnVnKFwiW1RSQU5TRk9STV06IFRFWFRfTUVTU0FHRV9DT05URU5UXCIsSlNPTi5zdHJpbmdpZnkoYykpfXJldHVybiBIO2Nhc2UgTS5UT09MX0NBTExfQ0hVTks6bGV0IFQ9aSxBPVtdO2lmKCh0IT09XCJ0b29sXCJ8fFQudG9vbENhbGxJZCE9PXZvaWQgMCYmVC50b29sQ2FsbElkIT09KG49PW51bGw/dm9pZCAwOm4udG9vbENhbGxJZCkpJiZBLnB1c2goLi4ubygpKSx0IT09XCJ0b29sXCIpe2lmKFQudG9vbENhbGxJZD09PXZvaWQgMCl0aHJvdyBuZXcgRXJyb3IoXCJGaXJzdCBUT09MX0NBTExfQ0hVTksgbXVzdCBoYXZlIGEgdG9vbENhbGxJZFwiKTtpZihULnRvb2xDYWxsTmFtZT09PXZvaWQgMCl0aHJvdyBuZXcgRXJyb3IoXCJGaXJzdCBUT09MX0NBTExfQ0hVTksgbXVzdCBoYXZlIGEgdG9vbENhbGxOYW1lXCIpO249e3Rvb2xDYWxsSWQ6VC50b29sQ2FsbElkLHRvb2xDYWxsTmFtZTpULnRvb2xDYWxsTmFtZSxwYXJlbnRNZXNzYWdlSWQ6VC5wYXJlbnRNZXNzYWdlSWR9LHQ9XCJ0b29sXCI7bGV0IGM9e3R5cGU6TS5UT09MX0NBTExfU1RBUlQsdG9vbENhbGxJZDpULnRvb2xDYWxsSWQsdG9vbENhbGxOYW1lOlQudG9vbENhbGxOYW1lLHBhcmVudE1lc3NhZ2VJZDpULnBhcmVudE1lc3NhZ2VJZH07QS5wdXNoKGMpLGcmJmNvbnNvbGUuZGVidWcoXCJbVFJBTlNGT1JNXTogVE9PTF9DQUxMX1NUQVJUXCIsSlNPTi5zdHJpbmdpZnkoYykpfWlmKFQuZGVsdGEhPT12b2lkIDApe2xldCBjPXt0eXBlOk0uVE9PTF9DQUxMX0FSR1MsdG9vbENhbGxJZDpuLnRvb2xDYWxsSWQsZGVsdGE6VC5kZWx0YX07QS5wdXNoKGMpLGcmJmNvbnNvbGUuZGVidWcoXCJbVFJBTlNGT1JNXTogVE9PTF9DQUxMX0FSR1NcIixKU09OLnN0cmluZ2lmeShjKSl9cmV0dXJuIEF9bGV0IHA9aS50eXBlO3JldHVybltdfSksaWUoKCk9PntvKCl9KSl9O2ltcG9ydHtBR1VJQ29ubmVjdE5vdEltcGxlbWVudGVkRXJyb3IgYXMgdnR9ZnJvbVwiQGFnLXVpL2NvcmVcIjtpbXBvcnR7UmVwbGF5U3ViamVjdCBhcyBsZX1mcm9tXCJyeGpzXCI7aW1wb3J0e2NvbmNhdE1hcCBhcyBnZX1mcm9tXCJyeGpzL29wZXJhdG9yc1wiO3ZhciBYPWNsYXNze3J1bk5leHQoYSxlKXtyZXR1cm4gZS5ydW4oYSkucGlwZShCKCExKSl9cnVuTmV4dFdpdGhTdGF0ZShhLGUpe2xldCBuPXkoYS5tZXNzYWdlc3x8W10pLHQ9eShhLnN0YXRlfHx7fSkscz1uZXcgbGU7cmV0dXJuIHooYSxzLGUsW10pLnN1YnNjcmliZShvPT57by5tZXNzYWdlcyE9PXZvaWQgMCYmKG49by5tZXNzYWdlcyksby5zdGF0ZSE9PXZvaWQgMCYmKHQ9by5zdGF0ZSl9KSx0aGlzLnJ1bk5leHQoYSxlKS5waXBlKGdlKGFzeW5jIG89PihzLm5leHQobyksYXdhaXQgbmV3IFByb21pc2UoaT0+c2V0VGltZW91dChpLDApKSx7ZXZlbnQ6byxtZXNzYWdlczp5KG4pLHN0YXRlOnkodCl9KSkpfX0sSj1jbGFzcyBleHRlbmRzIFh7Y29uc3RydWN0b3IoZSl7c3VwZXIoKTt0aGlzLmZuPWV9cnVuKGUsbil7cmV0dXJuIHRoaXMuZm4oZSxuKX19O2Z1bmN0aW9uIGNlKGcpe2xldCBhPWcuY29udGVudDtpZihBcnJheS5pc0FycmF5KGEpKXtsZXQgZT1hLmZpbHRlcihuPT50eXBlb2Ygbj09XCJvYmplY3RcIiYmbiE9PW51bGwmJlwidHlwZVwiaW4gbiYmbi50eXBlPT09XCJ0ZXh0XCImJnR5cGVvZiBuLnRleHQ9PVwic3RyaW5nXCIpLm1hcChuPT5uLnRleHQpLmpvaW4oXCJcIik7cmV0dXJuIEcoXyh7fSxnKSx7Y29udGVudDplfSl9cmV0dXJuIHR5cGVvZiBhPT1cInN0cmluZ1wiP2c6RyhfKHt9LGcpLHtjb250ZW50OlwiXCJ9KX12YXIgJD1jbGFzcyBleHRlbmRzIFh7cnVuKGEsZSl7bGV0IHI9YSx7cGFyZW50UnVuSWQ6bn09cix0PWl0KHIsW1wicGFyZW50UnVuSWRcIl0pLHM9RyhfKHt9LHQpLHttZXNzYWdlczp0Lm1lc3NhZ2VzLm1hcChjZSl9KTtyZXR1cm4gdGhpcy5ydW5OZXh0KHMsZSl9fTt2YXIgcHQ9e25hbWU6XCJAYWctdWkvY2xpZW50XCIsYXV0aG9yOlwiTWFya3VzIEVja2VyIDxtYXJrdXMuZWNrZXJAZ21haWwuY29tPlwiLHZlcnNpb246XCIwLjAuNDFcIixwcml2YXRlOiExLHB1Ymxpc2hDb25maWc6e2FjY2VzczpcInB1YmxpY1wifSxtYWluOlwiLi9kaXN0L2luZGV4LmpzXCIsbW9kdWxlOlwiLi9kaXN0L2luZGV4Lm1qc1wiLHR5cGVzOlwiLi9kaXN0L2luZGV4LmQudHNcIixzaWRlRWZmZWN0czohMSxmaWxlczpbXCJkaXN0LyoqXCIsXCJSRUFETUUubWRcIl0sc2NyaXB0czp7YnVpbGQ6XCJ0c3VwXCIsZGV2OlwidHN1cCAtLXdhdGNoXCIsY2xlYW46XCJybSAtcmYgZGlzdCAudHVyYm8gbm9kZV9tb2R1bGVzXCIsdHlwZWNoZWNrOlwidHNjIC0tbm9FbWl0XCIsdGVzdDpcImplc3RcIixcImxpbms6Z2xvYmFsXCI6XCJwbnBtIGxpbmsgLS1nbG9iYWxcIixcInVubGluazpnbG9iYWxcIjpcInBucG0gdW5saW5rIC0tZ2xvYmFsXCJ9LGRlcGVuZGVuY2llczp7XCJAYWctdWkvY29yZVwiOlwid29ya3NwYWNlOipcIixcIkBhZy11aS9lbmNvZGVyXCI6XCJ3b3Jrc3BhY2U6KlwiLFwiQGFnLXVpL3Byb3RvXCI6XCJ3b3Jrc3BhY2U6KlwiLFwiQHR5cGVzL3V1aWRcIjpcIl4xMC4wLjBcIixcImNvbXBhcmUtdmVyc2lvbnNcIjpcIl42LjEuMVwiLFwiZmFzdC1qc29uLXBhdGNoXCI6XCJeMy4xLjFcIixyeGpzOlwiNy44LjFcIixcInVudHJ1bmNhdGUtanNvblwiOlwiXjAuMC4xXCIsdXVpZDpcIl4xMS4xLjBcIix6b2Q6XCJeMy4yMi40XCJ9LGRldkRlcGVuZGVuY2llczp7XCJAdHlwZXMvamVzdFwiOlwiXjI5LjUuMTRcIixcIkB0eXBlcy9ub2RlXCI6XCJeMjAuMTEuMTlcIixqZXN0OlwiXjI5LjcuMFwiLFwidHMtamVzdFwiOlwiXjI5LjEuMlwiLHRzdXA6XCJeOC4wLjJcIix0eXBlc2NyaXB0OlwiXjUuMy4zXCJ9fTt2YXIgVz1jbGFzc3tjb25zdHJ1Y3Rvcih7YWdlbnRJZDphLGRlc2NyaXB0aW9uOmUsdGhyZWFkSWQ6bixpbml0aWFsTWVzc2FnZXM6dCxpbml0aWFsU3RhdGU6cyxkZWJ1ZzpyfT17fSl7dGhpcy5kZWJ1Zz0hMTt0aGlzLnN1YnNjcmliZXJzPVtdO3RoaXMuaXNSdW5uaW5nPSExO3RoaXMubWlkZGxld2FyZXM9W107dGhpcy5hZ2VudElkPWEsdGhpcy5kZXNjcmlwdGlvbj1lIT1udWxsP2U6XCJcIix0aGlzLnRocmVhZElkPW4hPW51bGw/bjpWKCksdGhpcy5tZXNzYWdlcz15KHQhPW51bGw/dDpbXSksdGhpcy5zdGF0ZT15KHMhPW51bGw/czp7fSksdGhpcy5kZWJ1Zz1yIT1udWxsP3I6ITEsRWUodGhpcy5tYXhWZXJzaW9uLFwiMC4wLjM5XCIpPD0wJiZ0aGlzLm1pZGRsZXdhcmVzLnVuc2hpZnQobmV3ICQpfWdldCBtYXhWZXJzaW9uKCl7cmV0dXJuIHB0LnZlcnNpb259c3Vic2NyaWJlKGEpe3JldHVybiB0aGlzLnN1YnNjcmliZXJzLnB1c2goYSkse3Vuc3Vic2NyaWJlOigpPT57dGhpcy5zdWJzY3JpYmVycz10aGlzLnN1YnNjcmliZXJzLmZpbHRlcihlPT5lIT09YSl9fX11c2UoLi4uYSl7bGV0IGU9YS5tYXAobj0+dHlwZW9mIG49PVwiZnVuY3Rpb25cIj9uZXcgSihuKTpuKTtyZXR1cm4gdGhpcy5taWRkbGV3YXJlcy5wdXNoKC4uLmUpLHRoaXN9YXN5bmMgcnVuQWdlbnQoYSxlKXt2YXIgbjt0cnl7dGhpcy5pc1J1bm5pbmc9ITAsdGhpcy5hZ2VudElkPShuPXRoaXMuYWdlbnRJZCkhPW51bGw/bjpWKCk7bGV0IHQ9dGhpcy5wcmVwYXJlUnVuQWdlbnRJbnB1dChhKSxzLHI9bmV3IFNldCh0aGlzLm1lc3NhZ2VzLm1hcChTPT5TLmlkKSksbz1be29uUnVuRmluaXNoZWRFdmVudDpTPT57cz1TLnJlc3VsdH19LC4uLnRoaXMuc3Vic2NyaWJlcnMsZSE9bnVsbD9lOnt9XTthd2FpdCB0aGlzLm9uSW5pdGlhbGl6ZSh0LG8pO2xldCBpPVR0KCgpPT50aGlzLm1pZGRsZXdhcmVzLmxlbmd0aD09PTA/dGhpcy5ydW4odCk6dGhpcy5taWRkbGV3YXJlcy5yZWR1Y2VSaWdodCgoSCxUKT0+KHtydW46QT0+VC5ydW4oQSxIKX0pLHRoaXMpLnJ1bih0KSxCKHRoaXMuZGVidWcpLEsodGhpcy5kZWJ1ZyksUz0+dGhpcy5hcHBseSh0LFMsbyksUz0+dGhpcy5wcm9jZXNzQXBwbHlFdmVudHModCxTLG8pLGR0KFM9Pih0aGlzLmlzUnVubmluZz0hMSx0aGlzLm9uRXJyb3IodCxTLG8pKSksZnQoKCk9Pnt0aGlzLmlzUnVubmluZz0hMSx0aGlzLm9uRmluYWxpemUodCxvKX0pKTthd2FpdCBBdChpKFN0KG51bGwpKSk7bGV0IHA9eSh0aGlzLm1lc3NhZ2VzKS5maWx0ZXIoUz0+IXIuaGFzKFMuaWQpKTtyZXR1cm57cmVzdWx0OnMsbmV3TWVzc2FnZXM6cH19ZmluYWxseXt0aGlzLmlzUnVubmluZz0hMX19Y29ubmVjdChhKXt0aHJvdyBuZXcgdnR9YXN5bmMgY29ubmVjdEFnZW50KGEsZSl7dmFyIG47dHJ5e3RoaXMuaXNSdW5uaW5nPSEwLHRoaXMuYWdlbnRJZD0obj10aGlzLmFnZW50SWQpIT1udWxsP246VigpO2xldCB0PXRoaXMucHJlcGFyZVJ1bkFnZW50SW5wdXQoYSkscyxyPW5ldyBTZXQodGhpcy5tZXNzYWdlcy5tYXAoUz0+Uy5pZCkpLG89W3tvblJ1bkZpbmlzaGVkRXZlbnQ6Uz0+e3M9Uy5yZXN1bHR9fSwuLi50aGlzLnN1YnNjcmliZXJzLGUhPW51bGw/ZTp7fV07YXdhaXQgdGhpcy5vbkluaXRpYWxpemUodCxvKTtsZXQgaT1UdCgoKT0+dGhpcy5jb25uZWN0KHQpLEIodGhpcy5kZWJ1ZyksSyh0aGlzLmRlYnVnKSxTPT50aGlzLmFwcGx5KHQsUyxvKSxTPT50aGlzLnByb2Nlc3NBcHBseUV2ZW50cyh0LFMsbyksZHQoUz0+KHRoaXMuaXNSdW5uaW5nPSExLFMgaW5zdGFuY2VvZiB2dD9tZTp0aGlzLm9uRXJyb3IodCxTLG8pKSksZnQoKCk9Pnt0aGlzLmlzUnVubmluZz0hMSx0aGlzLm9uRmluYWxpemUodCxvKX0pKTthd2FpdCBBdChpKFN0KG51bGwpKSk7bGV0IHA9eSh0aGlzLm1lc3NhZ2VzKS5maWx0ZXIoUz0+IXIuaGFzKFMuaWQpKTtyZXR1cm57cmVzdWx0OnMsbmV3TWVzc2FnZXM6cH19ZmluYWxseXt0aGlzLmlzUnVubmluZz0hMX19YWJvcnRSdW4oKXt9YXBwbHkoYSxlLG4pe3JldHVybiB6KGEsZSx0aGlzLG4pfXByb2Nlc3NBcHBseUV2ZW50cyhhLGUsbil7cmV0dXJuIGUucGlwZShwZSh0PT57dC5tZXNzYWdlcyYmKHRoaXMubWVzc2FnZXM9dC5tZXNzYWdlcyxuLmZvckVhY2gocz0+e3ZhciByOyhyPXMub25NZXNzYWdlc0NoYW5nZWQpPT1udWxsfHxyLmNhbGwocyx7bWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXMsaW5wdXQ6YX0pfSkpLHQuc3RhdGUmJih0aGlzLnN0YXRlPXQuc3RhdGUsbi5mb3JFYWNoKHM9Pnt2YXIgcjsocj1zLm9uU3RhdGVDaGFuZ2VkKT09bnVsbHx8ci5jYWxsKHMse3N0YXRlOnRoaXMuc3RhdGUsbWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxhZ2VudDp0aGlzLGlucHV0OmF9KX0pKX0pKX1wcmVwYXJlUnVuQWdlbnRJbnB1dChhKXt2YXIgdCxzLHI7bGV0IG49eSh0aGlzLm1lc3NhZ2VzKS5maWx0ZXIobz0+by5yb2xlIT09XCJhY3Rpdml0eVwiKTtyZXR1cm57dGhyZWFkSWQ6dGhpcy50aHJlYWRJZCxydW5JZDooYT09bnVsbD92b2lkIDA6YS5ydW5JZCl8fFYoKSx0b29sczp5KCh0PWE9PW51bGw/dm9pZCAwOmEudG9vbHMpIT1udWxsP3Q6W10pLGNvbnRleHQ6eSgocz1hPT1udWxsP3ZvaWQgMDphLmNvbnRleHQpIT1udWxsP3M6W10pLGZvcndhcmRlZFByb3BzOnkoKHI9YT09bnVsbD92b2lkIDA6YS5mb3J3YXJkZWRQcm9wcykhPW51bGw/cjp7fSksc3RhdGU6eSh0aGlzLnN0YXRlKSxtZXNzYWdlczpufX1hc3luYyBvbkluaXRpYWxpemUoYSxlKXtsZXQgbj1hd2FpdCB4KGUsdGhpcy5tZXNzYWdlcyx0aGlzLnN0YXRlLCh0LHMscik9Pnt2YXIgbztyZXR1cm4obz10Lm9uUnVuSW5pdGlhbGl6ZWQpPT1udWxsP3ZvaWQgMDpvLmNhbGwodCx7bWVzc2FnZXM6cyxzdGF0ZTpyLGFnZW50OnRoaXMsaW5wdXQ6YX0pfSk7KG4ubWVzc2FnZXMhPT12b2lkIDB8fG4uc3RhdGUhPT12b2lkIDApJiYobi5tZXNzYWdlcyYmKHRoaXMubWVzc2FnZXM9bi5tZXNzYWdlcyxhLm1lc3NhZ2VzPW4ubWVzc2FnZXMsZS5mb3JFYWNoKHQ9Pnt2YXIgczsocz10Lm9uTWVzc2FnZXNDaGFuZ2VkKT09bnVsbHx8cy5jYWxsKHQse21lc3NhZ2VzOnRoaXMubWVzc2FnZXMsc3RhdGU6dGhpcy5zdGF0ZSxhZ2VudDp0aGlzLGlucHV0OmF9KX0pKSxuLnN0YXRlJiYodGhpcy5zdGF0ZT1uLnN0YXRlLGEuc3RhdGU9bi5zdGF0ZSxlLmZvckVhY2godD0+e3ZhciBzOyhzPXQub25TdGF0ZUNoYW5nZWQpPT1udWxsfHxzLmNhbGwodCx7c3RhdGU6dGhpcy5zdGF0ZSxtZXNzYWdlczp0aGlzLm1lc3NhZ2VzLGFnZW50OnRoaXMsaW5wdXQ6YX0pfSkpKX1vbkVycm9yKGEsZSxuKXtyZXR1cm4gZGUoeChuLHRoaXMubWVzc2FnZXMsdGhpcy5zdGF0ZSwodCxzLHIpPT57dmFyIG87cmV0dXJuKG89dC5vblJ1bkZhaWxlZCk9PW51bGw/dm9pZCAwOm8uY2FsbCh0LHtlcnJvcjplLG1lc3NhZ2VzOnMsc3RhdGU6cixhZ2VudDp0aGlzLGlucHV0OmF9KX0pKS5waXBlKG10KHQ9PntsZXQgcz10O2lmKChzLm1lc3NhZ2VzIT09dm9pZCAwfHxzLnN0YXRlIT09dm9pZCAwKSYmKHMubWVzc2FnZXMhPT12b2lkIDAmJih0aGlzLm1lc3NhZ2VzPXMubWVzc2FnZXMsbi5mb3JFYWNoKHI9Pnt2YXIgbzsobz1yLm9uTWVzc2FnZXNDaGFuZ2VkKT09bnVsbHx8by5jYWxsKHIse21lc3NhZ2VzOnRoaXMubWVzc2FnZXMsc3RhdGU6dGhpcy5zdGF0ZSxhZ2VudDp0aGlzLGlucHV0OmF9KX0pKSxzLnN0YXRlIT09dm9pZCAwJiYodGhpcy5zdGF0ZT1zLnN0YXRlLG4uZm9yRWFjaChyPT57dmFyIG87KG89ci5vblN0YXRlQ2hhbmdlZCk9PW51bGx8fG8uY2FsbChyLHtzdGF0ZTp0aGlzLnN0YXRlLG1lc3NhZ2VzOnRoaXMubWVzc2FnZXMsYWdlbnQ6dGhpcyxpbnB1dDphfSl9KSkpLHMuc3RvcFByb3BhZ2F0aW9uIT09ITApdGhyb3cgY29uc29sZS5lcnJvcihcIkFnZW50IGV4ZWN1dGlvbiBmYWlsZWQ6XCIsZSksZTtyZXR1cm57fX0pKX1hc3luYyBvbkZpbmFsaXplKGEsZSl7bGV0IG49YXdhaXQgeChlLHRoaXMubWVzc2FnZXMsdGhpcy5zdGF0ZSwodCxzLHIpPT57dmFyIG87cmV0dXJuKG89dC5vblJ1bkZpbmFsaXplZCk9PW51bGw/dm9pZCAwOm8uY2FsbCh0LHttZXNzYWdlczpzLHN0YXRlOnIsYWdlbnQ6dGhpcyxpbnB1dDphfSl9KTsobi5tZXNzYWdlcyE9PXZvaWQgMHx8bi5zdGF0ZSE9PXZvaWQgMCkmJihuLm1lc3NhZ2VzIT09dm9pZCAwJiYodGhpcy5tZXNzYWdlcz1uLm1lc3NhZ2VzLGUuZm9yRWFjaCh0PT57dmFyIHM7KHM9dC5vbk1lc3NhZ2VzQ2hhbmdlZCk9PW51bGx8fHMuY2FsbCh0LHttZXNzYWdlczp0aGlzLm1lc3NhZ2VzLHN0YXRlOnRoaXMuc3RhdGUsYWdlbnQ6dGhpcyxpbnB1dDphfSl9KSksbi5zdGF0ZSE9PXZvaWQgMCYmKHRoaXMuc3RhdGU9bi5zdGF0ZSxlLmZvckVhY2godD0+e3ZhciBzOyhzPXQub25TdGF0ZUNoYW5nZWQpPT1udWxsfHxzLmNhbGwodCx7c3RhdGU6dGhpcy5zdGF0ZSxtZXNzYWdlczp0aGlzLm1lc3NhZ2VzLGFnZW50OnRoaXMsaW5wdXQ6YX0pfSkpKX1jbG9uZSgpe2xldCBhPU9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpKTtyZXR1cm4gYS5hZ2VudElkPXRoaXMuYWdlbnRJZCxhLmRlc2NyaXB0aW9uPXRoaXMuZGVzY3JpcHRpb24sYS50aHJlYWRJZD10aGlzLnRocmVhZElkLGEubWVzc2FnZXM9eSh0aGlzLm1lc3NhZ2VzKSxhLnN0YXRlPXkodGhpcy5zdGF0ZSksYS5kZWJ1Zz10aGlzLmRlYnVnLGEuaXNSdW5uaW5nPXRoaXMuaXNSdW5uaW5nLGEuc3Vic2NyaWJlcnM9Wy4uLnRoaXMuc3Vic2NyaWJlcnNdLGF9YWRkTWVzc2FnZShhKXt0aGlzLm1lc3NhZ2VzLnB1c2goYSksKGFzeW5jKCk9Pnt2YXIgZSxuLHQ7Zm9yKGxldCBzIG9mIHRoaXMuc3Vic2NyaWJlcnMpYXdhaXQoKGU9cy5vbk5ld01lc3NhZ2UpPT1udWxsP3ZvaWQgMDplLmNhbGwocyx7bWVzc2FnZTphLG1lc3NhZ2VzOnRoaXMubWVzc2FnZXMsc3RhdGU6dGhpcy5zdGF0ZSxhZ2VudDp0aGlzfSkpO2lmKGEucm9sZT09PVwiYXNzaXN0YW50XCImJmEudG9vbENhbGxzKWZvcihsZXQgcyBvZiBhLnRvb2xDYWxscylmb3IobGV0IHIgb2YgdGhpcy5zdWJzY3JpYmVycylhd2FpdCgobj1yLm9uTmV3VG9vbENhbGwpPT1udWxsP3ZvaWQgMDpuLmNhbGwocix7dG9vbENhbGw6cyxtZXNzYWdlczp0aGlzLm1lc3NhZ2VzLHN0YXRlOnRoaXMuc3RhdGUsYWdlbnQ6dGhpc30pKTtmb3IobGV0IHMgb2YgdGhpcy5zdWJzY3JpYmVycylhd2FpdCgodD1zLm9uTWVzc2FnZXNDaGFuZ2VkKT09bnVsbD92b2lkIDA6dC5jYWxsKHMse21lc3NhZ2VzOnRoaXMubWVzc2FnZXMsc3RhdGU6dGhpcy5zdGF0ZSxhZ2VudDp0aGlzfSkpfSkoKX1hZGRNZXNzYWdlcyhhKXt0aGlzLm1lc3NhZ2VzLnB1c2goLi4uYSksKGFzeW5jKCk9Pnt2YXIgZSxuLHQ7Zm9yKGxldCBzIG9mIGEpe2ZvcihsZXQgciBvZiB0aGlzLnN1YnNjcmliZXJzKWF3YWl0KChlPXIub25OZXdNZXNzYWdlKT09bnVsbD92b2lkIDA6ZS5jYWxsKHIse21lc3NhZ2U6cyxtZXNzYWdlczp0aGlzLm1lc3NhZ2VzLHN0YXRlOnRoaXMuc3RhdGUsYWdlbnQ6dGhpc30pKTtpZihzLnJvbGU9PT1cImFzc2lzdGFudFwiJiZzLnRvb2xDYWxscylmb3IobGV0IHIgb2Ygcy50b29sQ2FsbHMpZm9yKGxldCBvIG9mIHRoaXMuc3Vic2NyaWJlcnMpYXdhaXQoKG49by5vbk5ld1Rvb2xDYWxsKT09bnVsbD92b2lkIDA6bi5jYWxsKG8se3Rvb2xDYWxsOnIsbWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXN9KSl9Zm9yKGxldCBzIG9mIHRoaXMuc3Vic2NyaWJlcnMpYXdhaXQoKHQ9cy5vbk1lc3NhZ2VzQ2hhbmdlZCk9PW51bGw/dm9pZCAwOnQuY2FsbChzLHttZXNzYWdlczp0aGlzLm1lc3NhZ2VzLHN0YXRlOnRoaXMuc3RhdGUsYWdlbnQ6dGhpc30pKX0pKCl9c2V0TWVzc2FnZXMoYSl7dGhpcy5tZXNzYWdlcz15KGEpLChhc3luYygpPT57dmFyIGU7Zm9yKGxldCBuIG9mIHRoaXMuc3Vic2NyaWJlcnMpYXdhaXQoKGU9bi5vbk1lc3NhZ2VzQ2hhbmdlZCk9PW51bGw/dm9pZCAwOmUuY2FsbChuLHttZXNzYWdlczp0aGlzLm1lc3NhZ2VzLHN0YXRlOnRoaXMuc3RhdGUsYWdlbnQ6dGhpc30pKX0pKCl9c2V0U3RhdGUoYSl7dGhpcy5zdGF0ZT15KGEpLChhc3luYygpPT57dmFyIGU7Zm9yKGxldCBuIG9mIHRoaXMuc3Vic2NyaWJlcnMpYXdhaXQoKGU9bi5vblN0YXRlQ2hhbmdlZCk9PW51bGw/dm9pZCAwOmUuY2FsbChuLHttZXNzYWdlczp0aGlzLm1lc3NhZ2VzLHN0YXRlOnRoaXMuc3RhdGUsYWdlbnQ6dGhpc30pKX0pKCl9bGVnYWN5X3RvX2JlX3JlbW92ZWRfcnVuQWdlbnRCcmlkZ2VkKGEpe3ZhciB0O3RoaXMuYWdlbnRJZD0odD10aGlzLmFnZW50SWQpIT1udWxsP3Q6VigpO2xldCBlPXRoaXMucHJlcGFyZVJ1bkFnZW50SW5wdXQoYSk7cmV0dXJuKHRoaXMubWlkZGxld2FyZXMubGVuZ3RoPT09MD90aGlzLnJ1bihlKTp0aGlzLm1pZGRsZXdhcmVzLnJlZHVjZVJpZ2h0KChyLG8pPT4oe3J1bjppPT5vLnJ1bihpLHIpfSksdGhpcykucnVuKGUpKS5waXBlKEIodGhpcy5kZWJ1ZyksSyh0aGlzLmRlYnVnKSxudCh0aGlzLnRocmVhZElkLGUucnVuSWQsdGhpcy5hZ2VudElkKSxzPT5zLnBpcGUobXQocj0+KHRoaXMuZGVidWcmJmNvbnNvbGUuZGVidWcoXCJbTEVHQUNZXTpcIixKU09OLnN0cmluZ2lmeShyKSkscikpKSl9fTt2YXIgc3Q9Y2xhc3MgZXh0ZW5kcyBXe2NvbnN0cnVjdG9yKGUpe3ZhciBuO3N1cGVyKGUpO3RoaXMuYWJvcnRDb250cm9sbGVyPW5ldyBBYm9ydENvbnRyb2xsZXI7dGhpcy51cmw9ZS51cmwsdGhpcy5oZWFkZXJzPXkoKG49ZS5oZWFkZXJzKSE9bnVsbD9uOnt9KX1yZXF1ZXN0SW5pdChlKXtyZXR1cm57bWV0aG9kOlwiUE9TVFwiLGhlYWRlcnM6RyhfKHt9LHRoaXMuaGVhZGVycykse1wiQ29udGVudC1UeXBlXCI6XCJhcHBsaWNhdGlvbi9qc29uXCIsQWNjZXB0OlwidGV4dC9ldmVudC1zdHJlYW1cIn0pLGJvZHk6SlNPTi5zdHJpbmdpZnkoZSksc2lnbmFsOnRoaXMuYWJvcnRDb250cm9sbGVyLnNpZ25hbH19cnVuQWdlbnQoZSxuKXt2YXIgdDtyZXR1cm4gdGhpcy5hYm9ydENvbnRyb2xsZXI9KHQ9ZT09bnVsbD92b2lkIDA6ZS5hYm9ydENvbnRyb2xsZXIpIT1udWxsP3Q6bmV3IEFib3J0Q29udHJvbGxlcixzdXBlci5ydW5BZ2VudChlLG4pfWFib3J0UnVuKCl7dGhpcy5hYm9ydENvbnRyb2xsZXIuYWJvcnQoKSxzdXBlci5hYm9ydFJ1bigpfXJ1bihlKXtsZXQgbj1RKHRoaXMudXJsLHRoaXMucmVxdWVzdEluaXQoZSkpO3JldHVybiBldChuKX1jbG9uZSgpe3ZhciBzO2xldCBlPXN1cGVyLmNsb25lKCk7ZS51cmw9dGhpcy51cmwsZS5oZWFkZXJzPXkoKHM9dGhpcy5oZWFkZXJzKSE9bnVsbD9zOnt9KTtsZXQgbj1uZXcgQWJvcnRDb250cm9sbGVyLHQ9dGhpcy5hYm9ydENvbnRyb2xsZXIuc2lnbmFsO3JldHVybiB0LmFib3J0ZWQmJm4uYWJvcnQodC5yZWFzb24pLGUuYWJvcnRDb250cm9sbGVyPW4sZX19O2ltcG9ydHtFdmVudFR5cGUgYXMga31mcm9tXCJAYWctdWkvY29yZVwiO2Z1bmN0aW9uIGZlKGcpe2xldCBhPVtdLGU9bmV3IE1hcCxuPW5ldyBNYXA7Zm9yKGxldCB0IG9mIGcpaWYodC50eXBlPT09ay5URVhUX01FU1NBR0VfU1RBUlQpe2xldCBzPXQscj1zLm1lc3NhZ2VJZDtlLmhhcyhyKXx8ZS5zZXQocix7Y29udGVudHM6W10sb3RoZXJFdmVudHM6W119KTtsZXQgbz1lLmdldChyKTtvLnN0YXJ0PXN9ZWxzZSBpZih0LnR5cGU9PT1rLlRFWFRfTUVTU0FHRV9DT05URU5UKXtsZXQgcz10LHI9cy5tZXNzYWdlSWQ7ZS5oYXMocil8fGUuc2V0KHIse2NvbnRlbnRzOltdLG90aGVyRXZlbnRzOltdfSksZS5nZXQocikuY29udGVudHMucHVzaChzKX1lbHNlIGlmKHQudHlwZT09PWsuVEVYVF9NRVNTQUdFX0VORCl7bGV0IHM9dCxyPXMubWVzc2FnZUlkO2UuaGFzKHIpfHxlLnNldChyLHtjb250ZW50czpbXSxvdGhlckV2ZW50czpbXX0pO2xldCBvPWUuZ2V0KHIpO28uZW5kPXMsaHQocixvLGEpLGUuZGVsZXRlKHIpfWVsc2UgaWYodC50eXBlPT09ay5UT09MX0NBTExfU1RBUlQpe2xldCBzPXQscj1zLnRvb2xDYWxsSWQ7bi5oYXMocil8fG4uc2V0KHIse2FyZ3M6W10sb3RoZXJFdmVudHM6W119KTtsZXQgbz1uLmdldChyKTtvLnN0YXJ0PXN9ZWxzZSBpZih0LnR5cGU9PT1rLlRPT0xfQ0FMTF9BUkdTKXtsZXQgcz10LHI9cy50b29sQ2FsbElkO24uaGFzKHIpfHxuLnNldChyLHthcmdzOltdLG90aGVyRXZlbnRzOltdfSksbi5nZXQocikuYXJncy5wdXNoKHMpfWVsc2UgaWYodC50eXBlPT09ay5UT09MX0NBTExfRU5EKXtsZXQgcz10LHI9cy50b29sQ2FsbElkO24uaGFzKHIpfHxuLnNldChyLHthcmdzOltdLG90aGVyRXZlbnRzOltdfSk7bGV0IG89bi5nZXQocik7by5lbmQ9cyx5dChyLG8sYSksbi5kZWxldGUocil9ZWxzZXtsZXQgcz0hMTtmb3IobGV0W3Isb11vZiBlKWlmKG8uc3RhcnQmJiFvLmVuZCl7by5vdGhlckV2ZW50cy5wdXNoKHQpLHM9ITA7YnJlYWt9aWYoIXMpe2ZvcihsZXRbcixvXW9mIG4paWYoby5zdGFydCYmIW8uZW5kKXtvLm90aGVyRXZlbnRzLnB1c2godCkscz0hMDticmVha319c3x8YS5wdXNoKHQpfWZvcihsZXRbdCxzXW9mIGUpaHQodCxzLGEpO2ZvcihsZXRbdCxzXW9mIG4peXQodCxzLGEpO3JldHVybiBhfWZ1bmN0aW9uIGh0KGcsYSxlKXtpZihhLnN0YXJ0JiZlLnB1c2goYS5zdGFydCksYS5jb250ZW50cy5sZW5ndGg+MCl7bGV0IG49YS5jb250ZW50cy5tYXAocz0+cy5kZWx0YSkuam9pbihcIlwiKSx0PXt0eXBlOmsuVEVYVF9NRVNTQUdFX0NPTlRFTlQsbWVzc2FnZUlkOmcsZGVsdGE6bn07ZS5wdXNoKHQpfWEuZW5kJiZlLnB1c2goYS5lbmQpO2ZvcihsZXQgbiBvZiBhLm90aGVyRXZlbnRzKWUucHVzaChuKX1mdW5jdGlvbiB5dChnLGEsZSl7aWYoYS5zdGFydCYmZS5wdXNoKGEuc3RhcnQpLGEuYXJncy5sZW5ndGg+MCl7bGV0IG49YS5hcmdzLm1hcChzPT5zLmRlbHRhKS5qb2luKFwiXCIpLHQ9e3R5cGU6ay5UT09MX0NBTExfQVJHUyx0b29sQ2FsbElkOmcsZGVsdGE6bn07ZS5wdXNoKHQpfWEuZW5kJiZlLnB1c2goYS5lbmQpO2ZvcihsZXQgbiBvZiBhLm90aGVyRXZlbnRzKWUucHVzaChuKX1leHBvcnQqZnJvbVwiQGFnLXVpL2NvcmVcIjtleHBvcnR7VyBhcyBBYnN0cmFjdEFnZW50LHN0IGFzIEh0dHBBZ2VudCxmZSBhcyBjb21wYWN0RXZlbnRzLG50IGFzIGNvbnZlcnRUb0xlZ2FjeUV2ZW50cyx6IGFzIGRlZmF1bHRBcHBseUV2ZW50cyx0dCBhcyBwYXJzZVByb3RvU3RyZWFtLFogYXMgcGFyc2VTU0VTdHJlYW0sdmUgYXMgcmFuZG9tVVVJRCxRIGFzIHJ1bkh0dHBSZXF1ZXN0LHkgYXMgc3RydWN0dXJlZENsb25lXyxCIGFzIHRyYW5zZm9ybUNodW5rcyxldCBhcyB0cmFuc2Zvcm1IdHRwRXZlbnRTdHJlYW0sSyBhcyB2ZXJpZnlFdmVudHN9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/client/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/core/dist/index.mjs":
/*!*************************************************!*\
  !*** ./node_modules/@ag-ui/core/dist/index.mjs ***!
  \*************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AGUIConnectNotImplementedError: () => (/* binding */ AGUIConnectNotImplementedError),\n/* harmony export */   AGUIError: () => (/* binding */ AGUIError),\n/* harmony export */   ActivityDeltaEventSchema: () => (/* binding */ ActivityDeltaEventSchema),\n/* harmony export */   ActivityMessageSchema: () => (/* binding */ ActivityMessageSchema),\n/* harmony export */   ActivitySnapshotEventSchema: () => (/* binding */ ActivitySnapshotEventSchema),\n/* harmony export */   AssistantMessageSchema: () => (/* binding */ AssistantMessageSchema),\n/* harmony export */   BaseEventSchema: () => (/* binding */ BaseEventSchema),\n/* harmony export */   BaseMessageSchema: () => (/* binding */ BaseMessageSchema),\n/* harmony export */   BinaryInputContentSchema: () => (/* binding */ BinaryInputContentSchema),\n/* harmony export */   ContextSchema: () => (/* binding */ ContextSchema),\n/* harmony export */   CustomEventSchema: () => (/* binding */ CustomEventSchema),\n/* harmony export */   DeveloperMessageSchema: () => (/* binding */ DeveloperMessageSchema),\n/* harmony export */   EventSchemas: () => (/* binding */ EventSchemas),\n/* harmony export */   EventType: () => (/* binding */ EventType),\n/* harmony export */   FunctionCallSchema: () => (/* binding */ FunctionCallSchema),\n/* harmony export */   InputContentSchema: () => (/* binding */ InputContentSchema),\n/* harmony export */   MessageSchema: () => (/* binding */ MessageSchema),\n/* harmony export */   MessagesSnapshotEventSchema: () => (/* binding */ MessagesSnapshotEventSchema),\n/* harmony export */   RawEventSchema: () => (/* binding */ RawEventSchema),\n/* harmony export */   RoleSchema: () => (/* binding */ RoleSchema),\n/* harmony export */   RunAgentInputSchema: () => (/* binding */ RunAgentInputSchema),\n/* harmony export */   RunErrorEventSchema: () => (/* binding */ RunErrorEventSchema),\n/* harmony export */   RunFinishedEventSchema: () => (/* binding */ RunFinishedEventSchema),\n/* harmony export */   RunStartedEventSchema: () => (/* binding */ RunStartedEventSchema),\n/* harmony export */   StateDeltaEventSchema: () => (/* binding */ StateDeltaEventSchema),\n/* harmony export */   StateSchema: () => (/* binding */ StateSchema),\n/* harmony export */   StateSnapshotEventSchema: () => (/* binding */ StateSnapshotEventSchema),\n/* harmony export */   StepFinishedEventSchema: () => (/* binding */ StepFinishedEventSchema),\n/* harmony export */   StepStartedEventSchema: () => (/* binding */ StepStartedEventSchema),\n/* harmony export */   SystemMessageSchema: () => (/* binding */ SystemMessageSchema),\n/* harmony export */   TextInputContentSchema: () => (/* binding */ TextInputContentSchema),\n/* harmony export */   TextMessageChunkEventSchema: () => (/* binding */ TextMessageChunkEventSchema),\n/* harmony export */   TextMessageContentEventSchema: () => (/* binding */ TextMessageContentEventSchema),\n/* harmony export */   TextMessageEndEventSchema: () => (/* binding */ TextMessageEndEventSchema),\n/* harmony export */   TextMessageStartEventSchema: () => (/* binding */ TextMessageStartEventSchema),\n/* harmony export */   ThinkingEndEventSchema: () => (/* binding */ ThinkingEndEventSchema),\n/* harmony export */   ThinkingStartEventSchema: () => (/* binding */ ThinkingStartEventSchema),\n/* harmony export */   ThinkingTextMessageContentEventSchema: () => (/* binding */ ThinkingTextMessageContentEventSchema),\n/* harmony export */   ThinkingTextMessageEndEventSchema: () => (/* binding */ ThinkingTextMessageEndEventSchema),\n/* harmony export */   ThinkingTextMessageStartEventSchema: () => (/* binding */ ThinkingTextMessageStartEventSchema),\n/* harmony export */   ToolCallArgsEventSchema: () => (/* binding */ ToolCallArgsEventSchema),\n/* harmony export */   ToolCallChunkEventSchema: () => (/* binding */ ToolCallChunkEventSchema),\n/* harmony export */   ToolCallEndEventSchema: () => (/* binding */ ToolCallEndEventSchema),\n/* harmony export */   ToolCallResultEventSchema: () => (/* binding */ ToolCallResultEventSchema),\n/* harmony export */   ToolCallSchema: () => (/* binding */ ToolCallSchema),\n/* harmony export */   ToolCallStartEventSchema: () => (/* binding */ ToolCallStartEventSchema),\n/* harmony export */   ToolMessageSchema: () => (/* binding */ ToolMessageSchema),\n/* harmony export */   ToolSchema: () => (/* binding */ ToolSchema),\n/* harmony export */   UserMessageSchema: () => (/* binding */ UserMessageSchema)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/ZodError.js\");\n// src/types.ts\n\nvar FunctionCallSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  name: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  arguments: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar ToolCallSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"function\"),\n  function: FunctionCallSchema\n});\nvar BaseMessageSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  name: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar TextInputContentSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"text\"),\n  text: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar BinaryInputContentObjectSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"binary\"),\n  mimeType: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  url: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  data: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  filename: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ensureBinaryPayload = (value, ctx) => {\n  if (!value.id && !value.url && !value.data) {\n    ctx.addIssue({\n      code: zod__WEBPACK_IMPORTED_MODULE_1__.ZodIssueCode.custom,\n      message: \"BinaryInputContent requires at least one of id, url, or data.\",\n      path: [\"id\"]\n    });\n  }\n};\nvar BinaryInputContentSchema = BinaryInputContentObjectSchema.superRefine((value, ctx) => {\n  ensureBinaryPayload(value, ctx);\n});\nvar InputContentBaseSchema = zod__WEBPACK_IMPORTED_MODULE_0__.discriminatedUnion(\"type\", [\n  TextInputContentSchema,\n  BinaryInputContentObjectSchema\n]);\nvar InputContentSchema = InputContentBaseSchema.superRefine((value, ctx) => {\n  if (value.type === \"binary\") {\n    ensureBinaryPayload(value, ctx);\n  }\n});\nvar DeveloperMessageSchema = BaseMessageSchema.extend({\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"developer\"),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar SystemMessageSchema = BaseMessageSchema.extend({\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"system\"),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar AssistantMessageSchema = BaseMessageSchema.extend({\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"assistant\"),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  toolCalls: zod__WEBPACK_IMPORTED_MODULE_0__.array(ToolCallSchema).optional()\n});\nvar UserMessageSchema = BaseMessageSchema.extend({\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"user\"),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.union([zod__WEBPACK_IMPORTED_MODULE_0__.string(), zod__WEBPACK_IMPORTED_MODULE_0__.array(InputContentSchema)])\n});\nvar ToolMessageSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"tool\"),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  error: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ActivityMessageSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"activity\"),\n  activityType: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.record(zod__WEBPACK_IMPORTED_MODULE_0__.any())\n});\nvar MessageSchema = zod__WEBPACK_IMPORTED_MODULE_0__.discriminatedUnion(\"role\", [\n  DeveloperMessageSchema,\n  SystemMessageSchema,\n  AssistantMessageSchema,\n  UserMessageSchema,\n  ToolMessageSchema,\n  ActivityMessageSchema\n]);\nvar RoleSchema = zod__WEBPACK_IMPORTED_MODULE_0__.union([\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"developer\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"system\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"assistant\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"user\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"tool\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"activity\")\n]);\nvar ContextSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  description: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  value: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar ToolSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  name: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  description: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  parameters: zod__WEBPACK_IMPORTED_MODULE_0__.any()\n  // JSON Schema for the tool parameters\n});\nvar RunAgentInputSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  threadId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  runId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  parentRunId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  state: zod__WEBPACK_IMPORTED_MODULE_0__.any(),\n  messages: zod__WEBPACK_IMPORTED_MODULE_0__.array(MessageSchema),\n  tools: zod__WEBPACK_IMPORTED_MODULE_0__.array(ToolSchema),\n  context: zod__WEBPACK_IMPORTED_MODULE_0__.array(ContextSchema),\n  forwardedProps: zod__WEBPACK_IMPORTED_MODULE_0__.any()\n});\nvar StateSchema = zod__WEBPACK_IMPORTED_MODULE_0__.any();\nvar AGUIError = class extends Error {\n  constructor(message) {\n    super(message);\n  }\n};\nvar AGUIConnectNotImplementedError = class extends AGUIError {\n  constructor() {\n    super(\"Connect not implemented. This method is not supported by the current agent.\");\n  }\n};\n\n// src/events.ts\n\nvar TextMessageRoleSchema = zod__WEBPACK_IMPORTED_MODULE_0__.union([\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"developer\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"system\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"assistant\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"user\")\n]);\nvar EventType = /* @__PURE__ */ ((EventType2) => {\n  EventType2[\"TEXT_MESSAGE_START\"] = \"TEXT_MESSAGE_START\";\n  EventType2[\"TEXT_MESSAGE_CONTENT\"] = \"TEXT_MESSAGE_CONTENT\";\n  EventType2[\"TEXT_MESSAGE_END\"] = \"TEXT_MESSAGE_END\";\n  EventType2[\"TEXT_MESSAGE_CHUNK\"] = \"TEXT_MESSAGE_CHUNK\";\n  EventType2[\"THINKING_TEXT_MESSAGE_START\"] = \"THINKING_TEXT_MESSAGE_START\";\n  EventType2[\"THINKING_TEXT_MESSAGE_CONTENT\"] = \"THINKING_TEXT_MESSAGE_CONTENT\";\n  EventType2[\"THINKING_TEXT_MESSAGE_END\"] = \"THINKING_TEXT_MESSAGE_END\";\n  EventType2[\"TOOL_CALL_START\"] = \"TOOL_CALL_START\";\n  EventType2[\"TOOL_CALL_ARGS\"] = \"TOOL_CALL_ARGS\";\n  EventType2[\"TOOL_CALL_END\"] = \"TOOL_CALL_END\";\n  EventType2[\"TOOL_CALL_CHUNK\"] = \"TOOL_CALL_CHUNK\";\n  EventType2[\"TOOL_CALL_RESULT\"] = \"TOOL_CALL_RESULT\";\n  EventType2[\"THINKING_START\"] = \"THINKING_START\";\n  EventType2[\"THINKING_END\"] = \"THINKING_END\";\n  EventType2[\"STATE_SNAPSHOT\"] = \"STATE_SNAPSHOT\";\n  EventType2[\"STATE_DELTA\"] = \"STATE_DELTA\";\n  EventType2[\"MESSAGES_SNAPSHOT\"] = \"MESSAGES_SNAPSHOT\";\n  EventType2[\"ACTIVITY_SNAPSHOT\"] = \"ACTIVITY_SNAPSHOT\";\n  EventType2[\"ACTIVITY_DELTA\"] = \"ACTIVITY_DELTA\";\n  EventType2[\"RAW\"] = \"RAW\";\n  EventType2[\"CUSTOM\"] = \"CUSTOM\";\n  EventType2[\"RUN_STARTED\"] = \"RUN_STARTED\";\n  EventType2[\"RUN_FINISHED\"] = \"RUN_FINISHED\";\n  EventType2[\"RUN_ERROR\"] = \"RUN_ERROR\";\n  EventType2[\"STEP_STARTED\"] = \"STEP_STARTED\";\n  EventType2[\"STEP_FINISHED\"] = \"STEP_FINISHED\";\n  return EventType2;\n})(EventType || {});\nvar BaseEventSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.nativeEnum(EventType),\n  timestamp: zod__WEBPACK_IMPORTED_MODULE_0__.number().optional(),\n  rawEvent: zod__WEBPACK_IMPORTED_MODULE_0__.any().optional()\n});\nvar TextMessageStartEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TEXT_MESSAGE_START\" /* TEXT_MESSAGE_START */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  role: TextMessageRoleSchema.default(\"assistant\")\n});\nvar TextMessageContentEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TEXT_MESSAGE_CONTENT\" /* TEXT_MESSAGE_CONTENT */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.string().refine((s) => s.length > 0, \"Delta must not be an empty string\")\n});\nvar TextMessageEndEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TEXT_MESSAGE_END\" /* TEXT_MESSAGE_END */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar TextMessageChunkEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TEXT_MESSAGE_CHUNK\" /* TEXT_MESSAGE_CHUNK */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  role: TextMessageRoleSchema.optional(),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ThinkingTextMessageStartEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_TEXT_MESSAGE_START\" /* THINKING_TEXT_MESSAGE_START */)\n});\nvar ThinkingTextMessageContentEventSchema = TextMessageContentEventSchema.omit({\n  messageId: true,\n  type: true\n}).extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_TEXT_MESSAGE_CONTENT\" /* THINKING_TEXT_MESSAGE_CONTENT */)\n});\nvar ThinkingTextMessageEndEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_TEXT_MESSAGE_END\" /* THINKING_TEXT_MESSAGE_END */)\n});\nvar ToolCallStartEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_START\" /* TOOL_CALL_START */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  toolCallName: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  parentMessageId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ToolCallArgsEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_ARGS\" /* TOOL_CALL_ARGS */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar ToolCallEndEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_END\" /* TOOL_CALL_END */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar ToolCallResultEventSchema = BaseEventSchema.extend({\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_RESULT\" /* TOOL_CALL_RESULT */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"tool\").optional()\n});\nvar ToolCallChunkEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_CHUNK\" /* TOOL_CALL_CHUNK */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  toolCallName: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  parentMessageId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ThinkingStartEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_START\" /* THINKING_START */),\n  title: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ThinkingEndEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_END\" /* THINKING_END */)\n});\nvar StateSnapshotEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"STATE_SNAPSHOT\" /* STATE_SNAPSHOT */),\n  snapshot: StateSchema\n});\nvar StateDeltaEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"STATE_DELTA\" /* STATE_DELTA */),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.any())\n  // JSON Patch (RFC 6902)\n});\nvar MessagesSnapshotEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"MESSAGES_SNAPSHOT\" /* MESSAGES_SNAPSHOT */),\n  messages: zod__WEBPACK_IMPORTED_MODULE_0__.array(MessageSchema)\n});\nvar ActivitySnapshotEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"ACTIVITY_SNAPSHOT\" /* ACTIVITY_SNAPSHOT */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  activityType: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.record(zod__WEBPACK_IMPORTED_MODULE_0__.any()),\n  replace: zod__WEBPACK_IMPORTED_MODULE_0__.boolean().optional().default(true)\n});\nvar ActivityDeltaEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"ACTIVITY_DELTA\" /* ACTIVITY_DELTA */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  activityType: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  patch: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.any())\n});\nvar RawEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"RAW\" /* RAW */),\n  event: zod__WEBPACK_IMPORTED_MODULE_0__.any(),\n  source: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar CustomEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"CUSTOM\" /* CUSTOM */),\n  name: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  value: zod__WEBPACK_IMPORTED_MODULE_0__.any()\n});\nvar RunStartedEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"RUN_STARTED\" /* RUN_STARTED */),\n  threadId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  runId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  parentRunId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  input: RunAgentInputSchema.optional()\n});\nvar RunFinishedEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"RUN_FINISHED\" /* RUN_FINISHED */),\n  threadId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  runId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  result: zod__WEBPACK_IMPORTED_MODULE_0__.any().optional()\n});\nvar RunErrorEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"RUN_ERROR\" /* RUN_ERROR */),\n  message: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  code: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar StepStartedEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"STEP_STARTED\" /* STEP_STARTED */),\n  stepName: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar StepFinishedEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"STEP_FINISHED\" /* STEP_FINISHED */),\n  stepName: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar EventSchemas = zod__WEBPACK_IMPORTED_MODULE_0__.discriminatedUnion(\"type\", [\n  TextMessageStartEventSchema,\n  TextMessageContentEventSchema,\n  TextMessageEndEventSchema,\n  TextMessageChunkEventSchema,\n  ThinkingStartEventSchema,\n  ThinkingEndEventSchema,\n  ThinkingTextMessageStartEventSchema,\n  ThinkingTextMessageContentEventSchema,\n  ThinkingTextMessageEndEventSchema,\n  ToolCallStartEventSchema,\n  ToolCallArgsEventSchema,\n  ToolCallEndEventSchema,\n  ToolCallChunkEventSchema,\n  ToolCallResultEventSchema,\n  StateSnapshotEventSchema,\n  StateDeltaEventSchema,\n  MessagesSnapshotEventSchema,\n  ActivitySnapshotEventSchema,\n  ActivityDeltaEventSchema,\n  RawEventSchema,\n  CustomEventSchema,\n  RunStartedEventSchema,\n  RunFinishedEventSchema,\n  RunErrorEventSchema,\n  StepStartedEventSchema,\n  StepFinishedEventSchema\n]);\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2NvcmUvZGlzdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDd0I7QUFDeEIseUJBQXlCLHVDQUFRO0FBQ2pDLFFBQVEsdUNBQVE7QUFDaEIsYUFBYSx1Q0FBUTtBQUNyQixDQUFDO0FBQ0QscUJBQXFCLHVDQUFRO0FBQzdCLE1BQU0sdUNBQVE7QUFDZCxRQUFRLHdDQUFTO0FBQ2pCO0FBQ0EsQ0FBQztBQUNELHdCQUF3Qix1Q0FBUTtBQUNoQyxNQUFNLHVDQUFRO0FBQ2QsUUFBUSx1Q0FBUTtBQUNoQixXQUFXLHVDQUFRO0FBQ25CLFFBQVEsdUNBQVE7QUFDaEIsQ0FBQztBQUNELDZCQUE2Qix1Q0FBUTtBQUNyQyxRQUFRLHdDQUFTO0FBQ2pCLFFBQVEsdUNBQVE7QUFDaEIsQ0FBQztBQUNELHFDQUFxQyx1Q0FBUTtBQUM3QyxRQUFRLHdDQUFTO0FBQ2pCLFlBQVksdUNBQVE7QUFDcEIsTUFBTSx1Q0FBUTtBQUNkLE9BQU8sdUNBQVE7QUFDZixRQUFRLHVDQUFRO0FBQ2hCLFlBQVksdUNBQVE7QUFDcEIsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFlBQVksNkNBQWM7QUFDMUI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCw2QkFBNkIsbURBQW9CO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsUUFBUSx3Q0FBUztBQUNqQixXQUFXLHVDQUFRO0FBQ25CLENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVM7QUFDakIsV0FBVyx1Q0FBUTtBQUNuQixDQUFDO0FBQ0Q7QUFDQSxRQUFRLHdDQUFTO0FBQ2pCLFdBQVcsdUNBQVE7QUFDbkIsYUFBYSxzQ0FBTztBQUNwQixDQUFDO0FBQ0Q7QUFDQSxRQUFRLHdDQUFTO0FBQ2pCLFdBQVcsc0NBQU8sRUFBRSx1Q0FBUSxJQUFJLHNDQUFPO0FBQ3ZDLENBQUM7QUFDRCx3QkFBd0IsdUNBQVE7QUFDaEMsTUFBTSx1Q0FBUTtBQUNkLFdBQVcsdUNBQVE7QUFDbkIsUUFBUSx3Q0FBUztBQUNqQixjQUFjLHVDQUFRO0FBQ3RCLFNBQVMsdUNBQVE7QUFDakIsQ0FBQztBQUNELDRCQUE0Qix1Q0FBUTtBQUNwQyxNQUFNLHVDQUFRO0FBQ2QsUUFBUSx3Q0FBUztBQUNqQixnQkFBZ0IsdUNBQVE7QUFDeEIsV0FBVyx1Q0FBUSxDQUFDLG9DQUFLO0FBQ3pCLENBQUM7QUFDRCxvQkFBb0IsbURBQW9CO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHNDQUFPO0FBQ3hCLEVBQUUsd0NBQVM7QUFDWCxFQUFFLHdDQUFTO0FBQ1gsRUFBRSx3Q0FBUztBQUNYLEVBQUUsd0NBQVM7QUFDWCxFQUFFLHdDQUFTO0FBQ1gsRUFBRSx3Q0FBUztBQUNYO0FBQ0Esb0JBQW9CLHVDQUFRO0FBQzVCLGVBQWUsdUNBQVE7QUFDdkIsU0FBUyx1Q0FBUTtBQUNqQixDQUFDO0FBQ0QsaUJBQWlCLHVDQUFRO0FBQ3pCLFFBQVEsdUNBQVE7QUFDaEIsZUFBZSx1Q0FBUTtBQUN2QixjQUFjLG9DQUFLO0FBQ25CO0FBQ0EsQ0FBQztBQUNELDBCQUEwQix1Q0FBUTtBQUNsQyxZQUFZLHVDQUFRO0FBQ3BCLFNBQVMsdUNBQVE7QUFDakIsZUFBZSx1Q0FBUTtBQUN2QixTQUFTLG9DQUFLO0FBQ2QsWUFBWSxzQ0FBTztBQUNuQixTQUFTLHNDQUFPO0FBQ2hCLFdBQVcsc0NBQU87QUFDbEIsa0JBQWtCLG9DQUFLO0FBQ3ZCLENBQUM7QUFDRCxrQkFBa0Isb0NBQUs7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDOEI7QUFDOUIsNEJBQTRCLHNDQUFRO0FBQ3BDLEVBQUUsd0NBQVU7QUFDWixFQUFFLHdDQUFVO0FBQ1osRUFBRSx3Q0FBVTtBQUNaLEVBQUUsd0NBQVU7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxpQkFBaUI7QUFDbEIsc0JBQXNCLHVDQUFTO0FBQy9CLFFBQVEsMkNBQWE7QUFDckIsYUFBYSx1Q0FBUztBQUN0QixZQUFZLG9DQUFNO0FBQ2xCLENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVU7QUFDbEIsYUFBYSx1Q0FBUztBQUN0QjtBQUNBLENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVU7QUFDbEIsYUFBYSx1Q0FBUztBQUN0QixTQUFTLHVDQUFTO0FBQ2xCLENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVU7QUFDbEIsYUFBYSx1Q0FBUztBQUN0QixDQUFDO0FBQ0Q7QUFDQSxRQUFRLHdDQUFVO0FBQ2xCLGFBQWEsdUNBQVM7QUFDdEI7QUFDQSxTQUFTLHVDQUFTO0FBQ2xCLENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVU7QUFDbEIsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxRQUFRLHdDQUFVO0FBQ2xCLENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVU7QUFDbEIsQ0FBQztBQUNEO0FBQ0EsUUFBUSx3Q0FBVTtBQUNsQixjQUFjLHVDQUFTO0FBQ3ZCLGdCQUFnQix1Q0FBUztBQUN6QixtQkFBbUIsdUNBQVM7QUFDNUIsQ0FBQztBQUNEO0FBQ0EsUUFBUSx3Q0FBVTtBQUNsQixjQUFjLHVDQUFTO0FBQ3ZCLFNBQVMsdUNBQVM7QUFDbEIsQ0FBQztBQUNEO0FBQ0EsUUFBUSx3Q0FBVTtBQUNsQixjQUFjLHVDQUFTO0FBQ3ZCLENBQUM7QUFDRDtBQUNBLGFBQWEsdUNBQVM7QUFDdEIsUUFBUSx3Q0FBVTtBQUNsQixjQUFjLHVDQUFTO0FBQ3ZCLFdBQVcsdUNBQVM7QUFDcEIsUUFBUSx3Q0FBVTtBQUNsQixDQUFDO0FBQ0Q7QUFDQSxRQUFRLHdDQUFVO0FBQ2xCLGNBQWMsdUNBQVM7QUFDdkIsZ0JBQWdCLHVDQUFTO0FBQ3pCLG1CQUFtQix1Q0FBUztBQUM1QixTQUFTLHVDQUFTO0FBQ2xCLENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVU7QUFDbEIsU0FBUyx1Q0FBUztBQUNsQixDQUFDO0FBQ0Q7QUFDQSxRQUFRLHdDQUFVO0FBQ2xCLENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVU7QUFDbEI7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxRQUFRLHdDQUFVO0FBQ2xCLFNBQVMsc0NBQVEsQ0FBQyxvQ0FBTTtBQUN4QjtBQUNBLENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVU7QUFDbEIsWUFBWSxzQ0FBUTtBQUNwQixDQUFDO0FBQ0Q7QUFDQSxRQUFRLHdDQUFVO0FBQ2xCLGFBQWEsdUNBQVM7QUFDdEIsZ0JBQWdCLHVDQUFTO0FBQ3pCLFdBQVcsdUNBQVMsQ0FBQyxvQ0FBTTtBQUMzQixXQUFXLHdDQUFVO0FBQ3JCLENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVU7QUFDbEIsYUFBYSx1Q0FBUztBQUN0QixnQkFBZ0IsdUNBQVM7QUFDekIsU0FBUyxzQ0FBUSxDQUFDLG9DQUFNO0FBQ3hCLENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVU7QUFDbEIsU0FBUyxvQ0FBTTtBQUNmLFVBQVUsdUNBQVM7QUFDbkIsQ0FBQztBQUNEO0FBQ0EsUUFBUSx3Q0FBVTtBQUNsQixRQUFRLHVDQUFTO0FBQ2pCLFNBQVMsb0NBQU07QUFDZixDQUFDO0FBQ0Q7QUFDQSxRQUFRLHdDQUFVO0FBQ2xCLFlBQVksdUNBQVM7QUFDckIsU0FBUyx1Q0FBUztBQUNsQixlQUFlLHVDQUFTO0FBQ3hCO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsUUFBUSx3Q0FBVTtBQUNsQixZQUFZLHVDQUFTO0FBQ3JCLFNBQVMsdUNBQVM7QUFDbEIsVUFBVSxvQ0FBTTtBQUNoQixDQUFDO0FBQ0Q7QUFDQSxRQUFRLHdDQUFVO0FBQ2xCLFdBQVcsdUNBQVM7QUFDcEIsUUFBUSx1Q0FBUztBQUNqQixDQUFDO0FBQ0Q7QUFDQSxRQUFRLHdDQUFVO0FBQ2xCLFlBQVksdUNBQVM7QUFDckIsQ0FBQztBQUNEO0FBQ0EsUUFBUSx3Q0FBVTtBQUNsQixZQUFZLHVDQUFTO0FBQ3JCLENBQUM7QUFDRCxtQkFBbUIsbURBQXFCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW1ERTtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvc2FjaGluL3Byb2plY3RzL2ZpbmFuY2UtYXBwL2Zyb250ZW5kL25vZGVfbW9kdWxlcy9AYWctdWkvY29yZS9kaXN0L2luZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvdHlwZXMudHNcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kXCI7XG52YXIgRnVuY3Rpb25DYWxsU2NoZW1hID0gei5vYmplY3Qoe1xuICBuYW1lOiB6LnN0cmluZygpLFxuICBhcmd1bWVudHM6IHouc3RyaW5nKClcbn0pO1xudmFyIFRvb2xDYWxsU2NoZW1hID0gei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKSxcbiAgdHlwZTogei5saXRlcmFsKFwiZnVuY3Rpb25cIiksXG4gIGZ1bmN0aW9uOiBGdW5jdGlvbkNhbGxTY2hlbWFcbn0pO1xudmFyIEJhc2VNZXNzYWdlU2NoZW1hID0gei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKSxcbiAgcm9sZTogei5zdHJpbmcoKSxcbiAgY29udGVudDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBuYW1lOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbn0pO1xudmFyIFRleHRJbnB1dENvbnRlbnRTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHR5cGU6IHoubGl0ZXJhbChcInRleHRcIiksXG4gIHRleHQ6IHouc3RyaW5nKClcbn0pO1xudmFyIEJpbmFyeUlucHV0Q29udGVudE9iamVjdFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgdHlwZTogei5saXRlcmFsKFwiYmluYXJ5XCIpLFxuICBtaW1lVHlwZTogei5zdHJpbmcoKSxcbiAgaWQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgdXJsOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIGRhdGE6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgZmlsZW5hbWU6IHouc3RyaW5nKCkub3B0aW9uYWwoKVxufSk7XG52YXIgZW5zdXJlQmluYXJ5UGF5bG9hZCA9ICh2YWx1ZSwgY3R4KSA9PiB7XG4gIGlmICghdmFsdWUuaWQgJiYgIXZhbHVlLnVybCAmJiAhdmFsdWUuZGF0YSkge1xuICAgIGN0eC5hZGRJc3N1ZSh7XG4gICAgICBjb2RlOiB6LlpvZElzc3VlQ29kZS5jdXN0b20sXG4gICAgICBtZXNzYWdlOiBcIkJpbmFyeUlucHV0Q29udGVudCByZXF1aXJlcyBhdCBsZWFzdCBvbmUgb2YgaWQsIHVybCwgb3IgZGF0YS5cIixcbiAgICAgIHBhdGg6IFtcImlkXCJdXG4gICAgfSk7XG4gIH1cbn07XG52YXIgQmluYXJ5SW5wdXRDb250ZW50U2NoZW1hID0gQmluYXJ5SW5wdXRDb250ZW50T2JqZWN0U2NoZW1hLnN1cGVyUmVmaW5lKCh2YWx1ZSwgY3R4KSA9PiB7XG4gIGVuc3VyZUJpbmFyeVBheWxvYWQodmFsdWUsIGN0eCk7XG59KTtcbnZhciBJbnB1dENvbnRlbnRCYXNlU2NoZW1hID0gei5kaXNjcmltaW5hdGVkVW5pb24oXCJ0eXBlXCIsIFtcbiAgVGV4dElucHV0Q29udGVudFNjaGVtYSxcbiAgQmluYXJ5SW5wdXRDb250ZW50T2JqZWN0U2NoZW1hXG5dKTtcbnZhciBJbnB1dENvbnRlbnRTY2hlbWEgPSBJbnB1dENvbnRlbnRCYXNlU2NoZW1hLnN1cGVyUmVmaW5lKCh2YWx1ZSwgY3R4KSA9PiB7XG4gIGlmICh2YWx1ZS50eXBlID09PSBcImJpbmFyeVwiKSB7XG4gICAgZW5zdXJlQmluYXJ5UGF5bG9hZCh2YWx1ZSwgY3R4KTtcbiAgfVxufSk7XG52YXIgRGV2ZWxvcGVyTWVzc2FnZVNjaGVtYSA9IEJhc2VNZXNzYWdlU2NoZW1hLmV4dGVuZCh7XG4gIHJvbGU6IHoubGl0ZXJhbChcImRldmVsb3BlclwiKSxcbiAgY29udGVudDogei5zdHJpbmcoKVxufSk7XG52YXIgU3lzdGVtTWVzc2FnZVNjaGVtYSA9IEJhc2VNZXNzYWdlU2NoZW1hLmV4dGVuZCh7XG4gIHJvbGU6IHoubGl0ZXJhbChcInN5c3RlbVwiKSxcbiAgY29udGVudDogei5zdHJpbmcoKVxufSk7XG52YXIgQXNzaXN0YW50TWVzc2FnZVNjaGVtYSA9IEJhc2VNZXNzYWdlU2NoZW1hLmV4dGVuZCh7XG4gIHJvbGU6IHoubGl0ZXJhbChcImFzc2lzdGFudFwiKSxcbiAgY29udGVudDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICB0b29sQ2FsbHM6IHouYXJyYXkoVG9vbENhbGxTY2hlbWEpLm9wdGlvbmFsKClcbn0pO1xudmFyIFVzZXJNZXNzYWdlU2NoZW1hID0gQmFzZU1lc3NhZ2VTY2hlbWEuZXh0ZW5kKHtcbiAgcm9sZTogei5saXRlcmFsKFwidXNlclwiKSxcbiAgY29udGVudDogei51bmlvbihbei5zdHJpbmcoKSwgei5hcnJheShJbnB1dENvbnRlbnRTY2hlbWEpXSlcbn0pO1xudmFyIFRvb2xNZXNzYWdlU2NoZW1hID0gei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKSxcbiAgY29udGVudDogei5zdHJpbmcoKSxcbiAgcm9sZTogei5saXRlcmFsKFwidG9vbFwiKSxcbiAgdG9vbENhbGxJZDogei5zdHJpbmcoKSxcbiAgZXJyb3I6IHouc3RyaW5nKCkub3B0aW9uYWwoKVxufSk7XG52YXIgQWN0aXZpdHlNZXNzYWdlU2NoZW1hID0gei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKSxcbiAgcm9sZTogei5saXRlcmFsKFwiYWN0aXZpdHlcIiksXG4gIGFjdGl2aXR5VHlwZTogei5zdHJpbmcoKSxcbiAgY29udGVudDogei5yZWNvcmQoei5hbnkoKSlcbn0pO1xudmFyIE1lc3NhZ2VTY2hlbWEgPSB6LmRpc2NyaW1pbmF0ZWRVbmlvbihcInJvbGVcIiwgW1xuICBEZXZlbG9wZXJNZXNzYWdlU2NoZW1hLFxuICBTeXN0ZW1NZXNzYWdlU2NoZW1hLFxuICBBc3Npc3RhbnRNZXNzYWdlU2NoZW1hLFxuICBVc2VyTWVzc2FnZVNjaGVtYSxcbiAgVG9vbE1lc3NhZ2VTY2hlbWEsXG4gIEFjdGl2aXR5TWVzc2FnZVNjaGVtYVxuXSk7XG52YXIgUm9sZVNjaGVtYSA9IHoudW5pb24oW1xuICB6LmxpdGVyYWwoXCJkZXZlbG9wZXJcIiksXG4gIHoubGl0ZXJhbChcInN5c3RlbVwiKSxcbiAgei5saXRlcmFsKFwiYXNzaXN0YW50XCIpLFxuICB6LmxpdGVyYWwoXCJ1c2VyXCIpLFxuICB6LmxpdGVyYWwoXCJ0b29sXCIpLFxuICB6LmxpdGVyYWwoXCJhY3Rpdml0eVwiKVxuXSk7XG52YXIgQ29udGV4dFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgZGVzY3JpcHRpb246IHouc3RyaW5nKCksXG4gIHZhbHVlOiB6LnN0cmluZygpXG59KTtcbnZhciBUb29sU2NoZW1hID0gei5vYmplY3Qoe1xuICBuYW1lOiB6LnN0cmluZygpLFxuICBkZXNjcmlwdGlvbjogei5zdHJpbmcoKSxcbiAgcGFyYW1ldGVyczogei5hbnkoKVxuICAvLyBKU09OIFNjaGVtYSBmb3IgdGhlIHRvb2wgcGFyYW1ldGVyc1xufSk7XG52YXIgUnVuQWdlbnRJbnB1dFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgdGhyZWFkSWQ6IHouc3RyaW5nKCksXG4gIHJ1bklkOiB6LnN0cmluZygpLFxuICBwYXJlbnRSdW5JZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBzdGF0ZTogei5hbnkoKSxcbiAgbWVzc2FnZXM6IHouYXJyYXkoTWVzc2FnZVNjaGVtYSksXG4gIHRvb2xzOiB6LmFycmF5KFRvb2xTY2hlbWEpLFxuICBjb250ZXh0OiB6LmFycmF5KENvbnRleHRTY2hlbWEpLFxuICBmb3J3YXJkZWRQcm9wczogei5hbnkoKVxufSk7XG52YXIgU3RhdGVTY2hlbWEgPSB6LmFueSgpO1xudmFyIEFHVUlFcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gIH1cbn07XG52YXIgQUdVSUNvbm5lY3ROb3RJbXBsZW1lbnRlZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBBR1VJRXJyb3Ige1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcihcIkNvbm5lY3Qgbm90IGltcGxlbWVudGVkLiBUaGlzIG1ldGhvZCBpcyBub3Qgc3VwcG9ydGVkIGJ5IHRoZSBjdXJyZW50IGFnZW50LlwiKTtcbiAgfVxufTtcblxuLy8gc3JjL2V2ZW50cy50c1xuaW1wb3J0IHsgeiBhcyB6MiB9IGZyb20gXCJ6b2RcIjtcbnZhciBUZXh0TWVzc2FnZVJvbGVTY2hlbWEgPSB6Mi51bmlvbihbXG4gIHoyLmxpdGVyYWwoXCJkZXZlbG9wZXJcIiksXG4gIHoyLmxpdGVyYWwoXCJzeXN0ZW1cIiksXG4gIHoyLmxpdGVyYWwoXCJhc3Npc3RhbnRcIiksXG4gIHoyLmxpdGVyYWwoXCJ1c2VyXCIpXG5dKTtcbnZhciBFdmVudFR5cGUgPSAvKiBAX19QVVJFX18gKi8gKChFdmVudFR5cGUyKSA9PiB7XG4gIEV2ZW50VHlwZTJbXCJURVhUX01FU1NBR0VfU1RBUlRcIl0gPSBcIlRFWFRfTUVTU0FHRV9TVEFSVFwiO1xuICBFdmVudFR5cGUyW1wiVEVYVF9NRVNTQUdFX0NPTlRFTlRcIl0gPSBcIlRFWFRfTUVTU0FHRV9DT05URU5UXCI7XG4gIEV2ZW50VHlwZTJbXCJURVhUX01FU1NBR0VfRU5EXCJdID0gXCJURVhUX01FU1NBR0VfRU5EXCI7XG4gIEV2ZW50VHlwZTJbXCJURVhUX01FU1NBR0VfQ0hVTktcIl0gPSBcIlRFWFRfTUVTU0FHRV9DSFVOS1wiO1xuICBFdmVudFR5cGUyW1wiVEhJTktJTkdfVEVYVF9NRVNTQUdFX1NUQVJUXCJdID0gXCJUSElOS0lOR19URVhUX01FU1NBR0VfU1RBUlRcIjtcbiAgRXZlbnRUeXBlMltcIlRISU5LSU5HX1RFWFRfTUVTU0FHRV9DT05URU5UXCJdID0gXCJUSElOS0lOR19URVhUX01FU1NBR0VfQ09OVEVOVFwiO1xuICBFdmVudFR5cGUyW1wiVEhJTktJTkdfVEVYVF9NRVNTQUdFX0VORFwiXSA9IFwiVEhJTktJTkdfVEVYVF9NRVNTQUdFX0VORFwiO1xuICBFdmVudFR5cGUyW1wiVE9PTF9DQUxMX1NUQVJUXCJdID0gXCJUT09MX0NBTExfU1RBUlRcIjtcbiAgRXZlbnRUeXBlMltcIlRPT0xfQ0FMTF9BUkdTXCJdID0gXCJUT09MX0NBTExfQVJHU1wiO1xuICBFdmVudFR5cGUyW1wiVE9PTF9DQUxMX0VORFwiXSA9IFwiVE9PTF9DQUxMX0VORFwiO1xuICBFdmVudFR5cGUyW1wiVE9PTF9DQUxMX0NIVU5LXCJdID0gXCJUT09MX0NBTExfQ0hVTktcIjtcbiAgRXZlbnRUeXBlMltcIlRPT0xfQ0FMTF9SRVNVTFRcIl0gPSBcIlRPT0xfQ0FMTF9SRVNVTFRcIjtcbiAgRXZlbnRUeXBlMltcIlRISU5LSU5HX1NUQVJUXCJdID0gXCJUSElOS0lOR19TVEFSVFwiO1xuICBFdmVudFR5cGUyW1wiVEhJTktJTkdfRU5EXCJdID0gXCJUSElOS0lOR19FTkRcIjtcbiAgRXZlbnRUeXBlMltcIlNUQVRFX1NOQVBTSE9UXCJdID0gXCJTVEFURV9TTkFQU0hPVFwiO1xuICBFdmVudFR5cGUyW1wiU1RBVEVfREVMVEFcIl0gPSBcIlNUQVRFX0RFTFRBXCI7XG4gIEV2ZW50VHlwZTJbXCJNRVNTQUdFU19TTkFQU0hPVFwiXSA9IFwiTUVTU0FHRVNfU05BUFNIT1RcIjtcbiAgRXZlbnRUeXBlMltcIkFDVElWSVRZX1NOQVBTSE9UXCJdID0gXCJBQ1RJVklUWV9TTkFQU0hPVFwiO1xuICBFdmVudFR5cGUyW1wiQUNUSVZJVFlfREVMVEFcIl0gPSBcIkFDVElWSVRZX0RFTFRBXCI7XG4gIEV2ZW50VHlwZTJbXCJSQVdcIl0gPSBcIlJBV1wiO1xuICBFdmVudFR5cGUyW1wiQ1VTVE9NXCJdID0gXCJDVVNUT01cIjtcbiAgRXZlbnRUeXBlMltcIlJVTl9TVEFSVEVEXCJdID0gXCJSVU5fU1RBUlRFRFwiO1xuICBFdmVudFR5cGUyW1wiUlVOX0ZJTklTSEVEXCJdID0gXCJSVU5fRklOSVNIRURcIjtcbiAgRXZlbnRUeXBlMltcIlJVTl9FUlJPUlwiXSA9IFwiUlVOX0VSUk9SXCI7XG4gIEV2ZW50VHlwZTJbXCJTVEVQX1NUQVJURURcIl0gPSBcIlNURVBfU1RBUlRFRFwiO1xuICBFdmVudFR5cGUyW1wiU1RFUF9GSU5JU0hFRFwiXSA9IFwiU1RFUF9GSU5JU0hFRFwiO1xuICByZXR1cm4gRXZlbnRUeXBlMjtcbn0pKEV2ZW50VHlwZSB8fCB7fSk7XG52YXIgQmFzZUV2ZW50U2NoZW1hID0gejIub2JqZWN0KHtcbiAgdHlwZTogejIubmF0aXZlRW51bShFdmVudFR5cGUpLFxuICB0aW1lc3RhbXA6IHoyLm51bWJlcigpLm9wdGlvbmFsKCksXG4gIHJhd0V2ZW50OiB6Mi5hbnkoKS5vcHRpb25hbCgpXG59KTtcbnZhciBUZXh0TWVzc2FnZVN0YXJ0RXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlRFWFRfTUVTU0FHRV9TVEFSVFwiIC8qIFRFWFRfTUVTU0FHRV9TVEFSVCAqLyksXG4gIG1lc3NhZ2VJZDogejIuc3RyaW5nKCksXG4gIHJvbGU6IFRleHRNZXNzYWdlUm9sZVNjaGVtYS5kZWZhdWx0KFwiYXNzaXN0YW50XCIpXG59KTtcbnZhciBUZXh0TWVzc2FnZUNvbnRlbnRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiVEVYVF9NRVNTQUdFX0NPTlRFTlRcIiAvKiBURVhUX01FU1NBR0VfQ09OVEVOVCAqLyksXG4gIG1lc3NhZ2VJZDogejIuc3RyaW5nKCksXG4gIGRlbHRhOiB6Mi5zdHJpbmcoKS5yZWZpbmUoKHMpID0+IHMubGVuZ3RoID4gMCwgXCJEZWx0YSBtdXN0IG5vdCBiZSBhbiBlbXB0eSBzdHJpbmdcIilcbn0pO1xudmFyIFRleHRNZXNzYWdlRW5kRXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlRFWFRfTUVTU0FHRV9FTkRcIiAvKiBURVhUX01FU1NBR0VfRU5EICovKSxcbiAgbWVzc2FnZUlkOiB6Mi5zdHJpbmcoKVxufSk7XG52YXIgVGV4dE1lc3NhZ2VDaHVua0V2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJURVhUX01FU1NBR0VfQ0hVTktcIiAvKiBURVhUX01FU1NBR0VfQ0hVTksgKi8pLFxuICBtZXNzYWdlSWQ6IHoyLnN0cmluZygpLm9wdGlvbmFsKCksXG4gIHJvbGU6IFRleHRNZXNzYWdlUm9sZVNjaGVtYS5vcHRpb25hbCgpLFxuICBkZWx0YTogejIuc3RyaW5nKCkub3B0aW9uYWwoKVxufSk7XG52YXIgVGhpbmtpbmdUZXh0TWVzc2FnZVN0YXJ0RXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlRISU5LSU5HX1RFWFRfTUVTU0FHRV9TVEFSVFwiIC8qIFRISU5LSU5HX1RFWFRfTUVTU0FHRV9TVEFSVCAqLylcbn0pO1xudmFyIFRoaW5raW5nVGV4dE1lc3NhZ2VDb250ZW50RXZlbnRTY2hlbWEgPSBUZXh0TWVzc2FnZUNvbnRlbnRFdmVudFNjaGVtYS5vbWl0KHtcbiAgbWVzc2FnZUlkOiB0cnVlLFxuICB0eXBlOiB0cnVlXG59KS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiVEhJTktJTkdfVEVYVF9NRVNTQUdFX0NPTlRFTlRcIiAvKiBUSElOS0lOR19URVhUX01FU1NBR0VfQ09OVEVOVCAqLylcbn0pO1xudmFyIFRoaW5raW5nVGV4dE1lc3NhZ2VFbmRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiVEhJTktJTkdfVEVYVF9NRVNTQUdFX0VORFwiIC8qIFRISU5LSU5HX1RFWFRfTUVTU0FHRV9FTkQgKi8pXG59KTtcbnZhciBUb29sQ2FsbFN0YXJ0RXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlRPT0xfQ0FMTF9TVEFSVFwiIC8qIFRPT0xfQ0FMTF9TVEFSVCAqLyksXG4gIHRvb2xDYWxsSWQ6IHoyLnN0cmluZygpLFxuICB0b29sQ2FsbE5hbWU6IHoyLnN0cmluZygpLFxuICBwYXJlbnRNZXNzYWdlSWQ6IHoyLnN0cmluZygpLm9wdGlvbmFsKClcbn0pO1xudmFyIFRvb2xDYWxsQXJnc0V2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJUT09MX0NBTExfQVJHU1wiIC8qIFRPT0xfQ0FMTF9BUkdTICovKSxcbiAgdG9vbENhbGxJZDogejIuc3RyaW5nKCksXG4gIGRlbHRhOiB6Mi5zdHJpbmcoKVxufSk7XG52YXIgVG9vbENhbGxFbmRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiVE9PTF9DQUxMX0VORFwiIC8qIFRPT0xfQ0FMTF9FTkQgKi8pLFxuICB0b29sQ2FsbElkOiB6Mi5zdHJpbmcoKVxufSk7XG52YXIgVG9vbENhbGxSZXN1bHRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICBtZXNzYWdlSWQ6IHoyLnN0cmluZygpLFxuICB0eXBlOiB6Mi5saXRlcmFsKFwiVE9PTF9DQUxMX1JFU1VMVFwiIC8qIFRPT0xfQ0FMTF9SRVNVTFQgKi8pLFxuICB0b29sQ2FsbElkOiB6Mi5zdHJpbmcoKSxcbiAgY29udGVudDogejIuc3RyaW5nKCksXG4gIHJvbGU6IHoyLmxpdGVyYWwoXCJ0b29sXCIpLm9wdGlvbmFsKClcbn0pO1xudmFyIFRvb2xDYWxsQ2h1bmtFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiVE9PTF9DQUxMX0NIVU5LXCIgLyogVE9PTF9DQUxMX0NIVU5LICovKSxcbiAgdG9vbENhbGxJZDogejIuc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgdG9vbENhbGxOYW1lOiB6Mi5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBwYXJlbnRNZXNzYWdlSWQ6IHoyLnN0cmluZygpLm9wdGlvbmFsKCksXG4gIGRlbHRhOiB6Mi5zdHJpbmcoKS5vcHRpb25hbCgpXG59KTtcbnZhciBUaGlua2luZ1N0YXJ0RXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlRISU5LSU5HX1NUQVJUXCIgLyogVEhJTktJTkdfU1RBUlQgKi8pLFxuICB0aXRsZTogejIuc3RyaW5nKCkub3B0aW9uYWwoKVxufSk7XG52YXIgVGhpbmtpbmdFbmRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiVEhJTktJTkdfRU5EXCIgLyogVEhJTktJTkdfRU5EICovKVxufSk7XG52YXIgU3RhdGVTbmFwc2hvdEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJTVEFURV9TTkFQU0hPVFwiIC8qIFNUQVRFX1NOQVBTSE9UICovKSxcbiAgc25hcHNob3Q6IFN0YXRlU2NoZW1hXG59KTtcbnZhciBTdGF0ZURlbHRhRXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlNUQVRFX0RFTFRBXCIgLyogU1RBVEVfREVMVEEgKi8pLFxuICBkZWx0YTogejIuYXJyYXkoejIuYW55KCkpXG4gIC8vIEpTT04gUGF0Y2ggKFJGQyA2OTAyKVxufSk7XG52YXIgTWVzc2FnZXNTbmFwc2hvdEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJNRVNTQUdFU19TTkFQU0hPVFwiIC8qIE1FU1NBR0VTX1NOQVBTSE9UICovKSxcbiAgbWVzc2FnZXM6IHoyLmFycmF5KE1lc3NhZ2VTY2hlbWEpXG59KTtcbnZhciBBY3Rpdml0eVNuYXBzaG90RXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIkFDVElWSVRZX1NOQVBTSE9UXCIgLyogQUNUSVZJVFlfU05BUFNIT1QgKi8pLFxuICBtZXNzYWdlSWQ6IHoyLnN0cmluZygpLFxuICBhY3Rpdml0eVR5cGU6IHoyLnN0cmluZygpLFxuICBjb250ZW50OiB6Mi5yZWNvcmQoejIuYW55KCkpLFxuICByZXBsYWNlOiB6Mi5ib29sZWFuKCkub3B0aW9uYWwoKS5kZWZhdWx0KHRydWUpXG59KTtcbnZhciBBY3Rpdml0eURlbHRhRXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIkFDVElWSVRZX0RFTFRBXCIgLyogQUNUSVZJVFlfREVMVEEgKi8pLFxuICBtZXNzYWdlSWQ6IHoyLnN0cmluZygpLFxuICBhY3Rpdml0eVR5cGU6IHoyLnN0cmluZygpLFxuICBwYXRjaDogejIuYXJyYXkoejIuYW55KCkpXG59KTtcbnZhciBSYXdFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiUkFXXCIgLyogUkFXICovKSxcbiAgZXZlbnQ6IHoyLmFueSgpLFxuICBzb3VyY2U6IHoyLnN0cmluZygpLm9wdGlvbmFsKClcbn0pO1xudmFyIEN1c3RvbUV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJDVVNUT01cIiAvKiBDVVNUT00gKi8pLFxuICBuYW1lOiB6Mi5zdHJpbmcoKSxcbiAgdmFsdWU6IHoyLmFueSgpXG59KTtcbnZhciBSdW5TdGFydGVkRXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlJVTl9TVEFSVEVEXCIgLyogUlVOX1NUQVJURUQgKi8pLFxuICB0aHJlYWRJZDogejIuc3RyaW5nKCksXG4gIHJ1bklkOiB6Mi5zdHJpbmcoKSxcbiAgcGFyZW50UnVuSWQ6IHoyLnN0cmluZygpLm9wdGlvbmFsKCksXG4gIGlucHV0OiBSdW5BZ2VudElucHV0U2NoZW1hLm9wdGlvbmFsKClcbn0pO1xudmFyIFJ1bkZpbmlzaGVkRXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlJVTl9GSU5JU0hFRFwiIC8qIFJVTl9GSU5JU0hFRCAqLyksXG4gIHRocmVhZElkOiB6Mi5zdHJpbmcoKSxcbiAgcnVuSWQ6IHoyLnN0cmluZygpLFxuICByZXN1bHQ6IHoyLmFueSgpLm9wdGlvbmFsKClcbn0pO1xudmFyIFJ1bkVycm9yRXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlJVTl9FUlJPUlwiIC8qIFJVTl9FUlJPUiAqLyksXG4gIG1lc3NhZ2U6IHoyLnN0cmluZygpLFxuICBjb2RlOiB6Mi5zdHJpbmcoKS5vcHRpb25hbCgpXG59KTtcbnZhciBTdGVwU3RhcnRlZEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJTVEVQX1NUQVJURURcIiAvKiBTVEVQX1NUQVJURUQgKi8pLFxuICBzdGVwTmFtZTogejIuc3RyaW5nKClcbn0pO1xudmFyIFN0ZXBGaW5pc2hlZEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJTVEVQX0ZJTklTSEVEXCIgLyogU1RFUF9GSU5JU0hFRCAqLyksXG4gIHN0ZXBOYW1lOiB6Mi5zdHJpbmcoKVxufSk7XG52YXIgRXZlbnRTY2hlbWFzID0gejIuZGlzY3JpbWluYXRlZFVuaW9uKFwidHlwZVwiLCBbXG4gIFRleHRNZXNzYWdlU3RhcnRFdmVudFNjaGVtYSxcbiAgVGV4dE1lc3NhZ2VDb250ZW50RXZlbnRTY2hlbWEsXG4gIFRleHRNZXNzYWdlRW5kRXZlbnRTY2hlbWEsXG4gIFRleHRNZXNzYWdlQ2h1bmtFdmVudFNjaGVtYSxcbiAgVGhpbmtpbmdTdGFydEV2ZW50U2NoZW1hLFxuICBUaGlua2luZ0VuZEV2ZW50U2NoZW1hLFxuICBUaGlua2luZ1RleHRNZXNzYWdlU3RhcnRFdmVudFNjaGVtYSxcbiAgVGhpbmtpbmdUZXh0TWVzc2FnZUNvbnRlbnRFdmVudFNjaGVtYSxcbiAgVGhpbmtpbmdUZXh0TWVzc2FnZUVuZEV2ZW50U2NoZW1hLFxuICBUb29sQ2FsbFN0YXJ0RXZlbnRTY2hlbWEsXG4gIFRvb2xDYWxsQXJnc0V2ZW50U2NoZW1hLFxuICBUb29sQ2FsbEVuZEV2ZW50U2NoZW1hLFxuICBUb29sQ2FsbENodW5rRXZlbnRTY2hlbWEsXG4gIFRvb2xDYWxsUmVzdWx0RXZlbnRTY2hlbWEsXG4gIFN0YXRlU25hcHNob3RFdmVudFNjaGVtYSxcbiAgU3RhdGVEZWx0YUV2ZW50U2NoZW1hLFxuICBNZXNzYWdlc1NuYXBzaG90RXZlbnRTY2hlbWEsXG4gIEFjdGl2aXR5U25hcHNob3RFdmVudFNjaGVtYSxcbiAgQWN0aXZpdHlEZWx0YUV2ZW50U2NoZW1hLFxuICBSYXdFdmVudFNjaGVtYSxcbiAgQ3VzdG9tRXZlbnRTY2hlbWEsXG4gIFJ1blN0YXJ0ZWRFdmVudFNjaGVtYSxcbiAgUnVuRmluaXNoZWRFdmVudFNjaGVtYSxcbiAgUnVuRXJyb3JFdmVudFNjaGVtYSxcbiAgU3RlcFN0YXJ0ZWRFdmVudFNjaGVtYSxcbiAgU3RlcEZpbmlzaGVkRXZlbnRTY2hlbWFcbl0pO1xuZXhwb3J0IHtcbiAgQUdVSUNvbm5lY3ROb3RJbXBsZW1lbnRlZEVycm9yLFxuICBBR1VJRXJyb3IsXG4gIEFjdGl2aXR5RGVsdGFFdmVudFNjaGVtYSxcbiAgQWN0aXZpdHlNZXNzYWdlU2NoZW1hLFxuICBBY3Rpdml0eVNuYXBzaG90RXZlbnRTY2hlbWEsXG4gIEFzc2lzdGFudE1lc3NhZ2VTY2hlbWEsXG4gIEJhc2VFdmVudFNjaGVtYSxcbiAgQmFzZU1lc3NhZ2VTY2hlbWEsXG4gIEJpbmFyeUlucHV0Q29udGVudFNjaGVtYSxcbiAgQ29udGV4dFNjaGVtYSxcbiAgQ3VzdG9tRXZlbnRTY2hlbWEsXG4gIERldmVsb3Blck1lc3NhZ2VTY2hlbWEsXG4gIEV2ZW50U2NoZW1hcyxcbiAgRXZlbnRUeXBlLFxuICBGdW5jdGlvbkNhbGxTY2hlbWEsXG4gIElucHV0Q29udGVudFNjaGVtYSxcbiAgTWVzc2FnZVNjaGVtYSxcbiAgTWVzc2FnZXNTbmFwc2hvdEV2ZW50U2NoZW1hLFxuICBSYXdFdmVudFNjaGVtYSxcbiAgUm9sZVNjaGVtYSxcbiAgUnVuQWdlbnRJbnB1dFNjaGVtYSxcbiAgUnVuRXJyb3JFdmVudFNjaGVtYSxcbiAgUnVuRmluaXNoZWRFdmVudFNjaGVtYSxcbiAgUnVuU3RhcnRlZEV2ZW50U2NoZW1hLFxuICBTdGF0ZURlbHRhRXZlbnRTY2hlbWEsXG4gIFN0YXRlU2NoZW1hLFxuICBTdGF0ZVNuYXBzaG90RXZlbnRTY2hlbWEsXG4gIFN0ZXBGaW5pc2hlZEV2ZW50U2NoZW1hLFxuICBTdGVwU3RhcnRlZEV2ZW50U2NoZW1hLFxuICBTeXN0ZW1NZXNzYWdlU2NoZW1hLFxuICBUZXh0SW5wdXRDb250ZW50U2NoZW1hLFxuICBUZXh0TWVzc2FnZUNodW5rRXZlbnRTY2hlbWEsXG4gIFRleHRNZXNzYWdlQ29udGVudEV2ZW50U2NoZW1hLFxuICBUZXh0TWVzc2FnZUVuZEV2ZW50U2NoZW1hLFxuICBUZXh0TWVzc2FnZVN0YXJ0RXZlbnRTY2hlbWEsXG4gIFRoaW5raW5nRW5kRXZlbnRTY2hlbWEsXG4gIFRoaW5raW5nU3RhcnRFdmVudFNjaGVtYSxcbiAgVGhpbmtpbmdUZXh0TWVzc2FnZUNvbnRlbnRFdmVudFNjaGVtYSxcbiAgVGhpbmtpbmdUZXh0TWVzc2FnZUVuZEV2ZW50U2NoZW1hLFxuICBUaGlua2luZ1RleHRNZXNzYWdlU3RhcnRFdmVudFNjaGVtYSxcbiAgVG9vbENhbGxBcmdzRXZlbnRTY2hlbWEsXG4gIFRvb2xDYWxsQ2h1bmtFdmVudFNjaGVtYSxcbiAgVG9vbENhbGxFbmRFdmVudFNjaGVtYSxcbiAgVG9vbENhbGxSZXN1bHRFdmVudFNjaGVtYSxcbiAgVG9vbENhbGxTY2hlbWEsXG4gIFRvb2xDYWxsU3RhcnRFdmVudFNjaGVtYSxcbiAgVG9vbE1lc3NhZ2VTY2hlbWEsXG4gIFRvb2xTY2hlbWEsXG4gIFVzZXJNZXNzYWdlU2NoZW1hXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/core/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/langgraph/dist/index.mjs":
/*!******************************************************!*\
  !*** ./node_modules/@ag-ui/langgraph/dist/index.mjs ***!
  \******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CustomEventNames: () => (/* binding */ ut),\n/* harmony export */   LangGraphAgent: () => (/* binding */ rt),\n/* harmony export */   LangGraphEventTypes: () => (/* binding */ ct),\n/* harmony export */   LangGraphHttpAgent: () => (/* binding */ ot)\n/* harmony export */ });\n/* harmony import */ var _ag_ui_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ag-ui/client */ \"(rsc)/./node_modules/@ag-ui/client/dist/index.mjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/cjs/index.js\");\n/* harmony import */ var _langchain_langgraph_sdk__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/langgraph-sdk */ \"(rsc)/./node_modules/@langchain/langgraph-sdk/index.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var _ag_ui_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ag-ui/client */ \"(rsc)/./node_modules/@ag-ui/core/dist/index.mjs\");\nvar ht=Object.defineProperty,dt=Object.defineProperties;var gt=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var z=(a,n)=>(n=Symbol[a])?n:Symbol.for(\"Symbol.\"+a);var Q=(a,n,t)=>n in a?ht(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,m=(a,n)=>{for(var t in n||(n={}))Z.call(n,t)&&Q(a,t,n[t]);if(J)for(var t of J(n))tt.call(n,t)&&Q(a,t,n[t]);return a},v=(a,n)=>dt(a,gt(n));var et=(a,n)=>{var t={};for(var e in a)Z.call(a,e)&&n.indexOf(e)<0&&(t[e]=a[e]);if(a!=null&&J)for(var e of J(a))n.indexOf(e)<0&&tt.call(a,e)&&(t[e]=a[e]);return t};var st=(a,n,t)=>(n=a[z(\"asyncIterator\")])?n.call(a):(a=a[z(\"iterator\")](),n={},t=(e,s)=>(s=a[e])&&(n[e]=r=>new Promise((i,c,g)=>(r=s.call(a,r),g=r.done,Promise.resolve(r.value).then(o=>i({value:o,done:g}),c)))),t(\"next\"),t(\"return\"),n);var ct=(u=>(u.OnChainStart=\"on_chain_start\",u.OnChainStream=\"on_chain_stream\",u.OnChainEnd=\"on_chain_end\",u.OnChatModelStart=\"on_chat_model_start\",u.OnChatModelStream=\"on_chat_model_stream\",u.OnChatModelEnd=\"on_chat_model_end\",u.OnToolStart=\"on_tool_start\",u.OnToolEnd=\"on_tool_end\",u.OnCustomEvent=\"on_custom_event\",u.OnInterrupt=\"on_interrupt\",u))(ct||{}),ut=(s=>(s.ManuallyEmitMessage=\"manually_emit_message\",s.ManuallyEmitToolCall=\"manually_emit_tool_call\",s.ManuallyEmitState=\"manually_emit_state\",s.Exit=\"exit\",s))(ut||{});var j=[\"messages\",\"tools\"];function X(a,n){return Object.fromEntries(Object.entries(a).filter(([t])=>n.includes(t)))}function nt({mode:a,state:n,schemaKeys:t}){let e=a===\"start\"?n:null;return e&&(t!=null&&t.input)&&(e=X(e,[...j,...t.input])),e}function at(a){return a.map(n=>{var t;switch(n.type){case\"human\":return{id:n.id,role:\"user\",content:W(w(n.content))};case\"ai\":let e=w(n.content);return{id:n.id,role:\"assistant\",content:e?W(e):\"\",toolCalls:(t=n.tool_calls)==null?void 0:t.map(s=>({id:s.id,type:\"function\",function:{name:s.name,arguments:JSON.stringify(s.args)}}))};case\"system\":return{id:n.id,role:\"system\",content:W(w(n.content))};case\"tool\":return{id:n.id,role:\"tool\",content:W(w(n.content)),toolCallId:n.tool_call_id};default:throw new Error(\"message type returned from LangGraph is not supported.\")}})}function $(a){return a.map((n,t)=>{var e,s;switch(n.role){case\"user\":return{id:n.id,role:n.role,content:n.content,type:\"human\"};case\"assistant\":return{id:n.id,type:\"ai\",role:n.role,content:(e=n.content)!=null?e:\"\",tool_calls:((s=n.toolCalls)!=null?s:[]).map(r=>({id:r.id,name:r.function.name,args:JSON.parse(r.function.arguments),type:\"tool_call\"}))};case\"system\":return{id:n.id,role:n.role,content:n.content,type:\"system\"};case\"tool\":return{content:n.content,role:n.role,type:n.role,tool_call_id:n.toolCallId,id:n.id};default:throw console.error(`Message role ${n.role} is not implemented`),new Error(\"message role is not supported.\")}})}function W(a){return typeof a==\"string\"?a:JSON.stringify(a)}function it(a){var t,e,s,r,i;let n=(t=a.chunk)==null?void 0:t.content;if(n&&Array.isArray(n)&&n.length&&n[0])return n[0].thinking?{text:n[0].thinking,type:\"text\",index:n[0].index}:null;if((r=(s=(e=a.chunk.additional_kwargs)==null?void 0:e.reasoning)==null?void 0:s.summary)!=null&&r[0]){let c=(i=a.chunk.additional_kwargs)==null?void 0:i.reasoning.summary[0];return!c||!c.text?null:{type:\"text\",text:c.text,index:c.index}}return null}function w(a){var n;if(!a)return null;if(typeof a==\"string\")return a;if(Array.isArray(a)&&a.length){let t=(n=a.find(e=>e.type===\"text\"))==null?void 0:n.text;return t!=null?t:null}return null}var rt=class a extends _ag_ui_client__WEBPACK_IMPORTED_MODULE_2__.AbstractAgent{constructor(t){var e,s;super(t);this.constantSchemaKeys=j;this.config=t,this.messagesInProcess={},this.agentName=t.agentName,this.graphId=t.graphId,this.assistantConfig=t.assistantConfig,this.thinkingProcess=null,this.client=(s=t==null?void 0:t.client)!=null?s:new _langchain_langgraph_sdk__WEBPACK_IMPORTED_MODULE_0__.Client({apiUrl:t.deploymentUrl,apiKey:t.langsmithApiKey,defaultHeaders:m({},(e=t.propertyHeaders)!=null?e:{})})}clone(){return new a(this.config)}dispatchEvent(t){return this.subscriber.next(t),!0}run(t){return new rxjs__WEBPACK_IMPORTED_MODULE_3__.Observable(e=>(this.runAgentStream(t,e),()=>{}))}async runAgentStream(t,e){var c,g,o;this.activeRun={id:t.runId,threadId:t.threadId,hasFunctionStreaming:!1},this.subscriber=e,this.assistant||(this.assistant=await this.getAssistant());let s=(c=t.threadId)!=null?c:(0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)(),r=(o=(g=t.forwardedProps)==null?void 0:g.streamMode)!=null?o:[\"events\",\"values\",\"updates\"],i=await this.prepareStream(v(m({},t),{threadId:s}),r);if(!i)return e.error(\"No stream to regenerate\");await this.handleStreamEvents(i,s,e,t,Array.isArray(r)?r:[r])}async prepareRegenerateStream(t,e){var o,u,d;let{threadId:s,messageCheckpoint:r}=t,i=await this.getCheckpointByMessage(r.id,s);if(this.assistant||(this.assistant=await this.getAssistant()),!i)return this.subscriber.error(\"No checkpoint found for message\");let c=await this.client.threads.updateState(s,{values:this.langGraphDefaultMergeState(i.values,[],t),checkpointId:i.checkpoint.checkpoint_id,asNode:(u=(o=i.next)==null?void 0:o[0])!=null?u:\"__start__\"}),g=v(m({},(d=t.forwardedProps)!=null?d:{}),{input:this.langGraphDefaultMergeState(i.values,[r],t),checkpointId:c.checkpoint.checkpoint_id,streamMode:e});return{streamResponse:this.client.runs.stream(s,this.assistant.assistant_id,g),state:i,streamMode:e}}async prepareStream(t,e){var G,b,D,x,P,F,B,K,S,H;let{threadId:s,state:r,messages:i,tools:c,context:g,forwardedProps:o}=t;this.activeRun.manuallyEmittedState=null;let u=o==null?void 0:o.nodeName,d=s!=null?s:(0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)();this.assistant||(this.assistant=await this.getAssistant());let l=await this.getOrCreateThread(d,o==null?void 0:o.threadMetadata);this.activeRun.threadId=l.thread_id;let E=(G=await this.client.threads.getState(l.thread_id))!=null?G:{values:{}},p=(b=E.values.messages)!=null?b:[],N=$(i),M=this.langGraphDefaultMergeState(v(m({},r),{messages:p}),N,t),I=v(m({},E),{values:v(m({},M),{messages:[...p,...(D=M.messages)!=null?D:[]]})}),A=I.values;if(this.activeRun.schemaKeys=await this.getSchemaKeys(),((x=E.values.messages)!=null?x:[]).length>i.filter(f=>f.role!==\"system\").length){let f=null;for(let T=i.length-1;T>=0;T--)if(i[T].role===\"user\"){f=$([i[T]])[0];break}return f?this.prepareRegenerateStream(v(m({},t),{messageCheckpoint:f}),e):this.subscriber.error(\"No user message found in messages to regenerate\")}this.activeRun.graphInfo=await this.client.assistants.getGraph(this.assistant.assistant_id);let R=!((P=o==null?void 0:o.command)!=null&&P.resume)&&d&&this.activeRun.nodeName!=\"__end__\"&&this.activeRun.nodeName?\"continue\":\"start\";if(R===\"continue\"){let f=this.activeRun.graphInfo.edges.find(T=>T.target===this.activeRun.nodeName);await this.client.threads.updateState(d,{values:r,asNode:f==null?void 0:f.source})}let k=nt({mode:R,state:A,schemaKeys:this.activeRun.schemaKeys}),C,O=[this.assistantConfig,o==null?void 0:o.config].filter(Boolean);O.length&&(C=await this.mergeConfigs({configs:O,assistant:this.assistant,schemaKeys:this.activeRun.schemaKeys}));let y=v(m({},o),{streamMode:e,input:k,config:C,context:m(m({},g),(F=C==null?void 0:C.configurable)!=null?F:{})}),_=(S=(K=(B=E.tasks)==null?void 0:B[0])==null?void 0:K.interrupts)!=null?S:[];return _!=null&&_.length&&!((H=o==null?void 0:o.command)!=null&&H.resume)?(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_STARTED,threadId:d,runId:t.runId}),this.handleNodeChange(u),_.forEach(f=>{this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.CUSTOM,name:\"on_interrupt\",value:typeof f.value==\"string\"?f.value:JSON.stringify(f.value),rawEvent:f})}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_FINISHED,threadId:d,runId:t.runId}),this.subscriber.complete()):{streamResponse:this.client.runs.stream(d,this.assistant.assistant_id,y),state:I}}async handleStreamEvents(t,e,s,r,i){var p,N,M,I,O,y,_,G,b,D;let{forwardedProps:c}=r,g=c==null?void 0:c.nodeName;this.subscriber=s;let o=!1;if(!t)return;let{streamResponse:u,state:d}=t;this.activeRun.prevNodeName=null;let l={},E=d;try{this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_STARTED,threadId:e,runId:this.activeRun.id}),this.handleNodeChange(g);try{for(var A=st(u),R,k,C;R=!(k=await A.next()).done;R=!1){let S=k.value;let H=(p=r.forwardedProps)==null?void 0:p.streamSubgraphs,f=H&&(S.event.startsWith(\"events\")||S.event.startsWith(\"values\"));if(!i.includes(S.event)&&!f&&S.event!==\"error\")continue;let T=S;if(S.event===\"error\"){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_ERROR,message:S.data.message,rawEvent:S});break}if(S.event===\"updates\")continue;if(S.event===\"values\"){l=T.data;continue}else if(H&&T.event.startsWith(\"values|\")){l=m(m({},l),T.data);continue}let U=T.data,Y=(N=U.metadata)!=null?N:{},L=Y.langgraph_node,q=U.event;if(this.activeRun.id=Y.run_id,L&&L!==this.activeRun.nodeName&&this.handleNodeChange(L),o=o||q===\"on_custom_event\"&&U.name===\"exit\",this.activeRun.exitingNode=this.activeRun.nodeName===L&&q===\"on_chain_end\",this.activeRun.exitingNode&&(this.activeRun.manuallyEmittedState=null),(M=this.activeRun.graphInfo)!=null&&M.nodes.some(lt=>lt.id===L)&&this.handleNodeChange(L),E.values=(I=this.activeRun.manuallyEmittedState)!=null?I:l,!this.activeRun.nodeName)continue;(JSON.stringify(E)!==JSON.stringify(d)||this.activeRun.prevNodeName!=this.activeRun.nodeName||this.activeRun.exitingNode)&&!this.getMessageInProgress(this.activeRun.id)&&(d=E,this.activeRun.prevNodeName=this.activeRun.nodeName,this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STATE_SNAPSHOT,snapshot:this.getStateSnapshot(d),rawEvent:T})),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RAW,event:U}),this.handleSingleEvent(U)}}catch(k){C=[k]}finally{try{R&&(k=A.return)&&await k.call(A)}finally{if(C)throw C[0]}}d=await this.client.threads.getState(e);let x=d.tasks,P=(y=(O=x==null?void 0:x[0])==null?void 0:O.interrupts)!=null?y:[],F=d.next.length===0,B=(G=(_=d.metadata)==null?void 0:_.writes)!=null?G:{},K=this.activeRun.nodeName;return P!=null&&P.length||(K=F?\"__end__\":(b=d.next[0])!=null?b:Object.keys(B)[0]),P.forEach(S=>{this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.CUSTOM,name:\"on_interrupt\",value:typeof S.value==\"string\"?S.value:JSON.stringify(S.value),rawEvent:S})}),this.handleNodeChange(K),this.handleNodeChange(void 0),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STATE_SNAPSHOT,snapshot:this.getStateSnapshot(d)}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.MESSAGES_SNAPSHOT,messages:at((D=d.values.messages)!=null?D:[])}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_FINISHED,threadId:e,runId:this.activeRun.id}),this.activeRun=void 0,s.complete()}catch(x){return s.error(x)}}handleSingleEvent(t){var e,s,r,i,c,g,o;switch(t.event){case\"on_chat_model_stream\":let u=(e=t.metadata[\"emit-messages\"])!=null?e:!0,d=(s=t.metadata[\"emit-tool-calls\"])!=null?s:!0;if(t.data.chunk.response_metadata.finish_reason)return;let l=this.getMessageInProgress(this.activeRun.id),E=!!(l!=null&&l.id),p=(r=t.data.chunk.tool_call_chunks)==null?void 0:r[0],N=(i=t.metadata.predict_state)==null?void 0:i.some(_=>_.tool===(p==null?void 0:p.name)),M=!E&&(p==null?void 0:p.name),I=E&&(l==null?void 0:l.toolCallId)&&(p==null?void 0:p.args),A=E&&(l==null?void 0:l.toolCallId)&&!p;(A||I||M)&&(this.activeRun.hasFunctionStreaming=!0);let R=it(t.data),k=w(t.data.chunk.content),C=!!(!p&&k),O=E&&!(l!=null&&l.toolCallId)&&!C;if(R){this.handleThinkingEvent(R);break}if(!R&&this.thinkingProcess&&(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_TEXT_MESSAGE_END}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_END}),this.thinkingProcess=null),N&&this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.CUSTOM,name:\"PredictState\",value:t.metadata.predict_state}),A){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_END,toolCallId:l==null?void 0:l.toolCallId,rawEvent:t})&&(this.messagesInProcess[this.activeRun.id]=null);break}if(O){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_END,messageId:l.id,rawEvent:t})&&(this.messagesInProcess[this.activeRun.id]=null);break}if(M&&d){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_START,toolCallId:p.id,toolCallName:p.name,parentMessageId:t.data.chunk.id,rawEvent:t})&&this.setMessageInProgress(this.activeRun.id,{id:t.data.chunk.id,toolCallId:p.id,toolCallName:p.name});break}if(I&&d){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_ARGS,toolCallId:l==null?void 0:l.toolCallId,delta:p.args,rawEvent:t});break}if(C&&u){l||(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_START,role:\"assistant\",messageId:t.data.chunk.id,rawEvent:t}),this.setMessageInProgress(this.activeRun.id,{id:t.data.chunk.id,toolCallId:null,toolCallName:null}),l=this.getMessageInProgress(this.activeRun.id)),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_CONTENT,messageId:l.id,delta:k,rawEvent:t});break}break;case\"on_chat_model_end\":if((c=this.getMessageInProgress(this.activeRun.id))!=null&&c.toolCallId){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_END,toolCallId:this.getMessageInProgress(this.activeRun.id).toolCallId,rawEvent:t})&&(this.messagesInProcess[this.activeRun.id]=null);break}if((g=this.getMessageInProgress(this.activeRun.id))!=null&&g.id){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_END,messageId:this.getMessageInProgress(this.activeRun.id).id,rawEvent:t})&&(this.messagesInProcess[this.activeRun.id]=null);break}break;case\"on_custom_event\":if(t.name===\"manually_emit_message\"){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_START,role:\"assistant\",messageId:t.data.message_id,rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_CONTENT,messageId:t.data.message_id,delta:t.data.message,rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_END,messageId:t.data.message_id,rawEvent:t});break}if(t.name===\"manually_emit_tool_call\"){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_START,toolCallId:t.data.id,toolCallName:t.data.name,parentMessageId:t.data.id,rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_ARGS,toolCallId:t.data.id,delta:t.data.args,rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_END,toolCallId:t.data.id,rawEvent:t});break}t.name===\"manually_emit_state\"&&(this.activeRun.manuallyEmittedState=t.data,this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STATE_SNAPSHOT,snapshot:this.getStateSnapshot({values:this.activeRun.manuallyEmittedState}),rawEvent:t})),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.CUSTOM,name:t.name,value:t.data,rawEvent:t});break;case\"on_tool_end\":let y=(o=t.data)==null?void 0:o.output;this.activeRun.hasFunctionStreaming||(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_START,toolCallId:y.tool_call_id,toolCallName:y.name,parentMessageId:y.id,rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_ARGS,toolCallId:y.tool_call_id,delta:JSON.stringify(t.data.input),rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_END,toolCallId:y.tool_call_id,rawEvent:t})),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_RESULT,toolCallId:y.tool_call_id,content:y==null?void 0:y.content,messageId:(0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)(),role:\"tool\"});break}}handleThinkingEvent(t){var s;if(!t||!t.type||!t.text)return;let e=t.index;(s=this.thinkingProcess)!=null&&s.index&&this.thinkingProcess.index!==e&&(this.thinkingProcess.type&&this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_TEXT_MESSAGE_END}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_END}),this.thinkingProcess=null),this.thinkingProcess||(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_START}),this.thinkingProcess={index:e}),this.thinkingProcess.type!==t.type&&(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_TEXT_MESSAGE_START}),this.thinkingProcess.type=t.type),this.thinkingProcess.type&&this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_TEXT_MESSAGE_CONTENT,delta:t.text})}getStateSnapshot(t){let e=t.values,s=this.activeRun.schemaKeys;return s!=null&&s.output&&(e=X(e,[...this.constantSchemaKeys,...s.output])),e}async getOrCreateThread(t,e){let s;try{try{s=await this.getThread(t)}catch(r){s=await this.createThread({threadId:t,metadata:e})}}catch(r){throw new Error(`Failed to create thread: ${r.message}`)}return s}async getThread(t){return this.client.threads.get(t)}async createThread(t){return this.client.threads.create(t)}async mergeConfigs({configs:t,assistant:e,schemaKeys:s}){return t.reduce((r,i)=>{var l;let c=r.configurable;i.configurable&&(c=s!=null&&s.config?X(i==null?void 0:i.configurable,[...this.constantSchemaKeys,...(l=s==null?void 0:s.config)!=null?l:[]]):i==null?void 0:i.configurable);let g=v(m(m({},r),i),{configurable:c}),o=r.recursion_limit==null&&i.recursion_limit===25,u=JSON.stringify(g)!==JSON.stringify(r),d=o&&JSON.stringify(v(m({},g),{recursion_limit:null}))===JSON.stringify(v(m({},r),{recursion_limit:null}));return u&&!d?m(m({},r),g):r},e.config)}getMessageInProgress(t){return this.messagesInProcess[t]}setMessageInProgress(t,e){this.messagesInProcess=v(m({},this.messagesInProcess),{[t]:m(m({},this.messagesInProcess[t]),e)})}async getAssistant(){let t=await this.client.assistants.search(),e=t.find(s=>s.graph_id===this.graphId);if(!e)throw console.error(`\n      No agent found with graph ID ${this.graphId} found..\n\n      \n      These are the available agents: [${t.map(s=>`${s.graph_id} (ID: ${s.assistant_id})`).join(\", \")}]\n      `),new Error(\"No agent id found\");return e}async getSchemaKeys(){var t,e,s,r;try{let i=await this.client.assistants.getSchemas(this.assistant.assistant_id),c=null,g=[];if(\"context_schema\"in i&&((t=i.context_schema)!=null&&t.properties)&&(g=Object.keys(i.context_schema.properties)),(e=i.config_schema)!=null&&e.properties&&(c=Object.keys(i.config_schema.properties)),!((s=i.input_schema)!=null&&s.properties)||!((r=i.output_schema)!=null&&r.properties))return{config:[],input:null,output:null,context:g};let o=Object.keys(i.input_schema.properties),u=Object.keys(i.output_schema.properties);return{input:o&&o.length?[...o,...this.constantSchemaKeys]:null,output:u&&u.length?[...u,...this.constantSchemaKeys]:null,context:g,config:c}}catch(i){return{config:[],input:this.constantSchemaKeys,output:this.constantSchemaKeys,context:[]}}}langGraphDefaultMergeState(t,e,s){var o,u;e.length>0&&\"role\"in e[0]&&e[0].role===\"system\"&&(e=e.slice(1));let r=t.messages||[],i=new Set(r.map(d=>d.id)),c=e.filter(d=>!i.has(d.id)),g=[...(o=t.tools)!=null?o:[],...(u=s.tools)!=null?u:[]].reduce((d,l)=>{let E=l;return l.type||(E={type:\"function\",name:l.name,function:{name:l.name,description:l.description,parameters:l.parameters}}),d.find(p=>p.name===E.name||p.function.name===E.function.name)?d:[...d,E]},[]);return v(m({},t),{messages:c,tools:g,\"ag-ui\":{tools:g,context:s.context}})}handleNodeChange(t){var e,s;t===\"__end__\"&&(t=void 0),t!==((e=this.activeRun)==null?void 0:e.nodeName)&&((s=this.activeRun)!=null&&s.nodeName&&this.endStep(),t&&this.startStep(t)),this.activeRun.nodeName=t}startStep(t){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STEP_STARTED,stepName:t})}endStep(){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STEP_FINISHED,stepName:this.activeRun.nodeName})}async getCheckpointByMessage(t,e,s){var M,A;let r=s!=null&&s.checkpoint_id?{checkpoint:{checkpoint_id:s.checkpoint_id}}:void 0,c=[...await this.client.threads.getHistory(e,r)].reverse(),g=c.find(R=>{var k;return(k=R.values.messages)==null?void 0:k.some(C=>C.id===t)});if(!g)throw new Error(\"Message not found\");let o=(M=g.values.messages)!=null?M:[],u=o.findIndex(R=>R.id===t);if(o.slice(u+1).length)return this.getCheckpointByMessage(t,e,g.parent_checkpoint);let l=c.indexOf(g),I=g.values,{messages:E}=I,p=et(I,[\"messages\"]),N=(A=c[l-1])!=null?A:v(m({},g),{values:{}});return v(m({},N),{values:m(m({},N.values),p)})}};var ot=class extends _ag_ui_client__WEBPACK_IMPORTED_MODULE_2__.HttpAgent{};\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2xhbmdncmFwaC9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSx3REFBd0Qsd0NBQXdDLG1DQUFtQywrRUFBK0UscURBQXFELDhCQUE4QixrREFBa0QsbUJBQW1CLHFCQUFxQiwyQkFBMkIsaURBQWlELFNBQVMsc0JBQXNCLGVBQWUsU0FBUyx3REFBd0QsMEVBQTBFLFVBQVUsOEVBQThFLDhHQUE4RyxlQUFlLGlDQUFzTSxvV0FBb1csMktBQTJLLEVBQWdFLDJCQUEyQixnQkFBZ0IsMEVBQTBFLGFBQWEsNEJBQTRCLEVBQUUseUJBQXlCLDJEQUEyRCxlQUFlLGlCQUFpQixNQUFNLGVBQWUsbUJBQW1CLDZDQUE2Qyw0QkFBNEIsT0FBTyw4RkFBOEYsa0NBQWtDLDhDQUE4QyxJQUFJLG9CQUFvQiwrQ0FBK0Msa0JBQWtCLHVFQUF1RSxtRkFBbUYsRUFBRSxjQUFjLHFCQUFxQixRQUFRLGVBQWUsa0JBQWtCLG9EQUFvRCx1QkFBdUIsZ0hBQWdILG9GQUFvRixJQUFJLG9CQUFvQixxREFBcUQsa0JBQWtCLDZFQUE2RSw0Q0FBNEMsUUFBUSxrRUFBa0UsRUFBRSxjQUFjLDhDQUE4QyxlQUFlLGNBQWMseUNBQXlDLDZEQUE2RCxnREFBZ0QsTUFBTSxzR0FBc0csd0VBQXdFLHdCQUF3Qix1Q0FBdUMsWUFBWSxjQUFjLE1BQU0sa0JBQWtCLCtCQUErQiwrQkFBK0IseURBQXlELHNCQUFzQixZQUFZLHVCQUF1Qix3REFBRSxDQUFDLGVBQWUsUUFBUSxTQUFTLDBCQUEwQix1Q0FBdUMsd0tBQXdLLDREQUFFLEVBQUUsbUVBQW1FLGlDQUFpQyxFQUFFLEVBQUUsUUFBUSwwQkFBMEIsaUJBQWlCLGtDQUFrQyxPQUFPLFdBQVcsNENBQUUsb0NBQW9DLEdBQUcsMEJBQTBCLFVBQVUsZ0JBQWdCLHVEQUF1RCw4RUFBOEUsNkJBQTZCLGtEQUFDLCtIQUErSCxLQUFLLFdBQVcsS0FBSyxnREFBZ0QsOERB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SyxvREFBQyx5QkFBeUIsRUFBRSxVQUFVLG9CQUFvQixLQUFLLG9EQUFDLGdEQUFnRCxFQUFFLG9DQUFvQyxRQUFRLGdDQUFnQyxZQUFZLCtCQUErQixnRkFBZ0YsTUFBTSw2REFBNkQsRUFBRSwyQ0FBMkMsa0VBQWtFLG1GQUFtRiwrQkFBK0IsV0FBVyxtREFBbUQsS0FBSyxVQUFVLEVBQUUsYUFBYSxLQUFLLGFBQWEsY0FBYyxJQUFJLHFCQUFxQixvREFBRSxHQUEwRztBQUNoN0UiLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWNoaW4vcHJvamVjdHMvZmluYW5jZS1hcHAvZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BhZy11aS9sYW5nZ3JhcGgvZGlzdC9pbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGh0PU9iamVjdC5kZWZpbmVQcm9wZXJ0eSxkdD1PYmplY3QuZGVmaW5lUHJvcGVydGllczt2YXIgZ3Q9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM7dmFyIEo9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sczt2YXIgWj1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LHR0PU9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGU7dmFyIHo9KGEsbik9PihuPVN5bWJvbFthXSk/bjpTeW1ib2wuZm9yKFwiU3ltYm9sLlwiK2EpO3ZhciBRPShhLG4sdCk9Pm4gaW4gYT9odChhLG4se2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwLHZhbHVlOnR9KTphW25dPXQsbT0oYSxuKT0+e2Zvcih2YXIgdCBpbiBufHwobj17fSkpWi5jYWxsKG4sdCkmJlEoYSx0LG5bdF0pO2lmKEopZm9yKHZhciB0IG9mIEoobikpdHQuY2FsbChuLHQpJiZRKGEsdCxuW3RdKTtyZXR1cm4gYX0sdj0oYSxuKT0+ZHQoYSxndChuKSk7dmFyIGV0PShhLG4pPT57dmFyIHQ9e307Zm9yKHZhciBlIGluIGEpWi5jYWxsKGEsZSkmJm4uaW5kZXhPZihlKTwwJiYodFtlXT1hW2VdKTtpZihhIT1udWxsJiZKKWZvcih2YXIgZSBvZiBKKGEpKW4uaW5kZXhPZihlKTwwJiZ0dC5jYWxsKGEsZSkmJih0W2VdPWFbZV0pO3JldHVybiB0fTt2YXIgc3Q9KGEsbix0KT0+KG49YVt6KFwiYXN5bmNJdGVyYXRvclwiKV0pP24uY2FsbChhKTooYT1hW3ooXCJpdGVyYXRvclwiKV0oKSxuPXt9LHQ9KGUscyk9PihzPWFbZV0pJiYobltlXT1yPT5uZXcgUHJvbWlzZSgoaSxjLGcpPT4ocj1zLmNhbGwoYSxyKSxnPXIuZG9uZSxQcm9taXNlLnJlc29sdmUoci52YWx1ZSkudGhlbihvPT5pKHt2YWx1ZTpvLGRvbmU6Z30pLGMpKSkpLHQoXCJuZXh0XCIpLHQoXCJyZXR1cm5cIiksbik7aW1wb3J0e0h0dHBBZ2VudCBhcyBTdH1mcm9tXCJAYWctdWkvY2xpZW50XCI7aW1wb3J0e09ic2VydmFibGUgYXMgcHR9ZnJvbVwicnhqc1wiO2ltcG9ydHtDbGllbnQgYXMgbXR9ZnJvbVwiQGxhbmdjaGFpbi9sYW5nZ3JhcGgtc2RrXCI7aW1wb3J0e3JhbmRvbVVVSUQgYXMgVn1mcm9tXCJjcnlwdG9cIjt2YXIgY3Q9KHU9Pih1Lk9uQ2hhaW5TdGFydD1cIm9uX2NoYWluX3N0YXJ0XCIsdS5PbkNoYWluU3RyZWFtPVwib25fY2hhaW5fc3RyZWFtXCIsdS5PbkNoYWluRW5kPVwib25fY2hhaW5fZW5kXCIsdS5PbkNoYXRNb2RlbFN0YXJ0PVwib25fY2hhdF9tb2RlbF9zdGFydFwiLHUuT25DaGF0TW9kZWxTdHJlYW09XCJvbl9jaGF0X21vZGVsX3N0cmVhbVwiLHUuT25DaGF0TW9kZWxFbmQ9XCJvbl9jaGF0X21vZGVsX2VuZFwiLHUuT25Ub29sU3RhcnQ9XCJvbl90b29sX3N0YXJ0XCIsdS5PblRvb2xFbmQ9XCJvbl90b29sX2VuZFwiLHUuT25DdXN0b21FdmVudD1cIm9uX2N1c3RvbV9ldmVudFwiLHUuT25JbnRlcnJ1cHQ9XCJvbl9pbnRlcnJ1cHRcIix1KSkoY3R8fHt9KSx1dD0ocz0+KHMuTWFudWFsbHlFbWl0TWVzc2FnZT1cIm1hbnVhbGx5X2VtaXRfbWVzc2FnZVwiLHMuTWFudWFsbHlFbWl0VG9vbENhbGw9XCJtYW51YWxseV9lbWl0X3Rvb2xfY2FsbFwiLHMuTWFudWFsbHlFbWl0U3RhdGU9XCJtYW51YWxseV9lbWl0X3N0YXRlXCIscy5FeGl0PVwiZXhpdFwiLHMpKSh1dHx8e30pO2ltcG9ydHtBYnN0cmFjdEFnZW50IGFzIEV0LEV2ZW50VHlwZSBhcyBofWZyb21cIkBhZy11aS9jbGllbnRcIjt2YXIgaj1bXCJtZXNzYWdlc1wiLFwidG9vbHNcIl07ZnVuY3Rpb24gWChhLG4pe3JldHVybiBPYmplY3QuZnJvbUVudHJpZXMoT2JqZWN0LmVudHJpZXMoYSkuZmlsdGVyKChbdF0pPT5uLmluY2x1ZGVzKHQpKSl9ZnVuY3Rpb24gbnQoe21vZGU6YSxzdGF0ZTpuLHNjaGVtYUtleXM6dH0pe2xldCBlPWE9PT1cInN0YXJ0XCI/bjpudWxsO3JldHVybiBlJiYodCE9bnVsbCYmdC5pbnB1dCkmJihlPVgoZSxbLi4uaiwuLi50LmlucHV0XSkpLGV9ZnVuY3Rpb24gYXQoYSl7cmV0dXJuIGEubWFwKG49Pnt2YXIgdDtzd2l0Y2gobi50eXBlKXtjYXNlXCJodW1hblwiOnJldHVybntpZDpuLmlkLHJvbGU6XCJ1c2VyXCIsY29udGVudDpXKHcobi5jb250ZW50KSl9O2Nhc2VcImFpXCI6bGV0IGU9dyhuLmNvbnRlbnQpO3JldHVybntpZDpuLmlkLHJvbGU6XCJhc3Npc3RhbnRcIixjb250ZW50OmU/VyhlKTpcIlwiLHRvb2xDYWxsczoodD1uLnRvb2xfY2FsbHMpPT1udWxsP3ZvaWQgMDp0Lm1hcChzPT4oe2lkOnMuaWQsdHlwZTpcImZ1bmN0aW9uXCIsZnVuY3Rpb246e25hbWU6cy5uYW1lLGFyZ3VtZW50czpKU09OLnN0cmluZ2lmeShzLmFyZ3MpfX0pKX07Y2FzZVwic3lzdGVtXCI6cmV0dXJue2lkOm4uaWQscm9sZTpcInN5c3RlbVwiLGNvbnRlbnQ6Vyh3KG4uY29udGVudCkpfTtjYXNlXCJ0b29sXCI6cmV0dXJue2lkOm4uaWQscm9sZTpcInRvb2xcIixjb250ZW50OlcodyhuLmNvbnRlbnQpKSx0b29sQ2FsbElkOm4udG9vbF9jYWxsX2lkfTtkZWZhdWx0OnRocm93IG5ldyBFcnJvcihcIm1lc3NhZ2UgdHlwZSByZXR1cm5lZCBmcm9tIExhbmdHcmFwaCBpcyBub3Qgc3VwcG9ydGVkLlwiKX19KX1mdW5jdGlvbiAkKGEpe3JldHVybiBhLm1hcCgobix0KT0+e3ZhciBlLHM7c3dpdGNoKG4ucm9sZSl7Y2FzZVwidXNlclwiOnJldHVybntpZDpuLmlkLHJvbGU6bi5yb2xlLGNvbnRlbnQ6bi5jb250ZW50LHR5cGU6XCJodW1hblwifTtjYXNlXCJhc3Npc3RhbnRcIjpyZXR1cm57aWQ6bi5pZCx0eXBlOlwiYWlcIixyb2xlOm4ucm9sZSxjb250ZW50OihlPW4uY29udGVudCkhPW51bGw/ZTpcIlwiLHRvb2xfY2FsbHM6KChzPW4udG9vbENhbGxzKSE9bnVsbD9zOltdKS5tYXAocj0+KHtpZDpyLmlkLG5hbWU6ci5mdW5jdGlvbi5uYW1lLGFyZ3M6SlNPTi5wYXJzZShyLmZ1bmN0aW9uLmFyZ3VtZW50cyksdHlwZTpcInRvb2xfY2FsbFwifSkpfTtjYXNlXCJzeXN0ZW1cIjpyZXR1cm57aWQ6bi5pZCxyb2xlOm4ucm9sZSxjb250ZW50Om4uY29udGVudCx0eXBlOlwic3lzdGVtXCJ9O2Nhc2VcInRvb2xcIjpyZXR1cm57Y29udGVudDpuLmNvbnRlbnQscm9sZTpuLnJvbGUsdHlwZTpuLnJvbGUsdG9vbF9jYWxsX2lkOm4udG9vbENhbGxJZCxpZDpuLmlkfTtkZWZhdWx0OnRocm93IGNvbnNvbGUuZXJyb3IoYE1lc3NhZ2Ugcm9sZSAke24ucm9sZX0gaXMgbm90IGltcGxlbWVudGVkYCksbmV3IEVycm9yKFwibWVzc2FnZSByb2xlIGlzIG5vdCBzdXBwb3J0ZWQuXCIpfX0pfWZ1bmN0aW9uIFcoYSl7cmV0dXJuIHR5cGVvZiBhPT1cInN0cmluZ1wiP2E6SlNPTi5zdHJpbmdpZnkoYSl9ZnVuY3Rpb24gaXQoYSl7dmFyIHQsZSxzLHIsaTtsZXQgbj0odD1hLmNodW5rKT09bnVsbD92b2lkIDA6dC5jb250ZW50O2lmKG4mJkFycmF5LmlzQXJyYXkobikmJm4ubGVuZ3RoJiZuWzBdKXJldHVybiBuWzBdLnRoaW5raW5nP3t0ZXh0Om5bMF0udGhpbmtpbmcsdHlwZTpcInRleHRcIixpbmRleDpuWzBdLmluZGV4fTpudWxsO2lmKChyPShzPShlPWEuY2h1bmsuYWRkaXRpb25hbF9rd2FyZ3MpPT1udWxsP3ZvaWQgMDplLnJlYXNvbmluZyk9PW51bGw/dm9pZCAwOnMuc3VtbWFyeSkhPW51bGwmJnJbMF0pe2xldCBjPShpPWEuY2h1bmsuYWRkaXRpb25hbF9rd2FyZ3MpPT1udWxsP3ZvaWQgMDppLnJlYXNvbmluZy5zdW1tYXJ5WzBdO3JldHVybiFjfHwhYy50ZXh0P251bGw6e3R5cGU6XCJ0ZXh0XCIsdGV4dDpjLnRleHQsaW5kZXg6Yy5pbmRleH19cmV0dXJuIG51bGx9ZnVuY3Rpb24gdyhhKXt2YXIgbjtpZighYSlyZXR1cm4gbnVsbDtpZih0eXBlb2YgYT09XCJzdHJpbmdcIilyZXR1cm4gYTtpZihBcnJheS5pc0FycmF5KGEpJiZhLmxlbmd0aCl7bGV0IHQ9KG49YS5maW5kKGU9PmUudHlwZT09PVwidGV4dFwiKSk9PW51bGw/dm9pZCAwOm4udGV4dDtyZXR1cm4gdCE9bnVsbD90Om51bGx9cmV0dXJuIG51bGx9dmFyIHJ0PWNsYXNzIGEgZXh0ZW5kcyBFdHtjb25zdHJ1Y3Rvcih0KXt2YXIgZSxzO3N1cGVyKHQpO3RoaXMuY29uc3RhbnRTY2hlbWFLZXlzPWo7dGhpcy5jb25maWc9dCx0aGlzLm1lc3NhZ2VzSW5Qcm9jZXNzPXt9LHRoaXMuYWdlbnROYW1lPXQuYWdlbnROYW1lLHRoaXMuZ3JhcGhJZD10LmdyYXBoSWQsdGhpcy5hc3Npc3RhbnRDb25maWc9dC5hc3Npc3RhbnRDb25maWcsdGhpcy50aGlua2luZ1Byb2Nlc3M9bnVsbCx0aGlzLmNsaWVudD0ocz10PT1udWxsP3ZvaWQgMDp0LmNsaWVudCkhPW51bGw/czpuZXcgbXQoe2FwaVVybDp0LmRlcGxveW1lbnRVcmwsYXBpS2V5OnQubGFuZ3NtaXRoQXBpS2V5LGRlZmF1bHRIZWFkZXJzOm0oe30sKGU9dC5wcm9wZXJ0eUhlYWRlcnMpIT1udWxsP2U6e30pfSl9Y2xvbmUoKXtyZXR1cm4gbmV3IGEodGhpcy5jb25maWcpfWRpc3BhdGNoRXZlbnQodCl7cmV0dXJuIHRoaXMuc3Vic2NyaWJlci5uZXh0KHQpLCEwfXJ1bih0KXtyZXR1cm4gbmV3IHB0KGU9Pih0aGlzLnJ1bkFnZW50U3RyZWFtKHQsZSksKCk9Pnt9KSl9YXN5bmMgcnVuQWdlbnRTdHJlYW0odCxlKXt2YXIgYyxnLG87dGhpcy5hY3RpdmVSdW49e2lkOnQucnVuSWQsdGhyZWFkSWQ6dC50aHJlYWRJZCxoYXNGdW5jdGlvblN0cmVhbWluZzohMX0sdGhpcy5zdWJzY3JpYmVyPWUsdGhpcy5hc3Npc3RhbnR8fCh0aGlzLmFzc2lzdGFudD1hd2FpdCB0aGlzLmdldEFzc2lzdGFudCgpKTtsZXQgcz0oYz10LnRocmVhZElkKSE9bnVsbD9jOlYoKSxyPShvPShnPXQuZm9yd2FyZGVkUHJvcHMpPT1udWxsP3ZvaWQgMDpnLnN0cmVhbU1vZGUpIT1udWxsP286W1wiZXZlbnRzXCIsXCJ2YWx1ZXNcIixcInVwZGF0ZXNcIl0saT1hd2FpdCB0aGlzLnByZXBhcmVTdHJlYW0odihtKHt9LHQpLHt0aHJlYWRJZDpzfSkscik7aWYoIWkpcmV0dXJuIGUuZXJyb3IoXCJObyBzdHJlYW0gdG8gcmVnZW5lcmF0ZVwiKTthd2FpdCB0aGlzLmhhbmRsZVN0cmVhbUV2ZW50cyhpLHMsZSx0LEFycmF5LmlzQXJyYXkocik/cjpbcl0pfWFzeW5jIHByZXBhcmVSZWdlbmVyYXRlU3RyZWFtKHQsZSl7dmFyIG8sdSxkO2xldHt0aHJlYWRJZDpzLG1lc3NhZ2VDaGVja3BvaW50OnJ9PXQsaT1hd2FpdCB0aGlzLmdldENoZWNrcG9pbnRCeU1lc3NhZ2Uoci5pZCxzKTtpZih0aGlzLmFzc2lzdGFudHx8KHRoaXMuYXNzaXN0YW50PWF3YWl0IHRoaXMuZ2V0QXNzaXN0YW50KCkpLCFpKXJldHVybiB0aGlzLnN1YnNjcmliZXIuZXJyb3IoXCJObyBjaGVja3BvaW50IGZvdW5kIGZvciBtZXNzYWdlXCIpO2xldCBjPWF3YWl0IHRoaXMuY2xpZW50LnRocmVhZHMudXBkYXRlU3RhdGUocyx7dmFsdWVzOnRoaXMubGFuZ0dyYXBoRGVmYXVsdE1lcmdlU3RhdGUoaS52YWx1ZXMsW10sdCksY2hlY2twb2ludElkOmkuY2hlY2twb2ludC5jaGVja3BvaW50X2lkLGFzTm9kZToodT0obz1pLm5leHQpPT1udWxsP3ZvaWQgMDpvWzBdKSE9bnVsbD91OlwiX19zdGFydF9fXCJ9KSxnPXYobSh7fSwoZD10LmZvcndhcmRlZFByb3BzKSE9bnVsbD9kOnt9KSx7aW5wdXQ6dGhpcy5sYW5nR3JhcGhEZWZhdWx0TWVyZ2VTdGF0ZShpLnZhbHVlcyxbcl0sdCksY2hlY2twb2ludElkOmMuY2hlY2twb2ludC5jaGVja3BvaW50X2lkLHN0cmVhbU1vZGU6ZX0pO3JldHVybntzdHJlYW1SZXNwb25zZTp0aGlzLmNsaWVudC5ydW5zLnN0cmVhbShzLHRoaXMuYXNzaXN0YW50LmFzc2lzdGFudF9pZCxnKSxzdGF0ZTppLHN0cmVhbU1vZGU6ZX19YXN5bmMgcHJlcGFyZVN0cmVhbSh0LGUpe3ZhciBHLGIsRCx4LFAsRixCLEssUyxIO2xldHt0aHJlYWRJZDpzLHN0YXRlOnIsbWVzc2FnZXM6aSx0b29sczpjLGNvbnRleHQ6Zyxmb3J3YXJkZWRQcm9wczpvfT10O3RoaXMuYWN0aXZlUnVuLm1hbnVhbGx5RW1pdHRlZFN0YXRlPW51bGw7bGV0IHU9bz09bnVsbD92b2lkIDA6by5ub2RlTmFtZSxkPXMhPW51bGw/czpWKCk7dGhpcy5hc3Npc3RhbnR8fCh0aGlzLmFzc2lzdGFudD1hd2FpdCB0aGlzLmdldEFzc2lzdGFudCgpKTtsZXQgbD1hd2FpdCB0aGlzLmdldE9yQ3JlYXRlVGhyZWFkKGQsbz09bnVsbD92b2lkIDA6by50aHJlYWRNZXRhZGF0YSk7dGhpcy5hY3RpdmVSdW4udGhyZWFkSWQ9bC50aHJlYWRfaWQ7bGV0IEU9KEc9YXdhaXQgdGhpcy5jbGllbnQudGhyZWFkcy5nZXRTdGF0ZShsLnRocmVhZF9pZCkpIT1udWxsP0c6e3ZhbHVlczp7fX0scD0oYj1FLnZhbHVlcy5tZXNzYWdlcykhPW51bGw/YjpbXSxOPSQoaSksTT10aGlzLmxhbmdHcmFwaERlZmF1bHRNZXJnZVN0YXRlKHYobSh7fSxyKSx7bWVzc2FnZXM6cH0pLE4sdCksST12KG0oe30sRSkse3ZhbHVlczp2KG0oe30sTSkse21lc3NhZ2VzOlsuLi5wLC4uLihEPU0ubWVzc2FnZXMpIT1udWxsP0Q6W11dfSl9KSxBPUkudmFsdWVzO2lmKHRoaXMuYWN0aXZlUnVuLnNjaGVtYUtleXM9YXdhaXQgdGhpcy5nZXRTY2hlbWFLZXlzKCksKCh4PUUudmFsdWVzLm1lc3NhZ2VzKSE9bnVsbD94OltdKS5sZW5ndGg+aS5maWx0ZXIoZj0+Zi5yb2xlIT09XCJzeXN0ZW1cIikubGVuZ3RoKXtsZXQgZj1udWxsO2ZvcihsZXQgVD1pLmxlbmd0aC0xO1Q+PTA7VC0tKWlmKGlbVF0ucm9sZT09PVwidXNlclwiKXtmPSQoW2lbVF1dKVswXTticmVha31yZXR1cm4gZj90aGlzLnByZXBhcmVSZWdlbmVyYXRlU3RyZWFtKHYobSh7fSx0KSx7bWVzc2FnZUNoZWNrcG9pbnQ6Zn0pLGUpOnRoaXMuc3Vic2NyaWJlci5lcnJvcihcIk5vIHVzZXIgbWVzc2FnZSBmb3VuZCBpbiBtZXNzYWdlcyB0byByZWdlbmVyYXRlXCIpfXRoaXMuYWN0aXZlUnVuLmdyYXBoSW5mbz1hd2FpdCB0aGlzLmNsaWVudC5hc3Npc3RhbnRzLmdldEdyYXBoKHRoaXMuYXNzaXN0YW50LmFzc2lzdGFudF9pZCk7bGV0IFI9ISgoUD1vPT1udWxsP3ZvaWQgMDpvLmNvbW1hbmQpIT1udWxsJiZQLnJlc3VtZSkmJmQmJnRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lIT1cIl9fZW5kX19cIiYmdGhpcy5hY3RpdmVSdW4ubm9kZU5hbWU/XCJjb250aW51ZVwiOlwic3RhcnRcIjtpZihSPT09XCJjb250aW51ZVwiKXtsZXQgZj10aGlzLmFjdGl2ZVJ1bi5ncmFwaEluZm8uZWRnZXMuZmluZChUPT5ULnRhcmdldD09PXRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lKTthd2FpdCB0aGlzLmNsaWVudC50aHJlYWRzLnVwZGF0ZVN0YXRlKGQse3ZhbHVlczpyLGFzTm9kZTpmPT1udWxsP3ZvaWQgMDpmLnNvdXJjZX0pfWxldCBrPW50KHttb2RlOlIsc3RhdGU6QSxzY2hlbWFLZXlzOnRoaXMuYWN0aXZlUnVuLnNjaGVtYUtleXN9KSxDLE89W3RoaXMuYXNzaXN0YW50Q29uZmlnLG89PW51bGw/dm9pZCAwOm8uY29uZmlnXS5maWx0ZXIoQm9vbGVhbik7Ty5sZW5ndGgmJihDPWF3YWl0IHRoaXMubWVyZ2VDb25maWdzKHtjb25maWdzOk8sYXNzaXN0YW50OnRoaXMuYXNzaXN0YW50LHNjaGVtYUtleXM6dGhpcy5hY3RpdmVSdW4uc2NoZW1hS2V5c30pKTtsZXQgeT12KG0oe30sbykse3N0cmVhbU1vZGU6ZSxpbnB1dDprLGNvbmZpZzpDLGNvbnRleHQ6bShtKHt9LGcpLChGPUM9PW51bGw/dm9pZCAwOkMuY29uZmlndXJhYmxlKSE9bnVsbD9GOnt9KX0pLF89KFM9KEs9KEI9RS50YXNrcyk9PW51bGw/dm9pZCAwOkJbMF0pPT1udWxsP3ZvaWQgMDpLLmludGVycnVwdHMpIT1udWxsP1M6W107cmV0dXJuIF8hPW51bGwmJl8ubGVuZ3RoJiYhKChIPW89PW51bGw/dm9pZCAwOm8uY29tbWFuZCkhPW51bGwmJkgucmVzdW1lKT8odGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguUlVOX1NUQVJURUQsdGhyZWFkSWQ6ZCxydW5JZDp0LnJ1bklkfSksdGhpcy5oYW5kbGVOb2RlQ2hhbmdlKHUpLF8uZm9yRWFjaChmPT57dGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguQ1VTVE9NLG5hbWU6XCJvbl9pbnRlcnJ1cHRcIix2YWx1ZTp0eXBlb2YgZi52YWx1ZT09XCJzdHJpbmdcIj9mLnZhbHVlOkpTT04uc3RyaW5naWZ5KGYudmFsdWUpLHJhd0V2ZW50OmZ9KX0pLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlJVTl9GSU5JU0hFRCx0aHJlYWRJZDpkLHJ1bklkOnQucnVuSWR9KSx0aGlzLnN1YnNjcmliZXIuY29tcGxldGUoKSk6e3N0cmVhbVJlc3BvbnNlOnRoaXMuY2xpZW50LnJ1bnMuc3RyZWFtKGQsdGhpcy5hc3Npc3RhbnQuYXNzaXN0YW50X2lkLHkpLHN0YXRlOkl9fWFzeW5jIGhhbmRsZVN0cmVhbUV2ZW50cyh0LGUscyxyLGkpe3ZhciBwLE4sTSxJLE8seSxfLEcsYixEO2xldHtmb3J3YXJkZWRQcm9wczpjfT1yLGc9Yz09bnVsbD92b2lkIDA6Yy5ub2RlTmFtZTt0aGlzLnN1YnNjcmliZXI9cztsZXQgbz0hMTtpZighdClyZXR1cm47bGV0e3N0cmVhbVJlc3BvbnNlOnUsc3RhdGU6ZH09dDt0aGlzLmFjdGl2ZVJ1bi5wcmV2Tm9kZU5hbWU9bnVsbDtsZXQgbD17fSxFPWQ7dHJ5e3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlJVTl9TVEFSVEVELHRocmVhZElkOmUscnVuSWQ6dGhpcy5hY3RpdmVSdW4uaWR9KSx0aGlzLmhhbmRsZU5vZGVDaGFuZ2UoZyk7dHJ5e2Zvcih2YXIgQT1zdCh1KSxSLGssQztSPSEoaz1hd2FpdCBBLm5leHQoKSkuZG9uZTtSPSExKXtsZXQgUz1rLnZhbHVlO2xldCBIPShwPXIuZm9yd2FyZGVkUHJvcHMpPT1udWxsP3ZvaWQgMDpwLnN0cmVhbVN1YmdyYXBocyxmPUgmJihTLmV2ZW50LnN0YXJ0c1dpdGgoXCJldmVudHNcIil8fFMuZXZlbnQuc3RhcnRzV2l0aChcInZhbHVlc1wiKSk7aWYoIWkuaW5jbHVkZXMoUy5ldmVudCkmJiFmJiZTLmV2ZW50IT09XCJlcnJvclwiKWNvbnRpbnVlO2xldCBUPVM7aWYoUy5ldmVudD09PVwiZXJyb3JcIil7dGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguUlVOX0VSUk9SLG1lc3NhZ2U6Uy5kYXRhLm1lc3NhZ2UscmF3RXZlbnQ6U30pO2JyZWFrfWlmKFMuZXZlbnQ9PT1cInVwZGF0ZXNcIiljb250aW51ZTtpZihTLmV2ZW50PT09XCJ2YWx1ZXNcIil7bD1ULmRhdGE7Y29udGludWV9ZWxzZSBpZihIJiZULmV2ZW50LnN0YXJ0c1dpdGgoXCJ2YWx1ZXN8XCIpKXtsPW0obSh7fSxsKSxULmRhdGEpO2NvbnRpbnVlfWxldCBVPVQuZGF0YSxZPShOPVUubWV0YWRhdGEpIT1udWxsP046e30sTD1ZLmxhbmdncmFwaF9ub2RlLHE9VS5ldmVudDtpZih0aGlzLmFjdGl2ZVJ1bi5pZD1ZLnJ1bl9pZCxMJiZMIT09dGhpcy5hY3RpdmVSdW4ubm9kZU5hbWUmJnRoaXMuaGFuZGxlTm9kZUNoYW5nZShMKSxvPW98fHE9PT1cIm9uX2N1c3RvbV9ldmVudFwiJiZVLm5hbWU9PT1cImV4aXRcIix0aGlzLmFjdGl2ZVJ1bi5leGl0aW5nTm9kZT10aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZT09PUwmJnE9PT1cIm9uX2NoYWluX2VuZFwiLHRoaXMuYWN0aXZlUnVuLmV4aXRpbmdOb2RlJiYodGhpcy5hY3RpdmVSdW4ubWFudWFsbHlFbWl0dGVkU3RhdGU9bnVsbCksKE09dGhpcy5hY3RpdmVSdW4uZ3JhcGhJbmZvKSE9bnVsbCYmTS5ub2Rlcy5zb21lKGx0PT5sdC5pZD09PUwpJiZ0aGlzLmhhbmRsZU5vZGVDaGFuZ2UoTCksRS52YWx1ZXM9KEk9dGhpcy5hY3RpdmVSdW4ubWFudWFsbHlFbWl0dGVkU3RhdGUpIT1udWxsP0k6bCwhdGhpcy5hY3RpdmVSdW4ubm9kZU5hbWUpY29udGludWU7KEpTT04uc3RyaW5naWZ5KEUpIT09SlNPTi5zdHJpbmdpZnkoZCl8fHRoaXMuYWN0aXZlUnVuLnByZXZOb2RlTmFtZSE9dGhpcy5hY3RpdmVSdW4ubm9kZU5hbWV8fHRoaXMuYWN0aXZlUnVuLmV4aXRpbmdOb2RlKSYmIXRoaXMuZ2V0TWVzc2FnZUluUHJvZ3Jlc3ModGhpcy5hY3RpdmVSdW4uaWQpJiYoZD1FLHRoaXMuYWN0aXZlUnVuLnByZXZOb2RlTmFtZT10aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5TVEFURV9TTkFQU0hPVCxzbmFwc2hvdDp0aGlzLmdldFN0YXRlU25hcHNob3QoZCkscmF3RXZlbnQ6VH0pKSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5SQVcsZXZlbnQ6VX0pLHRoaXMuaGFuZGxlU2luZ2xlRXZlbnQoVSl9fWNhdGNoKGspe0M9W2tdfWZpbmFsbHl7dHJ5e1ImJihrPUEucmV0dXJuKSYmYXdhaXQgay5jYWxsKEEpfWZpbmFsbHl7aWYoQyl0aHJvdyBDWzBdfX1kPWF3YWl0IHRoaXMuY2xpZW50LnRocmVhZHMuZ2V0U3RhdGUoZSk7bGV0IHg9ZC50YXNrcyxQPSh5PShPPXg9PW51bGw/dm9pZCAwOnhbMF0pPT1udWxsP3ZvaWQgMDpPLmludGVycnVwdHMpIT1udWxsP3k6W10sRj1kLm5leHQubGVuZ3RoPT09MCxCPShHPShfPWQubWV0YWRhdGEpPT1udWxsP3ZvaWQgMDpfLndyaXRlcykhPW51bGw/Rzp7fSxLPXRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lO3JldHVybiBQIT1udWxsJiZQLmxlbmd0aHx8KEs9Rj9cIl9fZW5kX19cIjooYj1kLm5leHRbMF0pIT1udWxsP2I6T2JqZWN0LmtleXMoQilbMF0pLFAuZm9yRWFjaChTPT57dGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguQ1VTVE9NLG5hbWU6XCJvbl9pbnRlcnJ1cHRcIix2YWx1ZTp0eXBlb2YgUy52YWx1ZT09XCJzdHJpbmdcIj9TLnZhbHVlOkpTT04uc3RyaW5naWZ5KFMudmFsdWUpLHJhd0V2ZW50OlN9KX0pLHRoaXMuaGFuZGxlTm9kZUNoYW5nZShLKSx0aGlzLmhhbmRsZU5vZGVDaGFuZ2Uodm9pZCAwKSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5TVEFURV9TTkFQU0hPVCxzbmFwc2hvdDp0aGlzLmdldFN0YXRlU25hcHNob3QoZCl9KSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5NRVNTQUdFU19TTkFQU0hPVCxtZXNzYWdlczphdCgoRD1kLnZhbHVlcy5tZXNzYWdlcykhPW51bGw/RDpbXSl9KSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5SVU5fRklOSVNIRUQsdGhyZWFkSWQ6ZSxydW5JZDp0aGlzLmFjdGl2ZVJ1bi5pZH0pLHRoaXMuYWN0aXZlUnVuPXZvaWQgMCxzLmNvbXBsZXRlKCl9Y2F0Y2goeCl7cmV0dXJuIHMuZXJyb3IoeCl9fWhhbmRsZVNpbmdsZUV2ZW50KHQpe3ZhciBlLHMscixpLGMsZyxvO3N3aXRjaCh0LmV2ZW50KXtjYXNlXCJvbl9jaGF0X21vZGVsX3N0cmVhbVwiOmxldCB1PShlPXQubWV0YWRhdGFbXCJlbWl0LW1lc3NhZ2VzXCJdKSE9bnVsbD9lOiEwLGQ9KHM9dC5tZXRhZGF0YVtcImVtaXQtdG9vbC1jYWxsc1wiXSkhPW51bGw/czohMDtpZih0LmRhdGEuY2h1bmsucmVzcG9uc2VfbWV0YWRhdGEuZmluaXNoX3JlYXNvbilyZXR1cm47bGV0IGw9dGhpcy5nZXRNZXNzYWdlSW5Qcm9ncmVzcyh0aGlzLmFjdGl2ZVJ1bi5pZCksRT0hIShsIT1udWxsJiZsLmlkKSxwPShyPXQuZGF0YS5jaHVuay50b29sX2NhbGxfY2h1bmtzKT09bnVsbD92b2lkIDA6clswXSxOPShpPXQubWV0YWRhdGEucHJlZGljdF9zdGF0ZSk9PW51bGw/dm9pZCAwOmkuc29tZShfPT5fLnRvb2w9PT0ocD09bnVsbD92b2lkIDA6cC5uYW1lKSksTT0hRSYmKHA9PW51bGw/dm9pZCAwOnAubmFtZSksST1FJiYobD09bnVsbD92b2lkIDA6bC50b29sQ2FsbElkKSYmKHA9PW51bGw/dm9pZCAwOnAuYXJncyksQT1FJiYobD09bnVsbD92b2lkIDA6bC50b29sQ2FsbElkKSYmIXA7KEF8fEl8fE0pJiYodGhpcy5hY3RpdmVSdW4uaGFzRnVuY3Rpb25TdHJlYW1pbmc9ITApO2xldCBSPWl0KHQuZGF0YSksaz13KHQuZGF0YS5jaHVuay5jb250ZW50KSxDPSEhKCFwJiZrKSxPPUUmJiEobCE9bnVsbCYmbC50b29sQ2FsbElkKSYmIUM7aWYoUil7dGhpcy5oYW5kbGVUaGlua2luZ0V2ZW50KFIpO2JyZWFrfWlmKCFSJiZ0aGlzLnRoaW5raW5nUHJvY2VzcyYmKHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9FTkR9KSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5USElOS0lOR19FTkR9KSx0aGlzLnRoaW5raW5nUHJvY2Vzcz1udWxsKSxOJiZ0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5DVVNUT00sbmFtZTpcIlByZWRpY3RTdGF0ZVwiLHZhbHVlOnQubWV0YWRhdGEucHJlZGljdF9zdGF0ZX0pLEEpe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRPT0xfQ0FMTF9FTkQsdG9vbENhbGxJZDpsPT1udWxsP3ZvaWQgMDpsLnRvb2xDYWxsSWQscmF3RXZlbnQ6dH0pJiYodGhpcy5tZXNzYWdlc0luUHJvY2Vzc1t0aGlzLmFjdGl2ZVJ1bi5pZF09bnVsbCk7YnJlYWt9aWYoTyl7dGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVEVYVF9NRVNTQUdFX0VORCxtZXNzYWdlSWQ6bC5pZCxyYXdFdmVudDp0fSkmJih0aGlzLm1lc3NhZ2VzSW5Qcm9jZXNzW3RoaXMuYWN0aXZlUnVuLmlkXT1udWxsKTticmVha31pZihNJiZkKXt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5UT09MX0NBTExfU1RBUlQsdG9vbENhbGxJZDpwLmlkLHRvb2xDYWxsTmFtZTpwLm5hbWUscGFyZW50TWVzc2FnZUlkOnQuZGF0YS5jaHVuay5pZCxyYXdFdmVudDp0fSkmJnRoaXMuc2V0TWVzc2FnZUluUHJvZ3Jlc3ModGhpcy5hY3RpdmVSdW4uaWQse2lkOnQuZGF0YS5jaHVuay5pZCx0b29sQ2FsbElkOnAuaWQsdG9vbENhbGxOYW1lOnAubmFtZX0pO2JyZWFrfWlmKEkmJmQpe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRPT0xfQ0FMTF9BUkdTLHRvb2xDYWxsSWQ6bD09bnVsbD92b2lkIDA6bC50b29sQ2FsbElkLGRlbHRhOnAuYXJncyxyYXdFdmVudDp0fSk7YnJlYWt9aWYoQyYmdSl7bHx8KHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRFWFRfTUVTU0FHRV9TVEFSVCxyb2xlOlwiYXNzaXN0YW50XCIsbWVzc2FnZUlkOnQuZGF0YS5jaHVuay5pZCxyYXdFdmVudDp0fSksdGhpcy5zZXRNZXNzYWdlSW5Qcm9ncmVzcyh0aGlzLmFjdGl2ZVJ1bi5pZCx7aWQ6dC5kYXRhLmNodW5rLmlkLHRvb2xDYWxsSWQ6bnVsbCx0b29sQ2FsbE5hbWU6bnVsbH0pLGw9dGhpcy5nZXRNZXNzYWdlSW5Qcm9ncmVzcyh0aGlzLmFjdGl2ZVJ1bi5pZCkpLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRFWFRfTUVTU0FHRV9DT05URU5ULG1lc3NhZ2VJZDpsLmlkLGRlbHRhOmsscmF3RXZlbnQ6dH0pO2JyZWFrfWJyZWFrO2Nhc2VcIm9uX2NoYXRfbW9kZWxfZW5kXCI6aWYoKGM9dGhpcy5nZXRNZXNzYWdlSW5Qcm9ncmVzcyh0aGlzLmFjdGl2ZVJ1bi5pZCkpIT1udWxsJiZjLnRvb2xDYWxsSWQpe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRPT0xfQ0FMTF9FTkQsdG9vbENhbGxJZDp0aGlzLmdldE1lc3NhZ2VJblByb2dyZXNzKHRoaXMuYWN0aXZlUnVuLmlkKS50b29sQ2FsbElkLHJhd0V2ZW50OnR9KSYmKHRoaXMubWVzc2FnZXNJblByb2Nlc3NbdGhpcy5hY3RpdmVSdW4uaWRdPW51bGwpO2JyZWFrfWlmKChnPXRoaXMuZ2V0TWVzc2FnZUluUHJvZ3Jlc3ModGhpcy5hY3RpdmVSdW4uaWQpKSE9bnVsbCYmZy5pZCl7dGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVEVYVF9NRVNTQUdFX0VORCxtZXNzYWdlSWQ6dGhpcy5nZXRNZXNzYWdlSW5Qcm9ncmVzcyh0aGlzLmFjdGl2ZVJ1bi5pZCkuaWQscmF3RXZlbnQ6dH0pJiYodGhpcy5tZXNzYWdlc0luUHJvY2Vzc1t0aGlzLmFjdGl2ZVJ1bi5pZF09bnVsbCk7YnJlYWt9YnJlYWs7Y2FzZVwib25fY3VzdG9tX2V2ZW50XCI6aWYodC5uYW1lPT09XCJtYW51YWxseV9lbWl0X21lc3NhZ2VcIil7dGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVEVYVF9NRVNTQUdFX1NUQVJULHJvbGU6XCJhc3Npc3RhbnRcIixtZXNzYWdlSWQ6dC5kYXRhLm1lc3NhZ2VfaWQscmF3RXZlbnQ6dH0pLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRFWFRfTUVTU0FHRV9DT05URU5ULG1lc3NhZ2VJZDp0LmRhdGEubWVzc2FnZV9pZCxkZWx0YTp0LmRhdGEubWVzc2FnZSxyYXdFdmVudDp0fSksdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVEVYVF9NRVNTQUdFX0VORCxtZXNzYWdlSWQ6dC5kYXRhLm1lc3NhZ2VfaWQscmF3RXZlbnQ6dH0pO2JyZWFrfWlmKHQubmFtZT09PVwibWFudWFsbHlfZW1pdF90b29sX2NhbGxcIil7dGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVE9PTF9DQUxMX1NUQVJULHRvb2xDYWxsSWQ6dC5kYXRhLmlkLHRvb2xDYWxsTmFtZTp0LmRhdGEubmFtZSxwYXJlbnRNZXNzYWdlSWQ6dC5kYXRhLmlkLHJhd0V2ZW50OnR9KSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5UT09MX0NBTExfQVJHUyx0b29sQ2FsbElkOnQuZGF0YS5pZCxkZWx0YTp0LmRhdGEuYXJncyxyYXdFdmVudDp0fSksdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVE9PTF9DQUxMX0VORCx0b29sQ2FsbElkOnQuZGF0YS5pZCxyYXdFdmVudDp0fSk7YnJlYWt9dC5uYW1lPT09XCJtYW51YWxseV9lbWl0X3N0YXRlXCImJih0aGlzLmFjdGl2ZVJ1bi5tYW51YWxseUVtaXR0ZWRTdGF0ZT10LmRhdGEsdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguU1RBVEVfU05BUFNIT1Qsc25hcHNob3Q6dGhpcy5nZXRTdGF0ZVNuYXBzaG90KHt2YWx1ZXM6dGhpcy5hY3RpdmVSdW4ubWFudWFsbHlFbWl0dGVkU3RhdGV9KSxyYXdFdmVudDp0fSkpLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLkNVU1RPTSxuYW1lOnQubmFtZSx2YWx1ZTp0LmRhdGEscmF3RXZlbnQ6dH0pO2JyZWFrO2Nhc2VcIm9uX3Rvb2xfZW5kXCI6bGV0IHk9KG89dC5kYXRhKT09bnVsbD92b2lkIDA6by5vdXRwdXQ7dGhpcy5hY3RpdmVSdW4uaGFzRnVuY3Rpb25TdHJlYW1pbmd8fCh0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5UT09MX0NBTExfU1RBUlQsdG9vbENhbGxJZDp5LnRvb2xfY2FsbF9pZCx0b29sQ2FsbE5hbWU6eS5uYW1lLHBhcmVudE1lc3NhZ2VJZDp5LmlkLHJhd0V2ZW50OnR9KSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5UT09MX0NBTExfQVJHUyx0b29sQ2FsbElkOnkudG9vbF9jYWxsX2lkLGRlbHRhOkpTT04uc3RyaW5naWZ5KHQuZGF0YS5pbnB1dCkscmF3RXZlbnQ6dH0pLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRPT0xfQ0FMTF9FTkQsdG9vbENhbGxJZDp5LnRvb2xfY2FsbF9pZCxyYXdFdmVudDp0fSkpLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRPT0xfQ0FMTF9SRVNVTFQsdG9vbENhbGxJZDp5LnRvb2xfY2FsbF9pZCxjb250ZW50Onk9PW51bGw/dm9pZCAwOnkuY29udGVudCxtZXNzYWdlSWQ6VigpLHJvbGU6XCJ0b29sXCJ9KTticmVha319aGFuZGxlVGhpbmtpbmdFdmVudCh0KXt2YXIgcztpZighdHx8IXQudHlwZXx8IXQudGV4dClyZXR1cm47bGV0IGU9dC5pbmRleDsocz10aGlzLnRoaW5raW5nUHJvY2VzcykhPW51bGwmJnMuaW5kZXgmJnRoaXMudGhpbmtpbmdQcm9jZXNzLmluZGV4IT09ZSYmKHRoaXMudGhpbmtpbmdQcm9jZXNzLnR5cGUmJnRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9FTkR9KSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5USElOS0lOR19FTkR9KSx0aGlzLnRoaW5raW5nUHJvY2Vzcz1udWxsKSx0aGlzLnRoaW5raW5nUHJvY2Vzc3x8KHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRISU5LSU5HX1NUQVJUfSksdGhpcy50aGlua2luZ1Byb2Nlc3M9e2luZGV4OmV9KSx0aGlzLnRoaW5raW5nUHJvY2Vzcy50eXBlIT09dC50eXBlJiYodGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVEhJTktJTkdfVEVYVF9NRVNTQUdFX1NUQVJUfSksdGhpcy50aGlua2luZ1Byb2Nlc3MudHlwZT10LnR5cGUpLHRoaXMudGhpbmtpbmdQcm9jZXNzLnR5cGUmJnRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9DT05URU5ULGRlbHRhOnQudGV4dH0pfWdldFN0YXRlU25hcHNob3QodCl7bGV0IGU9dC52YWx1ZXMscz10aGlzLmFjdGl2ZVJ1bi5zY2hlbWFLZXlzO3JldHVybiBzIT1udWxsJiZzLm91dHB1dCYmKGU9WChlLFsuLi50aGlzLmNvbnN0YW50U2NoZW1hS2V5cywuLi5zLm91dHB1dF0pKSxlfWFzeW5jIGdldE9yQ3JlYXRlVGhyZWFkKHQsZSl7bGV0IHM7dHJ5e3RyeXtzPWF3YWl0IHRoaXMuZ2V0VGhyZWFkKHQpfWNhdGNoKHIpe3M9YXdhaXQgdGhpcy5jcmVhdGVUaHJlYWQoe3RocmVhZElkOnQsbWV0YWRhdGE6ZX0pfX1jYXRjaChyKXt0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBjcmVhdGUgdGhyZWFkOiAke3IubWVzc2FnZX1gKX1yZXR1cm4gc31hc3luYyBnZXRUaHJlYWQodCl7cmV0dXJuIHRoaXMuY2xpZW50LnRocmVhZHMuZ2V0KHQpfWFzeW5jIGNyZWF0ZVRocmVhZCh0KXtyZXR1cm4gdGhpcy5jbGllbnQudGhyZWFkcy5jcmVhdGUodCl9YXN5bmMgbWVyZ2VDb25maWdzKHtjb25maWdzOnQsYXNzaXN0YW50OmUsc2NoZW1hS2V5czpzfSl7cmV0dXJuIHQucmVkdWNlKChyLGkpPT57dmFyIGw7bGV0IGM9ci5jb25maWd1cmFibGU7aS5jb25maWd1cmFibGUmJihjPXMhPW51bGwmJnMuY29uZmlnP1goaT09bnVsbD92b2lkIDA6aS5jb25maWd1cmFibGUsWy4uLnRoaXMuY29uc3RhbnRTY2hlbWFLZXlzLC4uLihsPXM9PW51bGw/dm9pZCAwOnMuY29uZmlnKSE9bnVsbD9sOltdXSk6aT09bnVsbD92b2lkIDA6aS5jb25maWd1cmFibGUpO2xldCBnPXYobShtKHt9LHIpLGkpLHtjb25maWd1cmFibGU6Y30pLG89ci5yZWN1cnNpb25fbGltaXQ9PW51bGwmJmkucmVjdXJzaW9uX2xpbWl0PT09MjUsdT1KU09OLnN0cmluZ2lmeShnKSE9PUpTT04uc3RyaW5naWZ5KHIpLGQ9byYmSlNPTi5zdHJpbmdpZnkodihtKHt9LGcpLHtyZWN1cnNpb25fbGltaXQ6bnVsbH0pKT09PUpTT04uc3RyaW5naWZ5KHYobSh7fSxyKSx7cmVjdXJzaW9uX2xpbWl0Om51bGx9KSk7cmV0dXJuIHUmJiFkP20obSh7fSxyKSxnKTpyfSxlLmNvbmZpZyl9Z2V0TWVzc2FnZUluUHJvZ3Jlc3ModCl7cmV0dXJuIHRoaXMubWVzc2FnZXNJblByb2Nlc3NbdF19c2V0TWVzc2FnZUluUHJvZ3Jlc3ModCxlKXt0aGlzLm1lc3NhZ2VzSW5Qcm9jZXNzPXYobSh7fSx0aGlzLm1lc3NhZ2VzSW5Qcm9jZXNzKSx7W3RdOm0obSh7fSx0aGlzLm1lc3NhZ2VzSW5Qcm9jZXNzW3RdKSxlKX0pfWFzeW5jIGdldEFzc2lzdGFudCgpe2xldCB0PWF3YWl0IHRoaXMuY2xpZW50LmFzc2lzdGFudHMuc2VhcmNoKCksZT10LmZpbmQocz0+cy5ncmFwaF9pZD09PXRoaXMuZ3JhcGhJZCk7aWYoIWUpdGhyb3cgY29uc29sZS5lcnJvcihgXG4gICAgICBObyBhZ2VudCBmb3VuZCB3aXRoIGdyYXBoIElEICR7dGhpcy5ncmFwaElkfSBmb3VuZC4uXG5cbiAgICAgIFxuICAgICAgVGhlc2UgYXJlIHRoZSBhdmFpbGFibGUgYWdlbnRzOiBbJHt0Lm1hcChzPT5gJHtzLmdyYXBoX2lkfSAoSUQ6ICR7cy5hc3Npc3RhbnRfaWR9KWApLmpvaW4oXCIsIFwiKX1dXG4gICAgICBgKSxuZXcgRXJyb3IoXCJObyBhZ2VudCBpZCBmb3VuZFwiKTtyZXR1cm4gZX1hc3luYyBnZXRTY2hlbWFLZXlzKCl7dmFyIHQsZSxzLHI7dHJ5e2xldCBpPWF3YWl0IHRoaXMuY2xpZW50LmFzc2lzdGFudHMuZ2V0U2NoZW1hcyh0aGlzLmFzc2lzdGFudC5hc3Npc3RhbnRfaWQpLGM9bnVsbCxnPVtdO2lmKFwiY29udGV4dF9zY2hlbWFcImluIGkmJigodD1pLmNvbnRleHRfc2NoZW1hKSE9bnVsbCYmdC5wcm9wZXJ0aWVzKSYmKGc9T2JqZWN0LmtleXMoaS5jb250ZXh0X3NjaGVtYS5wcm9wZXJ0aWVzKSksKGU9aS5jb25maWdfc2NoZW1hKSE9bnVsbCYmZS5wcm9wZXJ0aWVzJiYoYz1PYmplY3Qua2V5cyhpLmNvbmZpZ19zY2hlbWEucHJvcGVydGllcykpLCEoKHM9aS5pbnB1dF9zY2hlbWEpIT1udWxsJiZzLnByb3BlcnRpZXMpfHwhKChyPWkub3V0cHV0X3NjaGVtYSkhPW51bGwmJnIucHJvcGVydGllcykpcmV0dXJue2NvbmZpZzpbXSxpbnB1dDpudWxsLG91dHB1dDpudWxsLGNvbnRleHQ6Z307bGV0IG89T2JqZWN0LmtleXMoaS5pbnB1dF9zY2hlbWEucHJvcGVydGllcyksdT1PYmplY3Qua2V5cyhpLm91dHB1dF9zY2hlbWEucHJvcGVydGllcyk7cmV0dXJue2lucHV0Om8mJm8ubGVuZ3RoP1suLi5vLC4uLnRoaXMuY29uc3RhbnRTY2hlbWFLZXlzXTpudWxsLG91dHB1dDp1JiZ1Lmxlbmd0aD9bLi4udSwuLi50aGlzLmNvbnN0YW50U2NoZW1hS2V5c106bnVsbCxjb250ZXh0OmcsY29uZmlnOmN9fWNhdGNoKGkpe3JldHVybntjb25maWc6W10saW5wdXQ6dGhpcy5jb25zdGFudFNjaGVtYUtleXMsb3V0cHV0OnRoaXMuY29uc3RhbnRTY2hlbWFLZXlzLGNvbnRleHQ6W119fX1sYW5nR3JhcGhEZWZhdWx0TWVyZ2VTdGF0ZSh0LGUscyl7dmFyIG8sdTtlLmxlbmd0aD4wJiZcInJvbGVcImluIGVbMF0mJmVbMF0ucm9sZT09PVwic3lzdGVtXCImJihlPWUuc2xpY2UoMSkpO2xldCByPXQubWVzc2FnZXN8fFtdLGk9bmV3IFNldChyLm1hcChkPT5kLmlkKSksYz1lLmZpbHRlcihkPT4haS5oYXMoZC5pZCkpLGc9Wy4uLihvPXQudG9vbHMpIT1udWxsP286W10sLi4uKHU9cy50b29scykhPW51bGw/dTpbXV0ucmVkdWNlKChkLGwpPT57bGV0IEU9bDtyZXR1cm4gbC50eXBlfHwoRT17dHlwZTpcImZ1bmN0aW9uXCIsbmFtZTpsLm5hbWUsZnVuY3Rpb246e25hbWU6bC5uYW1lLGRlc2NyaXB0aW9uOmwuZGVzY3JpcHRpb24scGFyYW1ldGVyczpsLnBhcmFtZXRlcnN9fSksZC5maW5kKHA9PnAubmFtZT09PUUubmFtZXx8cC5mdW5jdGlvbi5uYW1lPT09RS5mdW5jdGlvbi5uYW1lKT9kOlsuLi5kLEVdfSxbXSk7cmV0dXJuIHYobSh7fSx0KSx7bWVzc2FnZXM6Yyx0b29sczpnLFwiYWctdWlcIjp7dG9vbHM6Zyxjb250ZXh0OnMuY29udGV4dH19KX1oYW5kbGVOb2RlQ2hhbmdlKHQpe3ZhciBlLHM7dD09PVwiX19lbmRfX1wiJiYodD12b2lkIDApLHQhPT0oKGU9dGhpcy5hY3RpdmVSdW4pPT1udWxsP3ZvaWQgMDplLm5vZGVOYW1lKSYmKChzPXRoaXMuYWN0aXZlUnVuKSE9bnVsbCYmcy5ub2RlTmFtZSYmdGhpcy5lbmRTdGVwKCksdCYmdGhpcy5zdGFydFN0ZXAodCkpLHRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lPXR9c3RhcnRTdGVwKHQpe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlNURVBfU1RBUlRFRCxzdGVwTmFtZTp0fSl9ZW5kU3RlcCgpe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlNURVBfRklOSVNIRUQsc3RlcE5hbWU6dGhpcy5hY3RpdmVSdW4ubm9kZU5hbWV9KX1hc3luYyBnZXRDaGVja3BvaW50QnlNZXNzYWdlKHQsZSxzKXt2YXIgTSxBO2xldCByPXMhPW51bGwmJnMuY2hlY2twb2ludF9pZD97Y2hlY2twb2ludDp7Y2hlY2twb2ludF9pZDpzLmNoZWNrcG9pbnRfaWR9fTp2b2lkIDAsYz1bLi4uYXdhaXQgdGhpcy5jbGllbnQudGhyZWFkcy5nZXRIaXN0b3J5KGUscildLnJldmVyc2UoKSxnPWMuZmluZChSPT57dmFyIGs7cmV0dXJuKGs9Ui52YWx1ZXMubWVzc2FnZXMpPT1udWxsP3ZvaWQgMDprLnNvbWUoQz0+Qy5pZD09PXQpfSk7aWYoIWcpdGhyb3cgbmV3IEVycm9yKFwiTWVzc2FnZSBub3QgZm91bmRcIik7bGV0IG89KE09Zy52YWx1ZXMubWVzc2FnZXMpIT1udWxsP006W10sdT1vLmZpbmRJbmRleChSPT5SLmlkPT09dCk7aWYoby5zbGljZSh1KzEpLmxlbmd0aClyZXR1cm4gdGhpcy5nZXRDaGVja3BvaW50QnlNZXNzYWdlKHQsZSxnLnBhcmVudF9jaGVja3BvaW50KTtsZXQgbD1jLmluZGV4T2YoZyksST1nLnZhbHVlcyx7bWVzc2FnZXM6RX09SSxwPWV0KEksW1wibWVzc2FnZXNcIl0pLE49KEE9Y1tsLTFdKSE9bnVsbD9BOnYobSh7fSxnKSx7dmFsdWVzOnt9fSk7cmV0dXJuIHYobSh7fSxOKSx7dmFsdWVzOm0obSh7fSxOLnZhbHVlcykscCl9KX19O3ZhciBvdD1jbGFzcyBleHRlbmRzIFN0e307ZXhwb3J0e3V0IGFzIEN1c3RvbUV2ZW50TmFtZXMscnQgYXMgTGFuZ0dyYXBoQWdlbnQsY3QgYXMgTGFuZ0dyYXBoRXZlbnRUeXBlcyxvdCBhcyBMYW5nR3JhcGhIdHRwQWdlbnR9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/langgraph/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/proto/dist/index.mjs":
/*!**************************************************!*\
  !*** ./node_modules/@ag-ui/proto/dist/index.mjs ***!
  \**************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AGUI_MEDIA_TYPE: () => (/* binding */ AGUI_MEDIA_TYPE),\n/* harmony export */   decode: () => (/* binding */ decode),\n/* harmony export */   encode: () => (/* binding */ encode)\n/* harmony export */ });\n/* harmony import */ var _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @ag-ui/core */ \"(rsc)/./node_modules/@ag-ui/core/dist/index.mjs\");\n/* harmony import */ var _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @bufbuild/protobuf/wire */ \"(rsc)/./node_modules/@bufbuild/protobuf/dist/esm/wire/binary-encoding.js\");\n// src/proto.ts\n\n\n// src/generated/events.ts\n\n\n// src/generated/google/protobuf/struct.ts\n\nfunction createBaseStruct() {\n  return { fields: {} };\n}\nvar Struct = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    Object.entries(message.fields).forEach(([key, value]) => {\n      if (value !== void 0) {\n        Struct_FieldsEntry.encode({ key, value }, writer.uint32(10).fork()).join();\n      }\n    });\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStruct();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          const entry1 = Struct_FieldsEntry.decode(reader, reader.uint32());\n          if (entry1.value !== void 0) {\n            message.fields[entry1.key] = entry1.value;\n          }\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Struct.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStruct();\n    message.fields = Object.entries((_a = object.fields) != null ? _a : {}).reduce(\n      (acc, [key, value]) => {\n        if (value !== void 0) {\n          acc[key] = value;\n        }\n        return acc;\n      },\n      {}\n    );\n    return message;\n  },\n  wrap(object) {\n    const struct = createBaseStruct();\n    if (object !== void 0) {\n      for (const key of Object.keys(object)) {\n        struct.fields[key] = object[key];\n      }\n    }\n    return struct;\n  },\n  unwrap(message) {\n    const object = {};\n    if (message.fields) {\n      for (const key of Object.keys(message.fields)) {\n        object[key] = message.fields[key];\n      }\n    }\n    return object;\n  }\n};\nfunction createBaseStruct_FieldsEntry() {\n  return { key: \"\", value: void 0 };\n}\nvar Struct_FieldsEntry = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.key !== \"\") {\n      writer.uint32(10).string(message.key);\n    }\n    if (message.value !== void 0) {\n      Value.encode(Value.wrap(message.value), writer.uint32(18).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStruct_FieldsEntry();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.key = reader.string();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.value = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Struct_FieldsEntry.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseStruct_FieldsEntry();\n    message.key = (_a = object.key) != null ? _a : \"\";\n    message.value = (_b = object.value) != null ? _b : void 0;\n    return message;\n  }\n};\nfunction createBaseValue() {\n  return {\n    nullValue: void 0,\n    numberValue: void 0,\n    stringValue: void 0,\n    boolValue: void 0,\n    structValue: void 0,\n    listValue: void 0\n  };\n}\nvar Value = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.nullValue !== void 0) {\n      writer.uint32(8).int32(message.nullValue);\n    }\n    if (message.numberValue !== void 0) {\n      writer.uint32(17).double(message.numberValue);\n    }\n    if (message.stringValue !== void 0) {\n      writer.uint32(26).string(message.stringValue);\n    }\n    if (message.boolValue !== void 0) {\n      writer.uint32(32).bool(message.boolValue);\n    }\n    if (message.structValue !== void 0) {\n      Struct.encode(Struct.wrap(message.structValue), writer.uint32(42).fork()).join();\n    }\n    if (message.listValue !== void 0) {\n      ListValue.encode(ListValue.wrap(message.listValue), writer.uint32(50).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseValue();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 8) {\n            break;\n          }\n          message.nullValue = reader.int32();\n          continue;\n        }\n        case 2: {\n          if (tag !== 17) {\n            break;\n          }\n          message.numberValue = reader.double();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.stringValue = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 32) {\n            break;\n          }\n          message.boolValue = reader.bool();\n          continue;\n        }\n        case 5: {\n          if (tag !== 42) {\n            break;\n          }\n          message.structValue = Struct.unwrap(Struct.decode(reader, reader.uint32()));\n          continue;\n        }\n        case 6: {\n          if (tag !== 50) {\n            break;\n          }\n          message.listValue = ListValue.unwrap(ListValue.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Value.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c, _d, _e, _f;\n    const message = createBaseValue();\n    message.nullValue = (_a = object.nullValue) != null ? _a : void 0;\n    message.numberValue = (_b = object.numberValue) != null ? _b : void 0;\n    message.stringValue = (_c = object.stringValue) != null ? _c : void 0;\n    message.boolValue = (_d = object.boolValue) != null ? _d : void 0;\n    message.structValue = (_e = object.structValue) != null ? _e : void 0;\n    message.listValue = (_f = object.listValue) != null ? _f : void 0;\n    return message;\n  },\n  wrap(value) {\n    const result = createBaseValue();\n    if (value === null) {\n      result.nullValue = 0 /* NULL_VALUE */;\n    } else if (typeof value === \"boolean\") {\n      result.boolValue = value;\n    } else if (typeof value === \"number\") {\n      result.numberValue = value;\n    } else if (typeof value === \"string\") {\n      result.stringValue = value;\n    } else if (globalThis.Array.isArray(value)) {\n      result.listValue = value;\n    } else if (typeof value === \"object\") {\n      result.structValue = value;\n    } else if (typeof value !== \"undefined\") {\n      throw new globalThis.Error(\"Unsupported any value type: \" + typeof value);\n    }\n    return result;\n  },\n  unwrap(message) {\n    if (message.stringValue !== void 0) {\n      return message.stringValue;\n    } else if ((message == null ? void 0 : message.numberValue) !== void 0) {\n      return message.numberValue;\n    } else if ((message == null ? void 0 : message.boolValue) !== void 0) {\n      return message.boolValue;\n    } else if ((message == null ? void 0 : message.structValue) !== void 0) {\n      return message.structValue;\n    } else if ((message == null ? void 0 : message.listValue) !== void 0) {\n      return message.listValue;\n    } else if ((message == null ? void 0 : message.nullValue) !== void 0) {\n      return null;\n    }\n    return void 0;\n  }\n};\nfunction createBaseListValue() {\n  return { values: [] };\n}\nvar ListValue = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    for (const v of message.values) {\n      Value.encode(Value.wrap(v), writer.uint32(10).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseListValue();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.values.push(Value.unwrap(Value.decode(reader, reader.uint32())));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ListValue.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseListValue();\n    message.values = ((_a = object.values) == null ? void 0 : _a.map((e) => e)) || [];\n    return message;\n  },\n  wrap(array) {\n    const result = createBaseListValue();\n    result.values = array != null ? array : [];\n    return result;\n  },\n  unwrap(message) {\n    if ((message == null ? void 0 : message.hasOwnProperty(\"values\")) && globalThis.Array.isArray(message.values)) {\n      return message.values;\n    } else {\n      return message;\n    }\n  }\n};\n\n// src/generated/patch.ts\n\nvar JsonPatchOperationType = /* @__PURE__ */ ((JsonPatchOperationType2) => {\n  JsonPatchOperationType2[JsonPatchOperationType2[\"ADD\"] = 0] = \"ADD\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"REMOVE\"] = 1] = \"REMOVE\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"REPLACE\"] = 2] = \"REPLACE\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"MOVE\"] = 3] = \"MOVE\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"COPY\"] = 4] = \"COPY\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"TEST\"] = 5] = \"TEST\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"UNRECOGNIZED\"] = -1] = \"UNRECOGNIZED\";\n  return JsonPatchOperationType2;\n})(JsonPatchOperationType || {});\nfunction createBaseJsonPatchOperation() {\n  return { op: 0, path: \"\", from: void 0, value: void 0 };\n}\nvar JsonPatchOperation = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.op !== 0) {\n      writer.uint32(8).int32(message.op);\n    }\n    if (message.path !== \"\") {\n      writer.uint32(18).string(message.path);\n    }\n    if (message.from !== void 0) {\n      writer.uint32(26).string(message.from);\n    }\n    if (message.value !== void 0) {\n      Value.encode(Value.wrap(message.value), writer.uint32(34).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseJsonPatchOperation();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 8) {\n            break;\n          }\n          message.op = reader.int32();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.path = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.from = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.value = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return JsonPatchOperation.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c, _d;\n    const message = createBaseJsonPatchOperation();\n    message.op = (_a = object.op) != null ? _a : 0;\n    message.path = (_b = object.path) != null ? _b : \"\";\n    message.from = (_c = object.from) != null ? _c : void 0;\n    message.value = (_d = object.value) != null ? _d : void 0;\n    return message;\n  }\n};\n\n// src/generated/types.ts\n\nfunction createBaseToolCall() {\n  return { id: \"\", type: \"\", function: void 0 };\n}\nvar ToolCall = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.id !== \"\") {\n      writer.uint32(10).string(message.id);\n    }\n    if (message.type !== \"\") {\n      writer.uint32(18).string(message.type);\n    }\n    if (message.function !== void 0) {\n      ToolCall_Function.encode(message.function, writer.uint32(26).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCall();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.id = reader.string();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.type = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.function = ToolCall_Function.decode(reader, reader.uint32());\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCall.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseToolCall();\n    message.id = (_a = object.id) != null ? _a : \"\";\n    message.type = (_b = object.type) != null ? _b : \"\";\n    message.function = object.function !== void 0 && object.function !== null ? ToolCall_Function.fromPartial(object.function) : void 0;\n    return message;\n  }\n};\nfunction createBaseToolCall_Function() {\n  return { name: \"\", arguments: \"\" };\n}\nvar ToolCall_Function = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.name !== \"\") {\n      writer.uint32(10).string(message.name);\n    }\n    if (message.arguments !== \"\") {\n      writer.uint32(18).string(message.arguments);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCall_Function();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.name = reader.string();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.arguments = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCall_Function.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseToolCall_Function();\n    message.name = (_a = object.name) != null ? _a : \"\";\n    message.arguments = (_b = object.arguments) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseMessage() {\n  return {\n    id: \"\",\n    role: \"\",\n    content: void 0,\n    name: void 0,\n    toolCalls: [],\n    toolCallId: void 0,\n    error: void 0\n  };\n}\nvar Message = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.id !== \"\") {\n      writer.uint32(10).string(message.id);\n    }\n    if (message.role !== \"\") {\n      writer.uint32(18).string(message.role);\n    }\n    if (message.content !== void 0) {\n      writer.uint32(26).string(message.content);\n    }\n    if (message.name !== void 0) {\n      writer.uint32(34).string(message.name);\n    }\n    for (const v of message.toolCalls) {\n      ToolCall.encode(v, writer.uint32(42).fork()).join();\n    }\n    if (message.toolCallId !== void 0) {\n      writer.uint32(50).string(message.toolCallId);\n    }\n    if (message.error !== void 0) {\n      writer.uint32(58).string(message.error);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseMessage();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.id = reader.string();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.role = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.content = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.name = reader.string();\n          continue;\n        }\n        case 5: {\n          if (tag !== 42) {\n            break;\n          }\n          message.toolCalls.push(ToolCall.decode(reader, reader.uint32()));\n          continue;\n        }\n        case 6: {\n          if (tag !== 50) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n        case 7: {\n          if (tag !== 58) {\n            break;\n          }\n          message.error = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Message.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c, _d, _e, _f, _g;\n    const message = createBaseMessage();\n    message.id = (_a = object.id) != null ? _a : \"\";\n    message.role = (_b = object.role) != null ? _b : \"\";\n    message.content = (_c = object.content) != null ? _c : void 0;\n    message.name = (_d = object.name) != null ? _d : void 0;\n    message.toolCalls = ((_e = object.toolCalls) == null ? void 0 : _e.map((e) => ToolCall.fromPartial(e))) || [];\n    message.toolCallId = (_f = object.toolCallId) != null ? _f : void 0;\n    message.error = (_g = object.error) != null ? _g : void 0;\n    return message;\n  }\n};\n\n// src/generated/events.ts\nvar EventType = /* @__PURE__ */ ((EventType3) => {\n  EventType3[EventType3[\"TEXT_MESSAGE_START\"] = 0] = \"TEXT_MESSAGE_START\";\n  EventType3[EventType3[\"TEXT_MESSAGE_CONTENT\"] = 1] = \"TEXT_MESSAGE_CONTENT\";\n  EventType3[EventType3[\"TEXT_MESSAGE_END\"] = 2] = \"TEXT_MESSAGE_END\";\n  EventType3[EventType3[\"TOOL_CALL_START\"] = 3] = \"TOOL_CALL_START\";\n  EventType3[EventType3[\"TOOL_CALL_ARGS\"] = 4] = \"TOOL_CALL_ARGS\";\n  EventType3[EventType3[\"TOOL_CALL_END\"] = 5] = \"TOOL_CALL_END\";\n  EventType3[EventType3[\"STATE_SNAPSHOT\"] = 6] = \"STATE_SNAPSHOT\";\n  EventType3[EventType3[\"STATE_DELTA\"] = 7] = \"STATE_DELTA\";\n  EventType3[EventType3[\"MESSAGES_SNAPSHOT\"] = 8] = \"MESSAGES_SNAPSHOT\";\n  EventType3[EventType3[\"RAW\"] = 9] = \"RAW\";\n  EventType3[EventType3[\"CUSTOM\"] = 10] = \"CUSTOM\";\n  EventType3[EventType3[\"RUN_STARTED\"] = 11] = \"RUN_STARTED\";\n  EventType3[EventType3[\"RUN_FINISHED\"] = 12] = \"RUN_FINISHED\";\n  EventType3[EventType3[\"RUN_ERROR\"] = 13] = \"RUN_ERROR\";\n  EventType3[EventType3[\"STEP_STARTED\"] = 14] = \"STEP_STARTED\";\n  EventType3[EventType3[\"STEP_FINISHED\"] = 15] = \"STEP_FINISHED\";\n  EventType3[EventType3[\"UNRECOGNIZED\"] = -1] = \"UNRECOGNIZED\";\n  return EventType3;\n})(EventType || {});\nfunction createBaseBaseEvent() {\n  return { type: 0, timestamp: void 0, rawEvent: void 0 };\n}\nvar BaseEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.type !== 0) {\n      writer.uint32(8).int32(message.type);\n    }\n    if (message.timestamp !== void 0) {\n      writer.uint32(16).int64(message.timestamp);\n    }\n    if (message.rawEvent !== void 0) {\n      Value.encode(Value.wrap(message.rawEvent), writer.uint32(26).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseBaseEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 8) {\n            break;\n          }\n          message.type = reader.int32();\n          continue;\n        }\n        case 2: {\n          if (tag !== 16) {\n            break;\n          }\n          message.timestamp = longToNumber(reader.int64());\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.rawEvent = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return BaseEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c;\n    const message = createBaseBaseEvent();\n    message.type = (_a = object.type) != null ? _a : 0;\n    message.timestamp = (_b = object.timestamp) != null ? _b : void 0;\n    message.rawEvent = (_c = object.rawEvent) != null ? _c : void 0;\n    return message;\n  }\n};\nfunction createBaseTextMessageStartEvent() {\n  return { baseEvent: void 0, messageId: \"\", role: void 0 };\n}\nvar TextMessageStartEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.messageId !== \"\") {\n      writer.uint32(18).string(message.messageId);\n    }\n    if (message.role !== void 0) {\n      writer.uint32(26).string(message.role);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseTextMessageStartEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messageId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.role = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return TextMessageStartEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseTextMessageStartEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messageId = (_a = object.messageId) != null ? _a : \"\";\n    message.role = (_b = object.role) != null ? _b : void 0;\n    return message;\n  }\n};\nfunction createBaseTextMessageContentEvent() {\n  return { baseEvent: void 0, messageId: \"\", delta: \"\" };\n}\nvar TextMessageContentEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.messageId !== \"\") {\n      writer.uint32(18).string(message.messageId);\n    }\n    if (message.delta !== \"\") {\n      writer.uint32(26).string(message.delta);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseTextMessageContentEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messageId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.delta = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return TextMessageContentEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseTextMessageContentEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messageId = (_a = object.messageId) != null ? _a : \"\";\n    message.delta = (_b = object.delta) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseTextMessageEndEvent() {\n  return { baseEvent: void 0, messageId: \"\" };\n}\nvar TextMessageEndEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.messageId !== \"\") {\n      writer.uint32(18).string(message.messageId);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseTextMessageEndEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messageId = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return TextMessageEndEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseTextMessageEndEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messageId = (_a = object.messageId) != null ? _a : \"\";\n    return message;\n  }\n};\nfunction createBaseToolCallStartEvent() {\n  return { baseEvent: void 0, toolCallId: \"\", toolCallName: \"\", parentMessageId: void 0 };\n}\nvar ToolCallStartEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.toolCallId !== \"\") {\n      writer.uint32(18).string(message.toolCallId);\n    }\n    if (message.toolCallName !== \"\") {\n      writer.uint32(26).string(message.toolCallName);\n    }\n    if (message.parentMessageId !== void 0) {\n      writer.uint32(34).string(message.parentMessageId);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCallStartEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.toolCallName = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.parentMessageId = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCallStartEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c;\n    const message = createBaseToolCallStartEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.toolCallId = (_a = object.toolCallId) != null ? _a : \"\";\n    message.toolCallName = (_b = object.toolCallName) != null ? _b : \"\";\n    message.parentMessageId = (_c = object.parentMessageId) != null ? _c : void 0;\n    return message;\n  }\n};\nfunction createBaseToolCallArgsEvent() {\n  return { baseEvent: void 0, toolCallId: \"\", delta: \"\" };\n}\nvar ToolCallArgsEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.toolCallId !== \"\") {\n      writer.uint32(18).string(message.toolCallId);\n    }\n    if (message.delta !== \"\") {\n      writer.uint32(26).string(message.delta);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCallArgsEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.delta = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCallArgsEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseToolCallArgsEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.toolCallId = (_a = object.toolCallId) != null ? _a : \"\";\n    message.delta = (_b = object.delta) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseToolCallEndEvent() {\n  return { baseEvent: void 0, toolCallId: \"\" };\n}\nvar ToolCallEndEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.toolCallId !== \"\") {\n      writer.uint32(18).string(message.toolCallId);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCallEndEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCallEndEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseToolCallEndEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.toolCallId = (_a = object.toolCallId) != null ? _a : \"\";\n    return message;\n  }\n};\nfunction createBaseStateSnapshotEvent() {\n  return { baseEvent: void 0, snapshot: void 0 };\n}\nvar StateSnapshotEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.snapshot !== void 0) {\n      Value.encode(Value.wrap(message.snapshot), writer.uint32(18).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStateSnapshotEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.snapshot = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return StateSnapshotEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStateSnapshotEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.snapshot = (_a = object.snapshot) != null ? _a : void 0;\n    return message;\n  }\n};\nfunction createBaseStateDeltaEvent() {\n  return { baseEvent: void 0, delta: [] };\n}\nvar StateDeltaEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    for (const v of message.delta) {\n      JsonPatchOperation.encode(v, writer.uint32(18).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStateDeltaEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.delta.push(JsonPatchOperation.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return StateDeltaEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStateDeltaEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.delta = ((_a = object.delta) == null ? void 0 : _a.map((e) => JsonPatchOperation.fromPartial(e))) || [];\n    return message;\n  }\n};\nfunction createBaseMessagesSnapshotEvent() {\n  return { baseEvent: void 0, messages: [] };\n}\nvar MessagesSnapshotEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    for (const v of message.messages) {\n      Message.encode(v, writer.uint32(18).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseMessagesSnapshotEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messages.push(Message.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return MessagesSnapshotEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseMessagesSnapshotEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messages = ((_a = object.messages) == null ? void 0 : _a.map((e) => Message.fromPartial(e))) || [];\n    return message;\n  }\n};\nfunction createBaseRawEvent() {\n  return { baseEvent: void 0, event: void 0, source: void 0 };\n}\nvar RawEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.event !== void 0) {\n      Value.encode(Value.wrap(message.event), writer.uint32(18).fork()).join();\n    }\n    if (message.source !== void 0) {\n      writer.uint32(26).string(message.source);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseRawEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.event = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.source = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return RawEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseRawEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.event = (_a = object.event) != null ? _a : void 0;\n    message.source = (_b = object.source) != null ? _b : void 0;\n    return message;\n  }\n};\nfunction createBaseCustomEvent() {\n  return { baseEvent: void 0, name: \"\", value: void 0 };\n}\nvar CustomEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.name !== \"\") {\n      writer.uint32(18).string(message.name);\n    }\n    if (message.value !== void 0) {\n      Value.encode(Value.wrap(message.value), writer.uint32(26).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseCustomEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.name = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.value = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return CustomEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseCustomEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.name = (_a = object.name) != null ? _a : \"\";\n    message.value = (_b = object.value) != null ? _b : void 0;\n    return message;\n  }\n};\nfunction createBaseRunStartedEvent() {\n  return { baseEvent: void 0, threadId: \"\", runId: \"\" };\n}\nvar RunStartedEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.threadId !== \"\") {\n      writer.uint32(18).string(message.threadId);\n    }\n    if (message.runId !== \"\") {\n      writer.uint32(26).string(message.runId);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseRunStartedEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.threadId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.runId = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return RunStartedEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseRunStartedEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.threadId = (_a = object.threadId) != null ? _a : \"\";\n    message.runId = (_b = object.runId) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseRunFinishedEvent() {\n  return { baseEvent: void 0, threadId: \"\", runId: \"\", result: void 0 };\n}\nvar RunFinishedEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.threadId !== \"\") {\n      writer.uint32(18).string(message.threadId);\n    }\n    if (message.runId !== \"\") {\n      writer.uint32(26).string(message.runId);\n    }\n    if (message.result !== void 0) {\n      Value.encode(Value.wrap(message.result), writer.uint32(34).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseRunFinishedEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.threadId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.runId = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.result = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return RunFinishedEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c;\n    const message = createBaseRunFinishedEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.threadId = (_a = object.threadId) != null ? _a : \"\";\n    message.runId = (_b = object.runId) != null ? _b : \"\";\n    message.result = (_c = object.result) != null ? _c : void 0;\n    return message;\n  }\n};\nfunction createBaseRunErrorEvent() {\n  return { baseEvent: void 0, code: void 0, message: \"\" };\n}\nvar RunErrorEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.code !== void 0) {\n      writer.uint32(18).string(message.code);\n    }\n    if (message.message !== \"\") {\n      writer.uint32(26).string(message.message);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseRunErrorEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.code = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.message = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return RunErrorEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseRunErrorEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.code = (_a = object.code) != null ? _a : void 0;\n    message.message = (_b = object.message) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseStepStartedEvent() {\n  return { baseEvent: void 0, stepName: \"\" };\n}\nvar StepStartedEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.stepName !== \"\") {\n      writer.uint32(18).string(message.stepName);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStepStartedEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.stepName = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return StepStartedEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStepStartedEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.stepName = (_a = object.stepName) != null ? _a : \"\";\n    return message;\n  }\n};\nfunction createBaseStepFinishedEvent() {\n  return { baseEvent: void 0, stepName: \"\" };\n}\nvar StepFinishedEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.stepName !== \"\") {\n      writer.uint32(18).string(message.stepName);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStepFinishedEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.stepName = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return StepFinishedEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStepFinishedEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.stepName = (_a = object.stepName) != null ? _a : \"\";\n    return message;\n  }\n};\nfunction createBaseTextMessageChunkEvent() {\n  return { baseEvent: void 0, messageId: void 0, role: void 0, delta: void 0 };\n}\nvar TextMessageChunkEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.messageId !== void 0) {\n      writer.uint32(18).string(message.messageId);\n    }\n    if (message.role !== void 0) {\n      writer.uint32(26).string(message.role);\n    }\n    if (message.delta !== void 0) {\n      writer.uint32(34).string(message.delta);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseTextMessageChunkEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messageId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.role = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.delta = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return TextMessageChunkEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c;\n    const message = createBaseTextMessageChunkEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messageId = (_a = object.messageId) != null ? _a : void 0;\n    message.role = (_b = object.role) != null ? _b : void 0;\n    message.delta = (_c = object.delta) != null ? _c : void 0;\n    return message;\n  }\n};\nfunction createBaseToolCallChunkEvent() {\n  return {\n    baseEvent: void 0,\n    toolCallId: void 0,\n    toolCallName: void 0,\n    parentMessageId: void 0,\n    delta: void 0\n  };\n}\nvar ToolCallChunkEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.toolCallId !== void 0) {\n      writer.uint32(18).string(message.toolCallId);\n    }\n    if (message.toolCallName !== void 0) {\n      writer.uint32(26).string(message.toolCallName);\n    }\n    if (message.parentMessageId !== void 0) {\n      writer.uint32(34).string(message.parentMessageId);\n    }\n    if (message.delta !== void 0) {\n      writer.uint32(42).string(message.delta);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCallChunkEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.toolCallName = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.parentMessageId = reader.string();\n          continue;\n        }\n        case 5: {\n          if (tag !== 42) {\n            break;\n          }\n          message.delta = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCallChunkEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c, _d;\n    const message = createBaseToolCallChunkEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.toolCallId = (_a = object.toolCallId) != null ? _a : void 0;\n    message.toolCallName = (_b = object.toolCallName) != null ? _b : void 0;\n    message.parentMessageId = (_c = object.parentMessageId) != null ? _c : void 0;\n    message.delta = (_d = object.delta) != null ? _d : void 0;\n    return message;\n  }\n};\nfunction createBaseEvent() {\n  return {\n    textMessageStart: void 0,\n    textMessageContent: void 0,\n    textMessageEnd: void 0,\n    toolCallStart: void 0,\n    toolCallArgs: void 0,\n    toolCallEnd: void 0,\n    stateSnapshot: void 0,\n    stateDelta: void 0,\n    messagesSnapshot: void 0,\n    raw: void 0,\n    custom: void 0,\n    runStarted: void 0,\n    runFinished: void 0,\n    runError: void 0,\n    stepStarted: void 0,\n    stepFinished: void 0,\n    textMessageChunk: void 0,\n    toolCallChunk: void 0\n  };\n}\nvar Event = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.textMessageStart !== void 0) {\n      TextMessageStartEvent.encode(message.textMessageStart, writer.uint32(10).fork()).join();\n    }\n    if (message.textMessageContent !== void 0) {\n      TextMessageContentEvent.encode(message.textMessageContent, writer.uint32(18).fork()).join();\n    }\n    if (message.textMessageEnd !== void 0) {\n      TextMessageEndEvent.encode(message.textMessageEnd, writer.uint32(26).fork()).join();\n    }\n    if (message.toolCallStart !== void 0) {\n      ToolCallStartEvent.encode(message.toolCallStart, writer.uint32(34).fork()).join();\n    }\n    if (message.toolCallArgs !== void 0) {\n      ToolCallArgsEvent.encode(message.toolCallArgs, writer.uint32(42).fork()).join();\n    }\n    if (message.toolCallEnd !== void 0) {\n      ToolCallEndEvent.encode(message.toolCallEnd, writer.uint32(50).fork()).join();\n    }\n    if (message.stateSnapshot !== void 0) {\n      StateSnapshotEvent.encode(message.stateSnapshot, writer.uint32(58).fork()).join();\n    }\n    if (message.stateDelta !== void 0) {\n      StateDeltaEvent.encode(message.stateDelta, writer.uint32(66).fork()).join();\n    }\n    if (message.messagesSnapshot !== void 0) {\n      MessagesSnapshotEvent.encode(message.messagesSnapshot, writer.uint32(74).fork()).join();\n    }\n    if (message.raw !== void 0) {\n      RawEvent.encode(message.raw, writer.uint32(82).fork()).join();\n    }\n    if (message.custom !== void 0) {\n      CustomEvent.encode(message.custom, writer.uint32(90).fork()).join();\n    }\n    if (message.runStarted !== void 0) {\n      RunStartedEvent.encode(message.runStarted, writer.uint32(98).fork()).join();\n    }\n    if (message.runFinished !== void 0) {\n      RunFinishedEvent.encode(message.runFinished, writer.uint32(106).fork()).join();\n    }\n    if (message.runError !== void 0) {\n      RunErrorEvent.encode(message.runError, writer.uint32(114).fork()).join();\n    }\n    if (message.stepStarted !== void 0) {\n      StepStartedEvent.encode(message.stepStarted, writer.uint32(122).fork()).join();\n    }\n    if (message.stepFinished !== void 0) {\n      StepFinishedEvent.encode(message.stepFinished, writer.uint32(130).fork()).join();\n    }\n    if (message.textMessageChunk !== void 0) {\n      TextMessageChunkEvent.encode(message.textMessageChunk, writer.uint32(138).fork()).join();\n    }\n    if (message.toolCallChunk !== void 0) {\n      ToolCallChunkEvent.encode(message.toolCallChunk, writer.uint32(146).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.textMessageStart = TextMessageStartEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.textMessageContent = TextMessageContentEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.textMessageEnd = TextMessageEndEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.toolCallStart = ToolCallStartEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 5: {\n          if (tag !== 42) {\n            break;\n          }\n          message.toolCallArgs = ToolCallArgsEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 6: {\n          if (tag !== 50) {\n            break;\n          }\n          message.toolCallEnd = ToolCallEndEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 7: {\n          if (tag !== 58) {\n            break;\n          }\n          message.stateSnapshot = StateSnapshotEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 8: {\n          if (tag !== 66) {\n            break;\n          }\n          message.stateDelta = StateDeltaEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 9: {\n          if (tag !== 74) {\n            break;\n          }\n          message.messagesSnapshot = MessagesSnapshotEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 10: {\n          if (tag !== 82) {\n            break;\n          }\n          message.raw = RawEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 11: {\n          if (tag !== 90) {\n            break;\n          }\n          message.custom = CustomEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 12: {\n          if (tag !== 98) {\n            break;\n          }\n          message.runStarted = RunStartedEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 13: {\n          if (tag !== 106) {\n            break;\n          }\n          message.runFinished = RunFinishedEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 14: {\n          if (tag !== 114) {\n            break;\n          }\n          message.runError = RunErrorEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 15: {\n          if (tag !== 122) {\n            break;\n          }\n          message.stepStarted = StepStartedEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 16: {\n          if (tag !== 130) {\n            break;\n          }\n          message.stepFinished = StepFinishedEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 17: {\n          if (tag !== 138) {\n            break;\n          }\n          message.textMessageChunk = TextMessageChunkEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 18: {\n          if (tag !== 146) {\n            break;\n          }\n          message.toolCallChunk = ToolCallChunkEvent.decode(reader, reader.uint32());\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Event.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    const message = createBaseEvent();\n    message.textMessageStart = object.textMessageStart !== void 0 && object.textMessageStart !== null ? TextMessageStartEvent.fromPartial(object.textMessageStart) : void 0;\n    message.textMessageContent = object.textMessageContent !== void 0 && object.textMessageContent !== null ? TextMessageContentEvent.fromPartial(object.textMessageContent) : void 0;\n    message.textMessageEnd = object.textMessageEnd !== void 0 && object.textMessageEnd !== null ? TextMessageEndEvent.fromPartial(object.textMessageEnd) : void 0;\n    message.toolCallStart = object.toolCallStart !== void 0 && object.toolCallStart !== null ? ToolCallStartEvent.fromPartial(object.toolCallStart) : void 0;\n    message.toolCallArgs = object.toolCallArgs !== void 0 && object.toolCallArgs !== null ? ToolCallArgsEvent.fromPartial(object.toolCallArgs) : void 0;\n    message.toolCallEnd = object.toolCallEnd !== void 0 && object.toolCallEnd !== null ? ToolCallEndEvent.fromPartial(object.toolCallEnd) : void 0;\n    message.stateSnapshot = object.stateSnapshot !== void 0 && object.stateSnapshot !== null ? StateSnapshotEvent.fromPartial(object.stateSnapshot) : void 0;\n    message.stateDelta = object.stateDelta !== void 0 && object.stateDelta !== null ? StateDeltaEvent.fromPartial(object.stateDelta) : void 0;\n    message.messagesSnapshot = object.messagesSnapshot !== void 0 && object.messagesSnapshot !== null ? MessagesSnapshotEvent.fromPartial(object.messagesSnapshot) : void 0;\n    message.raw = object.raw !== void 0 && object.raw !== null ? RawEvent.fromPartial(object.raw) : void 0;\n    message.custom = object.custom !== void 0 && object.custom !== null ? CustomEvent.fromPartial(object.custom) : void 0;\n    message.runStarted = object.runStarted !== void 0 && object.runStarted !== null ? RunStartedEvent.fromPartial(object.runStarted) : void 0;\n    message.runFinished = object.runFinished !== void 0 && object.runFinished !== null ? RunFinishedEvent.fromPartial(object.runFinished) : void 0;\n    message.runError = object.runError !== void 0 && object.runError !== null ? RunErrorEvent.fromPartial(object.runError) : void 0;\n    message.stepStarted = object.stepStarted !== void 0 && object.stepStarted !== null ? StepStartedEvent.fromPartial(object.stepStarted) : void 0;\n    message.stepFinished = object.stepFinished !== void 0 && object.stepFinished !== null ? StepFinishedEvent.fromPartial(object.stepFinished) : void 0;\n    message.textMessageChunk = object.textMessageChunk !== void 0 && object.textMessageChunk !== null ? TextMessageChunkEvent.fromPartial(object.textMessageChunk) : void 0;\n    message.toolCallChunk = object.toolCallChunk !== void 0 && object.toolCallChunk !== null ? ToolCallChunkEvent.fromPartial(object.toolCallChunk) : void 0;\n    return message;\n  }\n};\nfunction longToNumber(int64) {\n  const num = globalThis.Number(int64.toString());\n  if (num > globalThis.Number.MAX_SAFE_INTEGER) {\n    throw new globalThis.Error(\"Value is larger than Number.MAX_SAFE_INTEGER\");\n  }\n  if (num < globalThis.Number.MIN_SAFE_INTEGER) {\n    throw new globalThis.Error(\"Value is smaller than Number.MIN_SAFE_INTEGER\");\n  }\n  return num;\n}\n\n// src/proto.ts\nfunction toCamelCase(str) {\n  return str.toLowerCase().replace(/_([a-z])/g, (_, letter) => letter.toUpperCase());\n}\nfunction encode(event) {\n  const oneofField = toCamelCase(event.type);\n  const { type, timestamp, rawEvent, ...rest } = event;\n  if (type === _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT) {\n    rest.messages = rest.messages.map((message) => {\n      const untypedMessage = message;\n      if (untypedMessage.toolCalls === void 0) {\n        return { ...message, toolCalls: [] };\n      }\n      return message;\n    });\n  }\n  if (type === _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA) {\n    rest.delta = rest.delta.map((operation) => ({\n      ...operation,\n      op: JsonPatchOperationType[operation.op.toUpperCase()]\n    }));\n  }\n  const eventMessage = {\n    [oneofField]: {\n      baseEvent: {\n        type: EventType[event.type],\n        timestamp,\n        rawEvent\n      },\n      ...rest\n    }\n  };\n  return Event.encode(eventMessage).finish();\n}\nfunction decode(data) {\n  var _a;\n  const event = Event.decode(data);\n  const decoded = Object.values(event).find((value) => value !== void 0);\n  if (!decoded) {\n    throw new Error(\"Invalid event\");\n  }\n  decoded.type = EventType[decoded.baseEvent.type];\n  decoded.timestamp = decoded.baseEvent.timestamp;\n  decoded.rawEvent = decoded.baseEvent.rawEvent;\n  if (decoded.type === _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT) {\n    for (const message of decoded.messages) {\n      const untypedMessage = message;\n      if (((_a = untypedMessage.toolCalls) == null ? void 0 : _a.length) === 0) {\n        untypedMessage.toolCalls = void 0;\n      }\n    }\n  }\n  if (decoded.type === _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA) {\n    for (const operation of decoded.delta) {\n      operation.op = JsonPatchOperationType[operation.op].toLowerCase();\n      Object.keys(operation).forEach((key) => {\n        if (operation[key] === void 0) {\n          delete operation[key];\n        }\n      });\n    }\n  }\n  Object.keys(decoded).forEach((key) => {\n    if (decoded[key] === void 0) {\n      delete decoded[key];\n    }\n  });\n  return _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventSchemas.parse(decoded);\n}\n\n// src/index.ts\nvar AGUI_MEDIA_TYPE = \"application/vnd.ag-ui.event+proto\";\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL3Byb3RvL2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDb0U7O0FBRXBFO0FBQ3VHOztBQUV2RztBQUNxRTtBQUNyRTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFZO0FBQzNDO0FBQ0E7QUFDQSxvQ0FBb0MsWUFBWTtBQUNoRDtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBLG9DQUFvQyxpRUFBWSxlQUFlLGlFQUFZO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esc0RBQXNEO0FBQ3RELEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSwwRUFBMEU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQVk7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQVksZUFBZSxpRUFBWTtBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esa0VBQWtFO0FBQ2xFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixpRUFBWTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLG9DQUFvQyxpRUFBWSxlQUFlLGlFQUFZO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLHFEQUFxRDtBQUNyRCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLCtCQUErQixpRUFBWTtB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O0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVBQWE7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EscUVBQXFFO0FBQ3JFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVBQWE7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsdUVBQXVFO0FBQ3ZFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVB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QUFDeEQsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQWEsZUFBZSxpRUFBYTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSwyREFBMkQ7QUFDM0QsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQWEsZUFBZSxpRUFBYTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSwrREFBK0Q7QUFDL0QsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQWEsZUFBZSxpRUFBYTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLGdFQUFnRTtBQUNoRSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVBQWE7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsNkRBQTZEO0FBQzdELEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVBQWE7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLGdFQUFnRTtBQUNoRSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQWEsZUFBZSxpRUFBYTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsaUVBQWlFO0FBQ2pFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLCtCQUErQixpRUFBYTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLG9DQUFvQyxpRUFBYSxlQUFlLGlFQUFhO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EscUVBQXFFO0FBQ3JFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVBQWE7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLGtFQUFrRTtBQUNsRSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQWEsZUFBZSxpRUFBYTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxxREFBcUQ7QUFDckQsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLHFDQUFxQztBQUMvQyxlQUFlLGtEQUFVO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsZUFBZSxrREFBVTtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGtEQUFVO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGtEQUFVO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsU0FBUyxxREFBWTtBQUNyQjs7QUFFQTtBQUNBO0FBS0U7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL3NhY2hpbi9wcm9qZWN0cy9maW5hbmNlLWFwcC9mcm9udGVuZC9ub2RlX21vZHVsZXMvQGFnLXVpL3Byb3RvL2Rpc3QvaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9wcm90by50c1xuaW1wb3J0IHsgRXZlbnRTY2hlbWFzLCBFdmVudFR5cGUgYXMgRXZlbnRUeXBlMiB9IGZyb20gXCJAYWctdWkvY29yZVwiO1xuXG4vLyBzcmMvZ2VuZXJhdGVkL2V2ZW50cy50c1xuaW1wb3J0IHsgQmluYXJ5UmVhZGVyIGFzIEJpbmFyeVJlYWRlcjQsIEJpbmFyeVdyaXRlciBhcyBCaW5hcnlXcml0ZXI0IH0gZnJvbSBcIkBidWZidWlsZC9wcm90b2J1Zi93aXJlXCI7XG5cbi8vIHNyYy9nZW5lcmF0ZWQvZ29vZ2xlL3Byb3RvYnVmL3N0cnVjdC50c1xuaW1wb3J0IHsgQmluYXJ5UmVhZGVyLCBCaW5hcnlXcml0ZXIgfSBmcm9tIFwiQGJ1ZmJ1aWxkL3Byb3RvYnVmL3dpcmVcIjtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VTdHJ1Y3QoKSB7XG4gIHJldHVybiB7IGZpZWxkczoge30gfTtcbn1cbnZhciBTdHJ1Y3QgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyKCkpIHtcbiAgICBPYmplY3QuZW50cmllcyhtZXNzYWdlLmZpZWxkcykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICBpZiAodmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgICBTdHJ1Y3RfRmllbGRzRW50cnkuZW5jb2RlKHsga2V5LCB2YWx1ZSB9LCB3cml0ZXIudWludDMyKDEwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyKGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlU3RydWN0KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgZW50cnkxID0gU3RydWN0X0ZpZWxkc0VudHJ5LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgaWYgKGVudHJ5MS52YWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBtZXNzYWdlLmZpZWxkc1tlbnRyeTEua2V5XSA9IGVudHJ5MS52YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBTdHJ1Y3QuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlU3RydWN0KCk7XG4gICAgbWVzc2FnZS5maWVsZHMgPSBPYmplY3QuZW50cmllcygoX2EgPSBvYmplY3QuZmllbGRzKSAhPSBudWxsID8gX2EgOiB7fSkucmVkdWNlKFxuICAgICAgKGFjYywgW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgYWNjW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfSxcbiAgICAgIHt9XG4gICAgKTtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgd3JhcChvYmplY3QpIHtcbiAgICBjb25zdCBzdHJ1Y3QgPSBjcmVhdGVCYXNlU3RydWN0KCk7XG4gICAgaWYgKG9iamVjdCAhPT0gdm9pZCAwKSB7XG4gICAgICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhvYmplY3QpKSB7XG4gICAgICAgIHN0cnVjdC5maWVsZHNba2V5XSA9IG9iamVjdFtrZXldO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3RydWN0O1xuICB9LFxuICB1bndyYXAobWVzc2FnZSkge1xuICAgIGNvbnN0IG9iamVjdCA9IHt9O1xuICAgIGlmIChtZXNzYWdlLmZpZWxkcykge1xuICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMobWVzc2FnZS5maWVsZHMpKSB7XG4gICAgICAgIG9iamVjdFtrZXldID0gbWVzc2FnZS5maWVsZHNba2V5XTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG9iamVjdDtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VTdHJ1Y3RfRmllbGRzRW50cnkoKSB7XG4gIHJldHVybiB7IGtleTogXCJcIiwgdmFsdWU6IHZvaWQgMCB9O1xufVxudmFyIFN0cnVjdF9GaWVsZHNFbnRyeSA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXIoKSkge1xuICAgIGlmIChtZXNzYWdlLmtleSAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxMCkuc3RyaW5nKG1lc3NhZ2Uua2V5KTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgVmFsdWUuZW5jb2RlKFZhbHVlLndyYXAobWVzc2FnZS52YWx1ZSksIHdyaXRlci51aW50MzIoMTgpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyKGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlU3RydWN0X0ZpZWxkc0VudHJ5KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5rZXkgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnZhbHVlID0gVmFsdWUudW53cmFwKFZhbHVlLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gU3RydWN0X0ZpZWxkc0VudHJ5LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VTdHJ1Y3RfRmllbGRzRW50cnkoKTtcbiAgICBtZXNzYWdlLmtleSA9IChfYSA9IG9iamVjdC5rZXkpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgbWVzc2FnZS52YWx1ZSA9IChfYiA9IG9iamVjdC52YWx1ZSkgIT0gbnVsbCA/IF9iIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVZhbHVlKCkge1xuICByZXR1cm4ge1xuICAgIG51bGxWYWx1ZTogdm9pZCAwLFxuICAgIG51bWJlclZhbHVlOiB2b2lkIDAsXG4gICAgc3RyaW5nVmFsdWU6IHZvaWQgMCxcbiAgICBib29sVmFsdWU6IHZvaWQgMCxcbiAgICBzdHJ1Y3RWYWx1ZTogdm9pZCAwLFxuICAgIGxpc3RWYWx1ZTogdm9pZCAwXG4gIH07XG59XG52YXIgVmFsdWUgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyKCkpIHtcbiAgICBpZiAobWVzc2FnZS5udWxsVmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMig4KS5pbnQzMihtZXNzYWdlLm51bGxWYWx1ZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLm51bWJlclZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTcpLmRvdWJsZShtZXNzYWdlLm51bWJlclZhbHVlKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2Uuc3RyaW5nVmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigyNikuc3RyaW5nKG1lc3NhZ2Uuc3RyaW5nVmFsdWUpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5ib29sVmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigzMikuYm9vbChtZXNzYWdlLmJvb2xWYWx1ZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnN0cnVjdFZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgIFN0cnVjdC5lbmNvZGUoU3RydWN0LndyYXAobWVzc2FnZS5zdHJ1Y3RWYWx1ZSksIHdyaXRlci51aW50MzIoNDIpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5saXN0VmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgTGlzdFZhbHVlLmVuY29kZShMaXN0VmFsdWUud3JhcChtZXNzYWdlLmxpc3RWYWx1ZSksIHdyaXRlci51aW50MzIoNTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyKGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVmFsdWUoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubnVsbFZhbHVlID0gcmVhZGVyLmludDMyKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTcpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLm51bWJlclZhbHVlID0gcmVhZGVyLmRvdWJsZSgpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5zdHJpbmdWYWx1ZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDQ6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAzMikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYm9vbFZhbHVlID0gcmVhZGVyLmJvb2woKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDU6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA0Mikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uuc3RydWN0VmFsdWUgPSBTdHJ1Y3QudW53cmFwKFN0cnVjdC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDY6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA1MCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubGlzdFZhbHVlID0gTGlzdFZhbHVlLnVud3JhcChMaXN0VmFsdWUuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBWYWx1ZS5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZjtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVZhbHVlKCk7XG4gICAgbWVzc2FnZS5udWxsVmFsdWUgPSAoX2EgPSBvYmplY3QubnVsbFZhbHVlKSAhPSBudWxsID8gX2EgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5udW1iZXJWYWx1ZSA9IChfYiA9IG9iamVjdC5udW1iZXJWYWx1ZSkgIT0gbnVsbCA/IF9iIDogdm9pZCAwO1xuICAgIG1lc3NhZ2Uuc3RyaW5nVmFsdWUgPSAoX2MgPSBvYmplY3Quc3RyaW5nVmFsdWUpICE9IG51bGwgPyBfYyA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLmJvb2xWYWx1ZSA9IChfZCA9IG9iamVjdC5ib29sVmFsdWUpICE9IG51bGwgPyBfZCA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnN0cnVjdFZhbHVlID0gKF9lID0gb2JqZWN0LnN0cnVjdFZhbHVlKSAhPSBudWxsID8gX2UgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5saXN0VmFsdWUgPSAoX2YgPSBvYmplY3QubGlzdFZhbHVlKSAhPSBudWxsID8gX2YgOiB2b2lkIDA7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIHdyYXAodmFsdWUpIHtcbiAgICBjb25zdCByZXN1bHQgPSBjcmVhdGVCYXNlVmFsdWUoKTtcbiAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgIHJlc3VsdC5udWxsVmFsdWUgPSAwIC8qIE5VTExfVkFMVUUgKi87XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09IFwiYm9vbGVhblwiKSB7XG4gICAgICByZXN1bHQuYm9vbFZhbHVlID0gdmFsdWU7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIHJlc3VsdC5udW1iZXJWYWx1ZSA9IHZhbHVlO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICByZXN1bHQuc3RyaW5nVmFsdWUgPSB2YWx1ZTtcbiAgICB9IGVsc2UgaWYgKGdsb2JhbFRoaXMuQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgIHJlc3VsdC5saXN0VmFsdWUgPSB2YWx1ZTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgcmVzdWx0LnN0cnVjdFZhbHVlID0gdmFsdWU7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHRocm93IG5ldyBnbG9iYWxUaGlzLkVycm9yKFwiVW5zdXBwb3J0ZWQgYW55IHZhbHVlIHR5cGU6IFwiICsgdHlwZW9mIHZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSxcbiAgdW53cmFwKG1lc3NhZ2UpIHtcbiAgICBpZiAobWVzc2FnZS5zdHJpbmdWYWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICByZXR1cm4gbWVzc2FnZS5zdHJpbmdWYWx1ZTtcbiAgICB9IGVsc2UgaWYgKChtZXNzYWdlID09IG51bGwgPyB2b2lkIDAgOiBtZXNzYWdlLm51bWJlclZhbHVlKSAhPT0gdm9pZCAwKSB7XG4gICAgICByZXR1cm4gbWVzc2FnZS5udW1iZXJWYWx1ZTtcbiAgICB9IGVsc2UgaWYgKChtZXNzYWdlID09IG51bGwgPyB2b2lkIDAgOiBtZXNzYWdlLmJvb2xWYWx1ZSkgIT09IHZvaWQgMCkge1xuICAgICAgcmV0dXJuIG1lc3NhZ2UuYm9vbFZhbHVlO1xuICAgIH0gZWxzZSBpZiAoKG1lc3NhZ2UgPT0gbnVsbCA/IHZvaWQgMCA6IG1lc3NhZ2Uuc3RydWN0VmFsdWUpICE9PSB2b2lkIDApIHtcbiAgICAgIHJldHVybiBtZXNzYWdlLnN0cnVjdFZhbHVlO1xuICAgIH0gZWxzZSBpZiAoKG1lc3NhZ2UgPT0gbnVsbCA/IHZvaWQgMCA6IG1lc3NhZ2UubGlzdFZhbHVlKSAhPT0gdm9pZCAwKSB7XG4gICAgICByZXR1cm4gbWVzc2FnZS5saXN0VmFsdWU7XG4gICAgfSBlbHNlIGlmICgobWVzc2FnZSA9PSBudWxsID8gdm9pZCAwIDogbWVzc2FnZS5udWxsVmFsdWUpICE9PSB2b2lkIDApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gdm9pZCAwO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZUxpc3RWYWx1ZSgpIHtcbiAgcmV0dXJuIHsgdmFsdWVzOiBbXSB9O1xufVxudmFyIExpc3RWYWx1ZSA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXIoKSkge1xuICAgIGZvciAoY29uc3QgdiBvZiBtZXNzYWdlLnZhbHVlcykge1xuICAgICAgVmFsdWUuZW5jb2RlKFZhbHVlLndyYXAodiksIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyKGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlTGlzdFZhbHVlKCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS52YWx1ZXMucHVzaChWYWx1ZS51bndyYXAoVmFsdWUuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gTGlzdFZhbHVlLmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZUxpc3RWYWx1ZSgpO1xuICAgIG1lc3NhZ2UudmFsdWVzID0gKChfYSA9IG9iamVjdC52YWx1ZXMpID09IG51bGwgPyB2b2lkIDAgOiBfYS5tYXAoKGUpID0+IGUpKSB8fCBbXTtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgd3JhcChhcnJheSkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGNyZWF0ZUJhc2VMaXN0VmFsdWUoKTtcbiAgICByZXN1bHQudmFsdWVzID0gYXJyYXkgIT0gbnVsbCA/IGFycmF5IDogW107XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSxcbiAgdW53cmFwKG1lc3NhZ2UpIHtcbiAgICBpZiAoKG1lc3NhZ2UgPT0gbnVsbCA/IHZvaWQgMCA6IG1lc3NhZ2UuaGFzT3duUHJvcGVydHkoXCJ2YWx1ZXNcIikpICYmIGdsb2JhbFRoaXMuQXJyYXkuaXNBcnJheShtZXNzYWdlLnZhbHVlcykpIHtcbiAgICAgIHJldHVybiBtZXNzYWdlLnZhbHVlcztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuICB9XG59O1xuXG4vLyBzcmMvZ2VuZXJhdGVkL3BhdGNoLnRzXG5pbXBvcnQgeyBCaW5hcnlSZWFkZXIgYXMgQmluYXJ5UmVhZGVyMiwgQmluYXJ5V3JpdGVyIGFzIEJpbmFyeVdyaXRlcjIgfSBmcm9tIFwiQGJ1ZmJ1aWxkL3Byb3RvYnVmL3dpcmVcIjtcbnZhciBKc29uUGF0Y2hPcGVyYXRpb25UeXBlID0gLyogQF9fUFVSRV9fICovICgoSnNvblBhdGNoT3BlcmF0aW9uVHlwZTIpID0+IHtcbiAgSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbXCJBRERcIl0gPSAwXSA9IFwiQUREXCI7XG4gIEpzb25QYXRjaE9wZXJhdGlvblR5cGUyW0pzb25QYXRjaE9wZXJhdGlvblR5cGUyW1wiUkVNT1ZFXCJdID0gMV0gPSBcIlJFTU9WRVwiO1xuICBKc29uUGF0Y2hPcGVyYXRpb25UeXBlMltKc29uUGF0Y2hPcGVyYXRpb25UeXBlMltcIlJFUExBQ0VcIl0gPSAyXSA9IFwiUkVQTEFDRVwiO1xuICBKc29uUGF0Y2hPcGVyYXRpb25UeXBlMltKc29uUGF0Y2hPcGVyYXRpb25UeXBlMltcIk1PVkVcIl0gPSAzXSA9IFwiTU9WRVwiO1xuICBKc29uUGF0Y2hPcGVyYXRpb25UeXBlMltKc29uUGF0Y2hPcGVyYXRpb25UeXBlMltcIkNPUFlcIl0gPSA0XSA9IFwiQ09QWVwiO1xuICBKc29uUGF0Y2hPcGVyYXRpb25UeXBlMltKc29uUGF0Y2hPcGVyYXRpb25UeXBlMltcIlRFU1RcIl0gPSA1XSA9IFwiVEVTVFwiO1xuICBKc29uUGF0Y2hPcGVyYXRpb25UeXBlMltKc29uUGF0Y2hPcGVyYXRpb25UeXBlMltcIlVOUkVDT0dOSVpFRFwiXSA9IC0xXSA9IFwiVU5SRUNPR05JWkVEXCI7XG4gIHJldHVybiBKc29uUGF0Y2hPcGVyYXRpb25UeXBlMjtcbn0pKEpzb25QYXRjaE9wZXJhdGlvblR5cGUgfHwge30pO1xuZnVuY3Rpb24gY3JlYXRlQmFzZUpzb25QYXRjaE9wZXJhdGlvbigpIHtcbiAgcmV0dXJuIHsgb3A6IDAsIHBhdGg6IFwiXCIsIGZyb206IHZvaWQgMCwgdmFsdWU6IHZvaWQgMCB9O1xufVxudmFyIEpzb25QYXRjaE9wZXJhdGlvbiA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXIyKCkpIHtcbiAgICBpZiAobWVzc2FnZS5vcCAhPT0gMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMig4KS5pbnQzMihtZXNzYWdlLm9wKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UucGF0aCAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UucGF0aCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmZyb20gIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigyNikuc3RyaW5nKG1lc3NhZ2UuZnJvbSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgIFZhbHVlLmVuY29kZShWYWx1ZS53cmFwKG1lc3NhZ2UudmFsdWUpLCB3cml0ZXIudWludDMyKDM0KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjIgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXIyKGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlSnNvblBhdGNoT3BlcmF0aW9uKCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLm9wID0gcmVhZGVyLmludDMyKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnBhdGggPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmZyb20gPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA0OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMzQpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnZhbHVlID0gVmFsdWUudW53cmFwKFZhbHVlLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gSnNvblBhdGNoT3BlcmF0aW9uLmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYSwgX2IsIF9jLCBfZDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZUpzb25QYXRjaE9wZXJhdGlvbigpO1xuICAgIG1lc3NhZ2Uub3AgPSAoX2EgPSBvYmplY3Qub3ApICE9IG51bGwgPyBfYSA6IDA7XG4gICAgbWVzc2FnZS5wYXRoID0gKF9iID0gb2JqZWN0LnBhdGgpICE9IG51bGwgPyBfYiA6IFwiXCI7XG4gICAgbWVzc2FnZS5mcm9tID0gKF9jID0gb2JqZWN0LmZyb20pICE9IG51bGwgPyBfYyA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnZhbHVlID0gKF9kID0gb2JqZWN0LnZhbHVlKSAhPSBudWxsID8gX2QgOiB2b2lkIDA7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5cbi8vIHNyYy9nZW5lcmF0ZWQvdHlwZXMudHNcbmltcG9ydCB7IEJpbmFyeVJlYWRlciBhcyBCaW5hcnlSZWFkZXIzLCBCaW5hcnlXcml0ZXIgYXMgQmluYXJ5V3JpdGVyMyB9IGZyb20gXCJAYnVmYnVpbGQvcHJvdG9idWYvd2lyZVwiO1xuZnVuY3Rpb24gY3JlYXRlQmFzZVRvb2xDYWxsKCkge1xuICByZXR1cm4geyBpZDogXCJcIiwgdHlwZTogXCJcIiwgZnVuY3Rpb246IHZvaWQgMCB9O1xufVxudmFyIFRvb2xDYWxsID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjMoKSkge1xuICAgIGlmIChtZXNzYWdlLmlkICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDEwKS5zdHJpbmcobWVzc2FnZS5pZCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnR5cGUgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLnR5cGUpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5mdW5jdGlvbiAhPT0gdm9pZCAwKSB7XG4gICAgICBUb29sQ2FsbF9GdW5jdGlvbi5lbmNvZGUobWVzc2FnZS5mdW5jdGlvbiwgd3JpdGVyLnVpbnQzMigyNikuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXIzID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyMyhpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRvb2xDYWxsKCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5pZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudHlwZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuZnVuY3Rpb24gPSBUb29sQ2FsbF9GdW5jdGlvbi5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gVG9vbENhbGwuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRvb2xDYWxsKCk7XG4gICAgbWVzc2FnZS5pZCA9IChfYSA9IG9iamVjdC5pZCkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICBtZXNzYWdlLnR5cGUgPSAoX2IgPSBvYmplY3QudHlwZSkgIT0gbnVsbCA/IF9iIDogXCJcIjtcbiAgICBtZXNzYWdlLmZ1bmN0aW9uID0gb2JqZWN0LmZ1bmN0aW9uICE9PSB2b2lkIDAgJiYgb2JqZWN0LmZ1bmN0aW9uICE9PSBudWxsID8gVG9vbENhbGxfRnVuY3Rpb24uZnJvbVBhcnRpYWwob2JqZWN0LmZ1bmN0aW9uKSA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VUb29sQ2FsbF9GdW5jdGlvbigpIHtcbiAgcmV0dXJuIHsgbmFtZTogXCJcIiwgYXJndW1lbnRzOiBcIlwiIH07XG59XG52YXIgVG9vbENhbGxfRnVuY3Rpb24gPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyMygpKSB7XG4gICAgaWYgKG1lc3NhZ2UubmFtZSAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxMCkuc3RyaW5nKG1lc3NhZ2UubmFtZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmFyZ3VtZW50cyAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UuYXJndW1lbnRzKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjMgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXIzKGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVG9vbENhbGxfRnVuY3Rpb24oKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLm5hbWUgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmFyZ3VtZW50cyA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFRvb2xDYWxsX0Z1bmN0aW9uLmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUb29sQ2FsbF9GdW5jdGlvbigpO1xuICAgIG1lc3NhZ2UubmFtZSA9IChfYSA9IG9iamVjdC5uYW1lKSAhPSBudWxsID8gX2EgOiBcIlwiO1xuICAgIG1lc3NhZ2UuYXJndW1lbnRzID0gKF9iID0gb2JqZWN0LmFyZ3VtZW50cykgIT0gbnVsbCA/IF9iIDogXCJcIjtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VNZXNzYWdlKCkge1xuICByZXR1cm4ge1xuICAgIGlkOiBcIlwiLFxuICAgIHJvbGU6IFwiXCIsXG4gICAgY29udGVudDogdm9pZCAwLFxuICAgIG5hbWU6IHZvaWQgMCxcbiAgICB0b29sQ2FsbHM6IFtdLFxuICAgIHRvb2xDYWxsSWQ6IHZvaWQgMCxcbiAgICBlcnJvcjogdm9pZCAwXG4gIH07XG59XG52YXIgTWVzc2FnZSA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXIzKCkpIHtcbiAgICBpZiAobWVzc2FnZS5pZCAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxMCkuc3RyaW5nKG1lc3NhZ2UuaWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5yb2xlICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS5yb2xlKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UuY29udGVudCAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDI2KS5zdHJpbmcobWVzc2FnZS5jb250ZW50KTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UubmFtZSAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDM0KS5zdHJpbmcobWVzc2FnZS5uYW1lKTtcbiAgICB9XG4gICAgZm9yIChjb25zdCB2IG9mIG1lc3NhZ2UudG9vbENhbGxzKSB7XG4gICAgICBUb29sQ2FsbC5lbmNvZGUodiwgd3JpdGVyLnVpbnQzMig0MikuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRvb2xDYWxsSWQgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMig1MCkuc3RyaW5nKG1lc3NhZ2UudG9vbENhbGxJZCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmVycm9yICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoNTgpLnN0cmluZyhtZXNzYWdlLmVycm9yKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjMgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXIzKGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlTWVzc2FnZSgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuaWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnJvbGUgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmNvbnRlbnQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA0OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMzQpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLm5hbWUgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA1OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gNDIpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRvb2xDYWxscy5wdXNoKFRvb2xDYWxsLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDUwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50b29sQ2FsbElkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDU4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5lcnJvciA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIE1lc3NhZ2UuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2YsIF9nO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlTWVzc2FnZSgpO1xuICAgIG1lc3NhZ2UuaWQgPSAoX2EgPSBvYmplY3QuaWQpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgbWVzc2FnZS5yb2xlID0gKF9iID0gb2JqZWN0LnJvbGUpICE9IG51bGwgPyBfYiA6IFwiXCI7XG4gICAgbWVzc2FnZS5jb250ZW50ID0gKF9jID0gb2JqZWN0LmNvbnRlbnQpICE9IG51bGwgPyBfYyA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLm5hbWUgPSAoX2QgPSBvYmplY3QubmFtZSkgIT0gbnVsbCA/IF9kIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxzID0gKChfZSA9IG9iamVjdC50b29sQ2FsbHMpID09IG51bGwgPyB2b2lkIDAgOiBfZS5tYXAoKGUpID0+IFRvb2xDYWxsLmZyb21QYXJ0aWFsKGUpKSkgfHwgW107XG4gICAgbWVzc2FnZS50b29sQ2FsbElkID0gKF9mID0gb2JqZWN0LnRvb2xDYWxsSWQpICE9IG51bGwgPyBfZiA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLmVycm9yID0gKF9nID0gb2JqZWN0LmVycm9yKSAhPSBudWxsID8gX2cgOiB2b2lkIDA7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5cbi8vIHNyYy9nZW5lcmF0ZWQvZXZlbnRzLnRzXG52YXIgRXZlbnRUeXBlID0gLyogQF9fUFVSRV9fICovICgoRXZlbnRUeXBlMykgPT4ge1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJURVhUX01FU1NBR0VfU1RBUlRcIl0gPSAwXSA9IFwiVEVYVF9NRVNTQUdFX1NUQVJUXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlRFWFRfTUVTU0FHRV9DT05URU5UXCJdID0gMV0gPSBcIlRFWFRfTUVTU0FHRV9DT05URU5UXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlRFWFRfTUVTU0FHRV9FTkRcIl0gPSAyXSA9IFwiVEVYVF9NRVNTQUdFX0VORFwiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJUT09MX0NBTExfU1RBUlRcIl0gPSAzXSA9IFwiVE9PTF9DQUxMX1NUQVJUXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlRPT0xfQ0FMTF9BUkdTXCJdID0gNF0gPSBcIlRPT0xfQ0FMTF9BUkdTXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlRPT0xfQ0FMTF9FTkRcIl0gPSA1XSA9IFwiVE9PTF9DQUxMX0VORFwiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJTVEFURV9TTkFQU0hPVFwiXSA9IDZdID0gXCJTVEFURV9TTkFQU0hPVFwiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJTVEFURV9ERUxUQVwiXSA9IDddID0gXCJTVEFURV9ERUxUQVwiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJNRVNTQUdFU19TTkFQU0hPVFwiXSA9IDhdID0gXCJNRVNTQUdFU19TTkFQU0hPVFwiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJSQVdcIl0gPSA5XSA9IFwiUkFXXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIkNVU1RPTVwiXSA9IDEwXSA9IFwiQ1VTVE9NXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlJVTl9TVEFSVEVEXCJdID0gMTFdID0gXCJSVU5fU1RBUlRFRFwiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJSVU5fRklOSVNIRURcIl0gPSAxMl0gPSBcIlJVTl9GSU5JU0hFRFwiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJSVU5fRVJST1JcIl0gPSAxM10gPSBcIlJVTl9FUlJPUlwiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJTVEVQX1NUQVJURURcIl0gPSAxNF0gPSBcIlNURVBfU1RBUlRFRFwiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJTVEVQX0ZJTklTSEVEXCJdID0gMTVdID0gXCJTVEVQX0ZJTklTSEVEXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlVOUkVDT0dOSVpFRFwiXSA9IC0xXSA9IFwiVU5SRUNPR05JWkVEXCI7XG4gIHJldHVybiBFdmVudFR5cGUzO1xufSkoRXZlbnRUeXBlIHx8IHt9KTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VCYXNlRXZlbnQoKSB7XG4gIHJldHVybiB7IHR5cGU6IDAsIHRpbWVzdGFtcDogdm9pZCAwLCByYXdFdmVudDogdm9pZCAwIH07XG59XG52YXIgQmFzZUV2ZW50ID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjQoKSkge1xuICAgIGlmIChtZXNzYWdlLnR5cGUgIT09IDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoOCkuaW50MzIobWVzc2FnZS50eXBlKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudGltZXN0YW1wICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTYpLmludDY0KG1lc3NhZ2UudGltZXN0YW1wKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UucmF3RXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgVmFsdWUuZW5jb2RlKFZhbHVlLndyYXAobWVzc2FnZS5yYXdFdmVudCksIHdyaXRlci51aW50MzIoMjYpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VCYXNlRXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudHlwZSA9IHJlYWRlci5pbnQzMigpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50aW1lc3RhbXAgPSBsb25nVG9OdW1iZXIocmVhZGVyLmludDY0KCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5yYXdFdmVudCA9IFZhbHVlLnVud3JhcChWYWx1ZS5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIEJhc2VFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iLCBfYztcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZUJhc2VFdmVudCgpO1xuICAgIG1lc3NhZ2UudHlwZSA9IChfYSA9IG9iamVjdC50eXBlKSAhPSBudWxsID8gX2EgOiAwO1xuICAgIG1lc3NhZ2UudGltZXN0YW1wID0gKF9iID0gb2JqZWN0LnRpbWVzdGFtcCkgIT0gbnVsbCA/IF9iIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UucmF3RXZlbnQgPSAoX2MgPSBvYmplY3QucmF3RXZlbnQpICE9IG51bGwgPyBfYyA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VUZXh0TWVzc2FnZVN0YXJ0RXZlbnQoKSB7XG4gIHJldHVybiB7IGJhc2VFdmVudDogdm9pZCAwLCBtZXNzYWdlSWQ6IFwiXCIsIHJvbGU6IHZvaWQgMCB9O1xufVxudmFyIFRleHRNZXNzYWdlU3RhcnRFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLm1lc3NhZ2VJZCAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UubWVzc2FnZUlkKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2Uucm9sZSAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDI2KS5zdHJpbmcobWVzc2FnZS5yb2xlKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVGV4dE1lc3NhZ2VTdGFydEV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubWVzc2FnZUlkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5yb2xlID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gVGV4dE1lc3NhZ2VTdGFydEV2ZW50LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUZXh0TWVzc2FnZVN0YXJ0RXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UubWVzc2FnZUlkID0gKF9hID0gb2JqZWN0Lm1lc3NhZ2VJZCkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICBtZXNzYWdlLnJvbGUgPSAoX2IgPSBvYmplY3Qucm9sZSkgIT0gbnVsbCA/IF9iIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVRleHRNZXNzYWdlQ29udGVudEV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgbWVzc2FnZUlkOiBcIlwiLCBkZWx0YTogXCJcIiB9O1xufVxudmFyIFRleHRNZXNzYWdlQ29udGVudEV2ZW50ID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjQoKSkge1xuICAgIGlmIChtZXNzYWdlLmJhc2VFdmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBCYXNlRXZlbnQuZW5jb2RlKG1lc3NhZ2UuYmFzZUV2ZW50LCB3cml0ZXIudWludDMyKDEwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UubWVzc2FnZUlkICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS5tZXNzYWdlSWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5kZWx0YSAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigyNikuc3RyaW5nKG1lc3NhZ2UuZGVsdGEpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUZXh0TWVzc2FnZUNvbnRlbnRFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLm1lc3NhZ2VJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuZGVsdGEgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBUZXh0TWVzc2FnZUNvbnRlbnRFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVGV4dE1lc3NhZ2VDb250ZW50RXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UubWVzc2FnZUlkID0gKF9hID0gb2JqZWN0Lm1lc3NhZ2VJZCkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICBtZXNzYWdlLmRlbHRhID0gKF9iID0gb2JqZWN0LmRlbHRhKSAhPSBudWxsID8gX2IgOiBcIlwiO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVRleHRNZXNzYWdlRW5kRXZlbnQoKSB7XG4gIHJldHVybiB7IGJhc2VFdmVudDogdm9pZCAwLCBtZXNzYWdlSWQ6IFwiXCIgfTtcbn1cbnZhciBUZXh0TWVzc2FnZUVuZEV2ZW50ID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjQoKSkge1xuICAgIGlmIChtZXNzYWdlLmJhc2VFdmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBCYXNlRXZlbnQuZW5jb2RlKG1lc3NhZ2UuYmFzZUV2ZW50LCB3cml0ZXIudWludDMyKDEwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UubWVzc2FnZUlkICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS5tZXNzYWdlSWQpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUZXh0TWVzc2FnZUVuZEV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubWVzc2FnZUlkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gVGV4dE1lc3NhZ2VFbmRFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUZXh0TWVzc2FnZUVuZEV2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLm1lc3NhZ2VJZCA9IChfYSA9IG9iamVjdC5tZXNzYWdlSWQpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlVG9vbENhbGxTdGFydEV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgdG9vbENhbGxJZDogXCJcIiwgdG9vbENhbGxOYW1lOiBcIlwiLCBwYXJlbnRNZXNzYWdlSWQ6IHZvaWQgMCB9O1xufVxudmFyIFRvb2xDYWxsU3RhcnRFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRvb2xDYWxsSWQgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLnRvb2xDYWxsSWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50b29sQ2FsbE5hbWUgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLnRvb2xDYWxsTmFtZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnBhcmVudE1lc3NhZ2VJZCAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDM0KS5zdHJpbmcobWVzc2FnZS5wYXJlbnRNZXNzYWdlSWQpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUb29sQ2FsbFN0YXJ0RXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmJhc2VFdmVudCA9IEJhc2VFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50b29sQ2FsbElkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50b29sQ2FsbE5hbWUgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA0OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMzQpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnBhcmVudE1lc3NhZ2VJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFRvb2xDYWxsU3RhcnRFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iLCBfYztcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRvb2xDYWxsU3RhcnRFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50b29sQ2FsbElkID0gKF9hID0gb2JqZWN0LnRvb2xDYWxsSWQpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgbWVzc2FnZS50b29sQ2FsbE5hbWUgPSAoX2IgPSBvYmplY3QudG9vbENhbGxOYW1lKSAhPSBudWxsID8gX2IgOiBcIlwiO1xuICAgIG1lc3NhZ2UucGFyZW50TWVzc2FnZUlkID0gKF9jID0gb2JqZWN0LnBhcmVudE1lc3NhZ2VJZCkgIT0gbnVsbCA/IF9jIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVRvb2xDYWxsQXJnc0V2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgdG9vbENhbGxJZDogXCJcIiwgZGVsdGE6IFwiXCIgfTtcbn1cbnZhciBUb29sQ2FsbEFyZ3NFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRvb2xDYWxsSWQgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLnRvb2xDYWxsSWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5kZWx0YSAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigyNikuc3RyaW5nKG1lc3NhZ2UuZGVsdGEpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUb29sQ2FsbEFyZ3NFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRvb2xDYWxsSWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmRlbHRhID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gVG9vbENhbGxBcmdzRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRvb2xDYWxsQXJnc0V2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnRvb2xDYWxsSWQgPSAoX2EgPSBvYmplY3QudG9vbENhbGxJZCkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICBtZXNzYWdlLmRlbHRhID0gKF9iID0gb2JqZWN0LmRlbHRhKSAhPSBudWxsID8gX2IgOiBcIlwiO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVRvb2xDYWxsRW5kRXZlbnQoKSB7XG4gIHJldHVybiB7IGJhc2VFdmVudDogdm9pZCAwLCB0b29sQ2FsbElkOiBcIlwiIH07XG59XG52YXIgVG9vbENhbGxFbmRFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRvb2xDYWxsSWQgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLnRvb2xDYWxsSWQpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUb29sQ2FsbEVuZEV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudG9vbENhbGxJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFRvb2xDYWxsRW5kRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVG9vbENhbGxFbmRFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50b29sQ2FsbElkID0gKF9hID0gb2JqZWN0LnRvb2xDYWxsSWQpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlU3RhdGVTbmFwc2hvdEV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgc25hcHNob3Q6IHZvaWQgMCB9O1xufVxudmFyIFN0YXRlU25hcHNob3RFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnNuYXBzaG90ICE9PSB2b2lkIDApIHtcbiAgICAgIFZhbHVlLmVuY29kZShWYWx1ZS53cmFwKG1lc3NhZ2Uuc25hcHNob3QpLCB3cml0ZXIudWludDMyKDE4KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlU3RhdGVTbmFwc2hvdEV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uuc25hcHNob3QgPSBWYWx1ZS51bndyYXAoVmFsdWUuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBTdGF0ZVNuYXBzaG90RXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlU3RhdGVTbmFwc2hvdEV2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnNuYXBzaG90ID0gKF9hID0gb2JqZWN0LnNuYXBzaG90KSAhPSBudWxsID8gX2EgOiB2b2lkIDA7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlU3RhdGVEZWx0YUV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgZGVsdGE6IFtdIH07XG59XG52YXIgU3RhdGVEZWx0YUV2ZW50ID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjQoKSkge1xuICAgIGlmIChtZXNzYWdlLmJhc2VFdmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBCYXNlRXZlbnQuZW5jb2RlKG1lc3NhZ2UuYmFzZUV2ZW50LCB3cml0ZXIudWludDMyKDEwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgZm9yIChjb25zdCB2IG9mIG1lc3NhZ2UuZGVsdGEpIHtcbiAgICAgIEpzb25QYXRjaE9wZXJhdGlvbi5lbmNvZGUodiwgd3JpdGVyLnVpbnQzMigxOCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVN0YXRlRGVsdGFFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmRlbHRhLnB1c2goSnNvblBhdGNoT3BlcmF0aW9uLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gU3RhdGVEZWx0YUV2ZW50LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVN0YXRlRGVsdGFFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5kZWx0YSA9ICgoX2EgPSBvYmplY3QuZGVsdGEpID09IG51bGwgPyB2b2lkIDAgOiBfYS5tYXAoKGUpID0+IEpzb25QYXRjaE9wZXJhdGlvbi5mcm9tUGFydGlhbChlKSkpIHx8IFtdO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZU1lc3NhZ2VzU25hcHNob3RFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIG1lc3NhZ2VzOiBbXSB9O1xufVxudmFyIE1lc3NhZ2VzU25hcHNob3RFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGZvciAoY29uc3QgdiBvZiBtZXNzYWdlLm1lc3NhZ2VzKSB7XG4gICAgICBNZXNzYWdlLmVuY29kZSh2LCB3cml0ZXIudWludDMyKDE4KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlTWVzc2FnZXNTbmFwc2hvdEV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubWVzc2FnZXMucHVzaChNZXNzYWdlLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gTWVzc2FnZXNTbmFwc2hvdEV2ZW50LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZU1lc3NhZ2VzU25hcHNob3RFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5tZXNzYWdlcyA9ICgoX2EgPSBvYmplY3QubWVzc2FnZXMpID09IG51bGwgPyB2b2lkIDAgOiBfYS5tYXAoKGUpID0+IE1lc3NhZ2UuZnJvbVBhcnRpYWwoZSkpKSB8fCBbXTtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VSYXdFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIGV2ZW50OiB2b2lkIDAsIHNvdXJjZTogdm9pZCAwIH07XG59XG52YXIgUmF3RXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5ldmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBWYWx1ZS5lbmNvZGUoVmFsdWUud3JhcChtZXNzYWdlLmV2ZW50KSwgd3JpdGVyLnVpbnQzMigxOCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnNvdXJjZSAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDI2KS5zdHJpbmcobWVzc2FnZS5zb3VyY2UpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VSYXdFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmV2ZW50ID0gVmFsdWUudW53cmFwKFZhbHVlLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5zb3VyY2UgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBSYXdFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlUmF3RXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UuZXZlbnQgPSAoX2EgPSBvYmplY3QuZXZlbnQpICE9IG51bGwgPyBfYSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnNvdXJjZSA9IChfYiA9IG9iamVjdC5zb3VyY2UpICE9IG51bGwgPyBfYiA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VDdXN0b21FdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIG5hbWU6IFwiXCIsIHZhbHVlOiB2b2lkIDAgfTtcbn1cbnZhciBDdXN0b21FdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLm5hbWUgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLm5hbWUpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS52YWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICBWYWx1ZS5lbmNvZGUoVmFsdWUud3JhcChtZXNzYWdlLnZhbHVlKSwgd3JpdGVyLnVpbnQzMigyNikuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZUN1c3RvbUV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubmFtZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudmFsdWUgPSBWYWx1ZS51bndyYXAoVmFsdWUuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBDdXN0b21FdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlQ3VzdG9tRXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UubmFtZSA9IChfYSA9IG9iamVjdC5uYW1lKSAhPSBudWxsID8gX2EgOiBcIlwiO1xuICAgIG1lc3NhZ2UudmFsdWUgPSAoX2IgPSBvYmplY3QudmFsdWUpICE9IG51bGwgPyBfYiA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VSdW5TdGFydGVkRXZlbnQoKSB7XG4gIHJldHVybiB7IGJhc2VFdmVudDogdm9pZCAwLCB0aHJlYWRJZDogXCJcIiwgcnVuSWQ6IFwiXCIgfTtcbn1cbnZhciBSdW5TdGFydGVkRXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50aHJlYWRJZCAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UudGhyZWFkSWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5ydW5JZCAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigyNikuc3RyaW5nKG1lc3NhZ2UucnVuSWQpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VSdW5TdGFydGVkRXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmJhc2VFdmVudCA9IEJhc2VFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50aHJlYWRJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UucnVuSWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBSdW5TdGFydGVkRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVJ1blN0YXJ0ZWRFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50aHJlYWRJZCA9IChfYSA9IG9iamVjdC50aHJlYWRJZCkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICBtZXNzYWdlLnJ1bklkID0gKF9iID0gb2JqZWN0LnJ1bklkKSAhPSBudWxsID8gX2IgOiBcIlwiO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVJ1bkZpbmlzaGVkRXZlbnQoKSB7XG4gIHJldHVybiB7IGJhc2VFdmVudDogdm9pZCAwLCB0aHJlYWRJZDogXCJcIiwgcnVuSWQ6IFwiXCIsIHJlc3VsdDogdm9pZCAwIH07XG59XG52YXIgUnVuRmluaXNoZWRFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRocmVhZElkICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS50aHJlYWRJZCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnJ1bklkICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDI2KS5zdHJpbmcobWVzc2FnZS5ydW5JZCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnJlc3VsdCAhPT0gdm9pZCAwKSB7XG4gICAgICBWYWx1ZS5lbmNvZGUoVmFsdWUud3JhcChtZXNzYWdlLnJlc3VsdCksIHdyaXRlci51aW50MzIoMzQpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VSdW5GaW5pc2hlZEV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudGhyZWFkSWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnJ1bklkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNDoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDM0KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5yZXN1bHQgPSBWYWx1ZS51bndyYXAoVmFsdWUuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBSdW5GaW5pc2hlZEV2ZW50LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYSwgX2IsIF9jO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlUnVuRmluaXNoZWRFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50aHJlYWRJZCA9IChfYSA9IG9iamVjdC50aHJlYWRJZCkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICBtZXNzYWdlLnJ1bklkID0gKF9iID0gb2JqZWN0LnJ1bklkKSAhPSBudWxsID8gX2IgOiBcIlwiO1xuICAgIG1lc3NhZ2UucmVzdWx0ID0gKF9jID0gb2JqZWN0LnJlc3VsdCkgIT0gbnVsbCA/IF9jIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVJ1bkVycm9yRXZlbnQoKSB7XG4gIHJldHVybiB7IGJhc2VFdmVudDogdm9pZCAwLCBjb2RlOiB2b2lkIDAsIG1lc3NhZ2U6IFwiXCIgfTtcbn1cbnZhciBSdW5FcnJvckV2ZW50ID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjQoKSkge1xuICAgIGlmIChtZXNzYWdlLmJhc2VFdmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBCYXNlRXZlbnQuZW5jb2RlKG1lc3NhZ2UuYmFzZUV2ZW50LCB3cml0ZXIudWludDMyKDEwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UuY29kZSAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS5jb2RlKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UubWVzc2FnZSAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigyNikuc3RyaW5nKG1lc3NhZ2UubWVzc2FnZSk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVJ1bkVycm9yRXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmJhc2VFdmVudCA9IEJhc2VFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5jb2RlID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5tZXNzYWdlID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gUnVuRXJyb3JFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlUnVuRXJyb3JFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5jb2RlID0gKF9hID0gb2JqZWN0LmNvZGUpICE9IG51bGwgPyBfYSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLm1lc3NhZ2UgPSAoX2IgPSBvYmplY3QubWVzc2FnZSkgIT0gbnVsbCA/IF9iIDogXCJcIjtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VTdGVwU3RhcnRlZEV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgc3RlcE5hbWU6IFwiXCIgfTtcbn1cbnZhciBTdGVwU3RhcnRlZEV2ZW50ID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjQoKSkge1xuICAgIGlmIChtZXNzYWdlLmJhc2VFdmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBCYXNlRXZlbnQuZW5jb2RlKG1lc3NhZ2UuYmFzZUV2ZW50LCB3cml0ZXIudWludDMyKDEwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2Uuc3RlcE5hbWUgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLnN0ZXBOYW1lKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlU3RlcFN0YXJ0ZWRFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnN0ZXBOYW1lID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gU3RlcFN0YXJ0ZWRFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VTdGVwU3RhcnRlZEV2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnN0ZXBOYW1lID0gKF9hID0gb2JqZWN0LnN0ZXBOYW1lKSAhPSBudWxsID8gX2EgOiBcIlwiO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVN0ZXBGaW5pc2hlZEV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgc3RlcE5hbWU6IFwiXCIgfTtcbn1cbnZhciBTdGVwRmluaXNoZWRFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnN0ZXBOYW1lICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS5zdGVwTmFtZSk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVN0ZXBGaW5pc2hlZEV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uuc3RlcE5hbWUgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBTdGVwRmluaXNoZWRFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VTdGVwRmluaXNoZWRFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5zdGVwTmFtZSA9IChfYSA9IG9iamVjdC5zdGVwTmFtZSkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VUZXh0TWVzc2FnZUNodW5rRXZlbnQoKSB7XG4gIHJldHVybiB7IGJhc2VFdmVudDogdm9pZCAwLCBtZXNzYWdlSWQ6IHZvaWQgMCwgcm9sZTogdm9pZCAwLCBkZWx0YTogdm9pZCAwIH07XG59XG52YXIgVGV4dE1lc3NhZ2VDaHVua0V2ZW50ID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjQoKSkge1xuICAgIGlmIChtZXNzYWdlLmJhc2VFdmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBCYXNlRXZlbnQuZW5jb2RlKG1lc3NhZ2UuYmFzZUV2ZW50LCB3cml0ZXIudWludDMyKDEwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UubWVzc2FnZUlkICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLm1lc3NhZ2VJZCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnJvbGUgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigyNikuc3RyaW5nKG1lc3NhZ2Uucm9sZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmRlbHRhICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoMzQpLnN0cmluZyhtZXNzYWdlLmRlbHRhKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVGV4dE1lc3NhZ2VDaHVua0V2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubWVzc2FnZUlkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5yb2xlID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNDoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDM0KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5kZWx0YSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFRleHRNZXNzYWdlQ2h1bmtFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iLCBfYztcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRleHRNZXNzYWdlQ2h1bmtFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5tZXNzYWdlSWQgPSAoX2EgPSBvYmplY3QubWVzc2FnZUlkKSAhPSBudWxsID8gX2EgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5yb2xlID0gKF9iID0gb2JqZWN0LnJvbGUpICE9IG51bGwgPyBfYiA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLmRlbHRhID0gKF9jID0gb2JqZWN0LmRlbHRhKSAhPSBudWxsID8gX2MgOiB2b2lkIDA7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlVG9vbENhbGxDaHVua0V2ZW50KCkge1xuICByZXR1cm4ge1xuICAgIGJhc2VFdmVudDogdm9pZCAwLFxuICAgIHRvb2xDYWxsSWQ6IHZvaWQgMCxcbiAgICB0b29sQ2FsbE5hbWU6IHZvaWQgMCxcbiAgICBwYXJlbnRNZXNzYWdlSWQ6IHZvaWQgMCxcbiAgICBkZWx0YTogdm9pZCAwXG4gIH07XG59XG52YXIgVG9vbENhbGxDaHVua0V2ZW50ID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjQoKSkge1xuICAgIGlmIChtZXNzYWdlLmJhc2VFdmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBCYXNlRXZlbnQuZW5jb2RlKG1lc3NhZ2UuYmFzZUV2ZW50LCB3cml0ZXIudWludDMyKDEwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudG9vbENhbGxJZCAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS50b29sQ2FsbElkKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudG9vbENhbGxOYW1lICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLnRvb2xDYWxsTmFtZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnBhcmVudE1lc3NhZ2VJZCAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDM0KS5zdHJpbmcobWVzc2FnZS5wYXJlbnRNZXNzYWdlSWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5kZWx0YSAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDQyKS5zdHJpbmcobWVzc2FnZS5kZWx0YSk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRvb2xDYWxsQ2h1bmtFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRvb2xDYWxsSWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRvb2xDYWxsTmFtZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDQ6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAzNCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UucGFyZW50TWVzc2FnZUlkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDQyKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5kZWx0YSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFRvb2xDYWxsQ2h1bmtFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUb29sQ2FsbENodW5rRXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxJZCA9IChfYSA9IG9iamVjdC50b29sQ2FsbElkKSAhPSBudWxsID8gX2EgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50b29sQ2FsbE5hbWUgPSAoX2IgPSBvYmplY3QudG9vbENhbGxOYW1lKSAhPSBudWxsID8gX2IgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5wYXJlbnRNZXNzYWdlSWQgPSAoX2MgPSBvYmplY3QucGFyZW50TWVzc2FnZUlkKSAhPSBudWxsID8gX2MgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5kZWx0YSA9IChfZCA9IG9iamVjdC5kZWx0YSkgIT0gbnVsbCA/IF9kIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZUV2ZW50KCkge1xuICByZXR1cm4ge1xuICAgIHRleHRNZXNzYWdlU3RhcnQ6IHZvaWQgMCxcbiAgICB0ZXh0TWVzc2FnZUNvbnRlbnQ6IHZvaWQgMCxcbiAgICB0ZXh0TWVzc2FnZUVuZDogdm9pZCAwLFxuICAgIHRvb2xDYWxsU3RhcnQ6IHZvaWQgMCxcbiAgICB0b29sQ2FsbEFyZ3M6IHZvaWQgMCxcbiAgICB0b29sQ2FsbEVuZDogdm9pZCAwLFxuICAgIHN0YXRlU25hcHNob3Q6IHZvaWQgMCxcbiAgICBzdGF0ZURlbHRhOiB2b2lkIDAsXG4gICAgbWVzc2FnZXNTbmFwc2hvdDogdm9pZCAwLFxuICAgIHJhdzogdm9pZCAwLFxuICAgIGN1c3RvbTogdm9pZCAwLFxuICAgIHJ1blN0YXJ0ZWQ6IHZvaWQgMCxcbiAgICBydW5GaW5pc2hlZDogdm9pZCAwLFxuICAgIHJ1bkVycm9yOiB2b2lkIDAsXG4gICAgc3RlcFN0YXJ0ZWQ6IHZvaWQgMCxcbiAgICBzdGVwRmluaXNoZWQ6IHZvaWQgMCxcbiAgICB0ZXh0TWVzc2FnZUNodW5rOiB2b2lkIDAsXG4gICAgdG9vbENhbGxDaHVuazogdm9pZCAwXG4gIH07XG59XG52YXIgRXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UudGV4dE1lc3NhZ2VTdGFydCAhPT0gdm9pZCAwKSB7XG4gICAgICBUZXh0TWVzc2FnZVN0YXJ0RXZlbnQuZW5jb2RlKG1lc3NhZ2UudGV4dE1lc3NhZ2VTdGFydCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRleHRNZXNzYWdlQ29udGVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBUZXh0TWVzc2FnZUNvbnRlbnRFdmVudC5lbmNvZGUobWVzc2FnZS50ZXh0TWVzc2FnZUNvbnRlbnQsIHdyaXRlci51aW50MzIoMTgpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50ZXh0TWVzc2FnZUVuZCAhPT0gdm9pZCAwKSB7XG4gICAgICBUZXh0TWVzc2FnZUVuZEV2ZW50LmVuY29kZShtZXNzYWdlLnRleHRNZXNzYWdlRW5kLCB3cml0ZXIudWludDMyKDI2KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudG9vbENhbGxTdGFydCAhPT0gdm9pZCAwKSB7XG4gICAgICBUb29sQ2FsbFN0YXJ0RXZlbnQuZW5jb2RlKG1lc3NhZ2UudG9vbENhbGxTdGFydCwgd3JpdGVyLnVpbnQzMigzNCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRvb2xDYWxsQXJncyAhPT0gdm9pZCAwKSB7XG4gICAgICBUb29sQ2FsbEFyZ3NFdmVudC5lbmNvZGUobWVzc2FnZS50b29sQ2FsbEFyZ3MsIHdyaXRlci51aW50MzIoNDIpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50b29sQ2FsbEVuZCAhPT0gdm9pZCAwKSB7XG4gICAgICBUb29sQ2FsbEVuZEV2ZW50LmVuY29kZShtZXNzYWdlLnRvb2xDYWxsRW5kLCB3cml0ZXIudWludDMyKDUwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2Uuc3RhdGVTbmFwc2hvdCAhPT0gdm9pZCAwKSB7XG4gICAgICBTdGF0ZVNuYXBzaG90RXZlbnQuZW5jb2RlKG1lc3NhZ2Uuc3RhdGVTbmFwc2hvdCwgd3JpdGVyLnVpbnQzMig1OCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnN0YXRlRGVsdGEgIT09IHZvaWQgMCkge1xuICAgICAgU3RhdGVEZWx0YUV2ZW50LmVuY29kZShtZXNzYWdlLnN0YXRlRGVsdGEsIHdyaXRlci51aW50MzIoNjYpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5tZXNzYWdlc1NuYXBzaG90ICE9PSB2b2lkIDApIHtcbiAgICAgIE1lc3NhZ2VzU25hcHNob3RFdmVudC5lbmNvZGUobWVzc2FnZS5tZXNzYWdlc1NuYXBzaG90LCB3cml0ZXIudWludDMyKDc0KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UucmF3ICE9PSB2b2lkIDApIHtcbiAgICAgIFJhd0V2ZW50LmVuY29kZShtZXNzYWdlLnJhdywgd3JpdGVyLnVpbnQzMig4MikuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmN1c3RvbSAhPT0gdm9pZCAwKSB7XG4gICAgICBDdXN0b21FdmVudC5lbmNvZGUobWVzc2FnZS5jdXN0b20sIHdyaXRlci51aW50MzIoOTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5ydW5TdGFydGVkICE9PSB2b2lkIDApIHtcbiAgICAgIFJ1blN0YXJ0ZWRFdmVudC5lbmNvZGUobWVzc2FnZS5ydW5TdGFydGVkLCB3cml0ZXIudWludDMyKDk4KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UucnVuRmluaXNoZWQgIT09IHZvaWQgMCkge1xuICAgICAgUnVuRmluaXNoZWRFdmVudC5lbmNvZGUobWVzc2FnZS5ydW5GaW5pc2hlZCwgd3JpdGVyLnVpbnQzMigxMDYpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5ydW5FcnJvciAhPT0gdm9pZCAwKSB7XG4gICAgICBSdW5FcnJvckV2ZW50LmVuY29kZShtZXNzYWdlLnJ1bkVycm9yLCB3cml0ZXIudWludDMyKDExNCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnN0ZXBTdGFydGVkICE9PSB2b2lkIDApIHtcbiAgICAgIFN0ZXBTdGFydGVkRXZlbnQuZW5jb2RlKG1lc3NhZ2Uuc3RlcFN0YXJ0ZWQsIHdyaXRlci51aW50MzIoMTIyKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2Uuc3RlcEZpbmlzaGVkICE9PSB2b2lkIDApIHtcbiAgICAgIFN0ZXBGaW5pc2hlZEV2ZW50LmVuY29kZShtZXNzYWdlLnN0ZXBGaW5pc2hlZCwgd3JpdGVyLnVpbnQzMigxMzApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50ZXh0TWVzc2FnZUNodW5rICE9PSB2b2lkIDApIHtcbiAgICAgIFRleHRNZXNzYWdlQ2h1bmtFdmVudC5lbmNvZGUobWVzc2FnZS50ZXh0TWVzc2FnZUNodW5rLCB3cml0ZXIudWludDMyKDEzOCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRvb2xDYWxsQ2h1bmsgIT09IHZvaWQgMCkge1xuICAgICAgVG9vbENhbGxDaHVua0V2ZW50LmVuY29kZShtZXNzYWdlLnRvb2xDYWxsQ2h1bmssIHdyaXRlci51aW50MzIoMTQ2KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlRXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRleHRNZXNzYWdlU3RhcnQgPSBUZXh0TWVzc2FnZVN0YXJ0RXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudGV4dE1lc3NhZ2VDb250ZW50ID0gVGV4dE1lc3NhZ2VDb250ZW50RXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudGV4dE1lc3NhZ2VFbmQgPSBUZXh0TWVzc2FnZUVuZEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA0OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMzQpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRvb2xDYWxsU3RhcnQgPSBUb29sQ2FsbFN0YXJ0RXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDU6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA0Mikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudG9vbENhbGxBcmdzID0gVG9vbENhbGxBcmdzRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDY6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA1MCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudG9vbENhbGxFbmQgPSBUb29sQ2FsbEVuZEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA3OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gNTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnN0YXRlU25hcHNob3QgPSBTdGF0ZVNuYXBzaG90RXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDg6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA2Nikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uuc3RhdGVEZWx0YSA9IFN0YXRlRGVsdGFFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgOToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDc0KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5tZXNzYWdlc1NuYXBzaG90ID0gTWVzc2FnZXNTbmFwc2hvdEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAxMDoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDgyKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5yYXcgPSBSYXdFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMTE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA5MCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuY3VzdG9tID0gQ3VzdG9tRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDEyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gOTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnJ1blN0YXJ0ZWQgPSBSdW5TdGFydGVkRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDEzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTA2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5ydW5GaW5pc2hlZCA9IFJ1bkZpbmlzaGVkRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDE0OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTE0KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5ydW5FcnJvciA9IFJ1bkVycm9yRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDE1OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTIyKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5zdGVwU3RhcnRlZCA9IFN0ZXBTdGFydGVkRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDE2OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTMwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5zdGVwRmluaXNoZWQgPSBTdGVwRmluaXNoZWRFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMTc6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMzgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRleHRNZXNzYWdlQ2h1bmsgPSBUZXh0TWVzc2FnZUNodW5rRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDE4OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTQ2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50b29sQ2FsbENodW5rID0gVG9vbENhbGxDaHVua0V2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZUV2ZW50KCk7XG4gICAgbWVzc2FnZS50ZXh0TWVzc2FnZVN0YXJ0ID0gb2JqZWN0LnRleHRNZXNzYWdlU3RhcnQgIT09IHZvaWQgMCAmJiBvYmplY3QudGV4dE1lc3NhZ2VTdGFydCAhPT0gbnVsbCA/IFRleHRNZXNzYWdlU3RhcnRFdmVudC5mcm9tUGFydGlhbChvYmplY3QudGV4dE1lc3NhZ2VTdGFydCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50ZXh0TWVzc2FnZUNvbnRlbnQgPSBvYmplY3QudGV4dE1lc3NhZ2VDb250ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LnRleHRNZXNzYWdlQ29udGVudCAhPT0gbnVsbCA/IFRleHRNZXNzYWdlQ29udGVudEV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC50ZXh0TWVzc2FnZUNvbnRlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudGV4dE1lc3NhZ2VFbmQgPSBvYmplY3QudGV4dE1lc3NhZ2VFbmQgIT09IHZvaWQgMCAmJiBvYmplY3QudGV4dE1lc3NhZ2VFbmQgIT09IG51bGwgPyBUZXh0TWVzc2FnZUVuZEV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC50ZXh0TWVzc2FnZUVuZCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50b29sQ2FsbFN0YXJ0ID0gb2JqZWN0LnRvb2xDYWxsU3RhcnQgIT09IHZvaWQgMCAmJiBvYmplY3QudG9vbENhbGxTdGFydCAhPT0gbnVsbCA/IFRvb2xDYWxsU3RhcnRFdmVudC5mcm9tUGFydGlhbChvYmplY3QudG9vbENhbGxTdGFydCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50b29sQ2FsbEFyZ3MgPSBvYmplY3QudG9vbENhbGxBcmdzICE9PSB2b2lkIDAgJiYgb2JqZWN0LnRvb2xDYWxsQXJncyAhPT0gbnVsbCA/IFRvb2xDYWxsQXJnc0V2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC50b29sQ2FsbEFyZ3MpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxFbmQgPSBvYmplY3QudG9vbENhbGxFbmQgIT09IHZvaWQgMCAmJiBvYmplY3QudG9vbENhbGxFbmQgIT09IG51bGwgPyBUb29sQ2FsbEVuZEV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC50b29sQ2FsbEVuZCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5zdGF0ZVNuYXBzaG90ID0gb2JqZWN0LnN0YXRlU25hcHNob3QgIT09IHZvaWQgMCAmJiBvYmplY3Quc3RhdGVTbmFwc2hvdCAhPT0gbnVsbCA/IFN0YXRlU25hcHNob3RFdmVudC5mcm9tUGFydGlhbChvYmplY3Quc3RhdGVTbmFwc2hvdCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5zdGF0ZURlbHRhID0gb2JqZWN0LnN0YXRlRGVsdGEgIT09IHZvaWQgMCAmJiBvYmplY3Quc3RhdGVEZWx0YSAhPT0gbnVsbCA/IFN0YXRlRGVsdGFFdmVudC5mcm9tUGFydGlhbChvYmplY3Quc3RhdGVEZWx0YSkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5tZXNzYWdlc1NuYXBzaG90ID0gb2JqZWN0Lm1lc3NhZ2VzU25hcHNob3QgIT09IHZvaWQgMCAmJiBvYmplY3QubWVzc2FnZXNTbmFwc2hvdCAhPT0gbnVsbCA/IE1lc3NhZ2VzU25hcHNob3RFdmVudC5mcm9tUGFydGlhbChvYmplY3QubWVzc2FnZXNTbmFwc2hvdCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5yYXcgPSBvYmplY3QucmF3ICE9PSB2b2lkIDAgJiYgb2JqZWN0LnJhdyAhPT0gbnVsbCA/IFJhd0V2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5yYXcpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UuY3VzdG9tID0gb2JqZWN0LmN1c3RvbSAhPT0gdm9pZCAwICYmIG9iamVjdC5jdXN0b20gIT09IG51bGwgPyBDdXN0b21FdmVudC5mcm9tUGFydGlhbChvYmplY3QuY3VzdG9tKSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnJ1blN0YXJ0ZWQgPSBvYmplY3QucnVuU3RhcnRlZCAhPT0gdm9pZCAwICYmIG9iamVjdC5ydW5TdGFydGVkICE9PSBudWxsID8gUnVuU3RhcnRlZEV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5ydW5TdGFydGVkKSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnJ1bkZpbmlzaGVkID0gb2JqZWN0LnJ1bkZpbmlzaGVkICE9PSB2b2lkIDAgJiYgb2JqZWN0LnJ1bkZpbmlzaGVkICE9PSBudWxsID8gUnVuRmluaXNoZWRFdmVudC5mcm9tUGFydGlhbChvYmplY3QucnVuRmluaXNoZWQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UucnVuRXJyb3IgPSBvYmplY3QucnVuRXJyb3IgIT09IHZvaWQgMCAmJiBvYmplY3QucnVuRXJyb3IgIT09IG51bGwgPyBSdW5FcnJvckV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5ydW5FcnJvcikgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5zdGVwU3RhcnRlZCA9IG9iamVjdC5zdGVwU3RhcnRlZCAhPT0gdm9pZCAwICYmIG9iamVjdC5zdGVwU3RhcnRlZCAhPT0gbnVsbCA/IFN0ZXBTdGFydGVkRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnN0ZXBTdGFydGVkKSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnN0ZXBGaW5pc2hlZCA9IG9iamVjdC5zdGVwRmluaXNoZWQgIT09IHZvaWQgMCAmJiBvYmplY3Quc3RlcEZpbmlzaGVkICE9PSBudWxsID8gU3RlcEZpbmlzaGVkRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnN0ZXBGaW5pc2hlZCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50ZXh0TWVzc2FnZUNodW5rID0gb2JqZWN0LnRleHRNZXNzYWdlQ2h1bmsgIT09IHZvaWQgMCAmJiBvYmplY3QudGV4dE1lc3NhZ2VDaHVuayAhPT0gbnVsbCA/IFRleHRNZXNzYWdlQ2h1bmtFdmVudC5mcm9tUGFydGlhbChvYmplY3QudGV4dE1lc3NhZ2VDaHVuaykgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50b29sQ2FsbENodW5rID0gb2JqZWN0LnRvb2xDYWxsQ2h1bmsgIT09IHZvaWQgMCAmJiBvYmplY3QudG9vbENhbGxDaHVuayAhPT0gbnVsbCA/IFRvb2xDYWxsQ2h1bmtFdmVudC5mcm9tUGFydGlhbChvYmplY3QudG9vbENhbGxDaHVuaykgOiB2b2lkIDA7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBsb25nVG9OdW1iZXIoaW50NjQpIHtcbiAgY29uc3QgbnVtID0gZ2xvYmFsVGhpcy5OdW1iZXIoaW50NjQudG9TdHJpbmcoKSk7XG4gIGlmIChudW0gPiBnbG9iYWxUaGlzLk51bWJlci5NQVhfU0FGRV9JTlRFR0VSKSB7XG4gICAgdGhyb3cgbmV3IGdsb2JhbFRoaXMuRXJyb3IoXCJWYWx1ZSBpcyBsYXJnZXIgdGhhbiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUlwiKTtcbiAgfVxuICBpZiAobnVtIDwgZ2xvYmFsVGhpcy5OdW1iZXIuTUlOX1NBRkVfSU5URUdFUikge1xuICAgIHRocm93IG5ldyBnbG9iYWxUaGlzLkVycm9yKFwiVmFsdWUgaXMgc21hbGxlciB0aGFuIE51bWJlci5NSU5fU0FGRV9JTlRFR0VSXCIpO1xuICB9XG4gIHJldHVybiBudW07XG59XG5cbi8vIHNyYy9wcm90by50c1xuZnVuY3Rpb24gdG9DYW1lbENhc2Uoc3RyKSB7XG4gIHJldHVybiBzdHIudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9fKFthLXpdKS9nLCAoXywgbGV0dGVyKSA9PiBsZXR0ZXIudG9VcHBlckNhc2UoKSk7XG59XG5mdW5jdGlvbiBlbmNvZGUoZXZlbnQpIHtcbiAgY29uc3Qgb25lb2ZGaWVsZCA9IHRvQ2FtZWxDYXNlKGV2ZW50LnR5cGUpO1xuICBjb25zdCB7IHR5cGUsIHRpbWVzdGFtcCwgcmF3RXZlbnQsIC4uLnJlc3QgfSA9IGV2ZW50O1xuICBpZiAodHlwZSA9PT0gRXZlbnRUeXBlMi5NRVNTQUdFU19TTkFQU0hPVCkge1xuICAgIHJlc3QubWVzc2FnZXMgPSByZXN0Lm1lc3NhZ2VzLm1hcCgobWVzc2FnZSkgPT4ge1xuICAgICAgY29uc3QgdW50eXBlZE1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgaWYgKHVudHlwZWRNZXNzYWdlLnRvb2xDYWxscyA9PT0gdm9pZCAwKSB7XG4gICAgICAgIHJldHVybiB7IC4uLm1lc3NhZ2UsIHRvb2xDYWxsczogW10gfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH0pO1xuICB9XG4gIGlmICh0eXBlID09PSBFdmVudFR5cGUyLlNUQVRFX0RFTFRBKSB7XG4gICAgcmVzdC5kZWx0YSA9IHJlc3QuZGVsdGEubWFwKChvcGVyYXRpb24pID0+ICh7XG4gICAgICAuLi5vcGVyYXRpb24sXG4gICAgICBvcDogSnNvblBhdGNoT3BlcmF0aW9uVHlwZVtvcGVyYXRpb24ub3AudG9VcHBlckNhc2UoKV1cbiAgICB9KSk7XG4gIH1cbiAgY29uc3QgZXZlbnRNZXNzYWdlID0ge1xuICAgIFtvbmVvZkZpZWxkXToge1xuICAgICAgYmFzZUV2ZW50OiB7XG4gICAgICAgIHR5cGU6IEV2ZW50VHlwZVtldmVudC50eXBlXSxcbiAgICAgICAgdGltZXN0YW1wLFxuICAgICAgICByYXdFdmVudFxuICAgICAgfSxcbiAgICAgIC4uLnJlc3RcbiAgICB9XG4gIH07XG4gIHJldHVybiBFdmVudC5lbmNvZGUoZXZlbnRNZXNzYWdlKS5maW5pc2goKTtcbn1cbmZ1bmN0aW9uIGRlY29kZShkYXRhKSB7XG4gIHZhciBfYTtcbiAgY29uc3QgZXZlbnQgPSBFdmVudC5kZWNvZGUoZGF0YSk7XG4gIGNvbnN0IGRlY29kZWQgPSBPYmplY3QudmFsdWVzKGV2ZW50KS5maW5kKCh2YWx1ZSkgPT4gdmFsdWUgIT09IHZvaWQgMCk7XG4gIGlmICghZGVjb2RlZCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgZXZlbnRcIik7XG4gIH1cbiAgZGVjb2RlZC50eXBlID0gRXZlbnRUeXBlW2RlY29kZWQuYmFzZUV2ZW50LnR5cGVdO1xuICBkZWNvZGVkLnRpbWVzdGFtcCA9IGRlY29kZWQuYmFzZUV2ZW50LnRpbWVzdGFtcDtcbiAgZGVjb2RlZC5yYXdFdmVudCA9IGRlY29kZWQuYmFzZUV2ZW50LnJhd0V2ZW50O1xuICBpZiAoZGVjb2RlZC50eXBlID09PSBFdmVudFR5cGUyLk1FU1NBR0VTX1NOQVBTSE9UKSB7XG4gICAgZm9yIChjb25zdCBtZXNzYWdlIG9mIGRlY29kZWQubWVzc2FnZXMpIHtcbiAgICAgIGNvbnN0IHVudHlwZWRNZXNzYWdlID0gbWVzc2FnZTtcbiAgICAgIGlmICgoKF9hID0gdW50eXBlZE1lc3NhZ2UudG9vbENhbGxzKSA9PSBudWxsID8gdm9pZCAwIDogX2EubGVuZ3RoKSA9PT0gMCkge1xuICAgICAgICB1bnR5cGVkTWVzc2FnZS50b29sQ2FsbHMgPSB2b2lkIDA7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmIChkZWNvZGVkLnR5cGUgPT09IEV2ZW50VHlwZTIuU1RBVEVfREVMVEEpIHtcbiAgICBmb3IgKGNvbnN0IG9wZXJhdGlvbiBvZiBkZWNvZGVkLmRlbHRhKSB7XG4gICAgICBvcGVyYXRpb24ub3AgPSBKc29uUGF0Y2hPcGVyYXRpb25UeXBlW29wZXJhdGlvbi5vcF0udG9Mb3dlckNhc2UoKTtcbiAgICAgIE9iamVjdC5rZXlzKG9wZXJhdGlvbikuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgIGlmIChvcGVyYXRpb25ba2V5XSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgZGVsZXRlIG9wZXJhdGlvbltrZXldO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgT2JqZWN0LmtleXMoZGVjb2RlZCkuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgaWYgKGRlY29kZWRba2V5XSA9PT0gdm9pZCAwKSB7XG4gICAgICBkZWxldGUgZGVjb2RlZFtrZXldO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBFdmVudFNjaGVtYXMucGFyc2UoZGVjb2RlZCk7XG59XG5cbi8vIHNyYy9pbmRleC50c1xudmFyIEFHVUlfTUVESUFfVFlQRSA9IFwiYXBwbGljYXRpb24vdm5kLmFnLXVpLmV2ZW50K3Byb3RvXCI7XG5leHBvcnQge1xuICBBR1VJX01FRElBX1RZUEUsXG4gIGRlY29kZSxcbiAgZW5jb2RlXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/proto/dist/index.mjs\n");

/***/ })

};
;